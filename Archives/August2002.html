<!-- Published by Fog Creek Software CityDesk ZFAATMVMCDMTBKTO/2256BF10/212 -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Fog Creek CityDesk 1.0.1">
<title>IUnknown.com - August 2002 Weblog Archives</title>
<link rel="stylesheet" href="../global.css">
<script type="text/javascript" src="http://www.haloscan.com/load.php?user=jlam"></script>
<script language="javascript">
  function HaloScan2(id) { 
    location.href='http://www.haloscan.com/comments.php?user=jlam&comment='+id;
  }
</script>
</head>
<BODY>

<table border="0" width="800" class="heading">
  <tr>
    <td width="100%" class="heading"><A href="../index.html">IUnknown.com</a></td>
  </tr>
</table>
<table border="0" width="800" class="subheading">
  <tr>
    <td width="100%" class="subheading">    &nbsp; John Lam's weblog on software development</td>
  </tr>
</table>

<table width="800" border="0" cellpadding="7" cellspacing="0">
<tr>
<td class="left_panel" valign="top" align="right">
<p><a href="/rss.xml">rss feed</a></p>
<p>about</p>

<A href="../About/Aboutme.html">About me</a><br>

<A href="../About/fog0000000006.html">About this site</a><br>

<A href="../About/fog0000000010.html">My plan</a><br>

<A href="../About/fog0000000009.html">My other life</a><br>

<A href="../About/fog0000000008.html">My products</a><br>

<A href="../About/fog0000000013.html">My publications</a><br>

<p>aop</p>

<A href="../AOP/fog0000000115.html">My Runtime Aspect Weaver</a><br>

<A href="../AOP/fog0000000114.html">What is AOP?</a><br>

<p>book</p>

<A href="../CLRInternals/fog0000000043.html">About Inside the CLR</a><br>

<p>articles</p>

<A href="../Articles/Booksuggestions.html">Book suggestions</a><br>

<A href="../Articles/fog0000000082.html">Interface dispatch vs. object reference dispatch</a><br>

<A href="../Articles/fog0000000065.html">x86 Resources</a><br>

<A href="../Articles/fog0000000041.html">Entertainment PC's Part 2</a><br>

<A href="../Articles/fog0000000034.html">Entertainment PC's</a><br>

<A href="../Articles/fog0000000025.html">Hello CppUnit</a><br>

<p>archives</p>

<A href="November2002.html">November 2002</a><br>

<A href="October2002.html">October 2002</a><br>

<A href="September2002.html">September 2002</a><br>

<A href="August2002.html">August 2002</a><br>

<A href="July2002.html">July 2002</a><br>

<A href="June2002.html">June 2002</a><br>

<A href="May2002.html">May 2002</a><br>

<A href="April2002.html">April 2002</a><br>

<A href="fog0000000116.html">March 2002</a><br>

<A href="fog0000000091.html">February 2002</a><br>

<A href="fog0000000046.html">January 2002</a><br>

<A href="fog0000000030.html">December 2001</a><br>

<a href="http://www.haloscan.com/"><img width="88" height="31" src="http://www.haloscan.com/halolink.gif" border="0" alt="Weblog Commenting by HaloScan.com" /></a> 
</td>
<td class="main_panel">
<p><span class="article_heading">August 2002 Archives</span></p>
 
<P>
  <span class="article_heading">
    <A href="../Weblog/AnchorageAlaska.html">Anchorage, Alaska</A>
  </span><BR>
  27 Aug, 2002

  <BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
    <P>The last day of our stay in Alaska was up in Anchorage. As I was going through my receipts, they reminded me to recommend two different places if you are ever up that way. If you're staying in Anchorage, you will be totally spoiled by staying at the <A href="http://www.gourmetfleurs.com/">Gourmet Fleurs</A> bed and breakfast. It is run by Suzie Stranik, who is a most gracious host. The second recommendation is to eat at the <A href="http://www.southsidebistro.com">Southside Bistro</A>, which has excellent food.</P>
    <a href="javascript:HaloScan2('Weblog/AnchorageAlaska.html');"><script type="text/javascript">postCount('Weblog/AnchorageAlaska.html');</script></a>
  </BLOCKQUOTE>
      <P></P>
 
<P>
  <span class="article_heading">
    <A href="../Weblog/InmemoriumGalenRowell.html">In memorium: Galen Rowell</A>
  </span><BR>
  25 Aug, 2002

  <BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
    <P><P>I recently began exploring photography as a creative outlet, and I stumbled across <A href="http://www.mountainlight.com/rowell.gr.html">Galen Rowell's</A>&nbsp;most excellent <A href="http://www.mountainlight.com/bookcoverpages/book_innergame.html">Inner Game of Outdoor Photography</A> while browsing in my local Chapters bookstore. The moment I began reading the preface to his book, I knew that I had found someone really, really&nbsp;special. As I continued to read each one of the sixty-five essays in this book, the words and the images spoke to a part of me like nothing that I had ever read before.</P>
<P>I wondered why I felt so strongly drawn towards photography. As I learned more and more about the subject and its practioners, I realized that photography shares much in common with music and computer science. On one hand, it requires absolute mastery of technical information. Well-defined procedures must be precisely executed to get the desired results. But perfect execution is not nearly enough; each one of these disciplines also requires a considerable amount of abstract thought. We also speak of beautifully composed photographs, of musical music, of elegant software. </P>
<P>Which brings me to the point of this entry: like many others, I never met Galen Rowell. I learned of his untimely death while flying home from our honeymoon. Carolyn was reading the Globe and Mail, and the obituary section featured a photograph of Galen standing next to his most famous photograph: that of the rainbow striking the Dalai Lama's Potala palace. At that moment, I was suddenly struck by a sense of loss unlike any that I had felt before for someone that I never met. To say that his photographs and his writings have changed my life is an understatement. Galen taught me how to ask the question:&nbsp;"Which life experiences are the most worth living?"</P>
<P>My condolences go out to those who loved Galen and his wife Barbara, as well as Tom Reid and Carol McAfee who were also on board their plane that crashed during their&nbsp;final approach to Bishop airport in California. To paraphrase Norbu Tsering who wrote a heartfelt passage <A href="http://www.mountainlight.com/guestbook.html">in their guest book</A>: <EM>Heaven needs beautiful people too.</EM></P></P>
    <a href="javascript:HaloScan2('Weblog/InmemoriumGalenRowell.html');"><script type="text/javascript">postCount('Weblog/InmemoriumGalenRowell.html');</script></a>
  </BLOCKQUOTE>
      <P></P>
 
<P>
  <span class="article_heading">
    <A href="../Weblog/LivingwiththeNikonCoolpix.html">Living with the Nikon Coolpix 5700</A>
  </span><BR>
  23 Aug, 2002

  <BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
    <P><P>I've now shot over 1700 pictures using our Nikon Coolpix 5700, some under rather challenging conditions. I'm writing this to highlight some of the things that I have learned about the idiosyncracies of the Coolpix 5700.</P>
<P>First off, the zoom is excellent. It's a 280mm equivalent zoom, which is quite useful for most kinds of photography. It's more than enough zoom to significantly collapse perspective, which can create shots like this </P><SPAN><IMG height=480 alt=[Image] hspace=4 src="../Images/north_vancouver.jpg" width=640 align=left border=0 cd:pos="2"><BR clear=all></SPAN>
<P>On this trip, I was hoping to capture some magnificent sunsets in Alaska. So I wanted to purchase some graduated neutral density filters. This was when I discovered that Nikon has no "official" solution to attaching filters to your lens! None of the Nikon dealers that I visited in Vancouver could provide me with a solution. After a bit of searching on the Internet, I discovered that there is someone who is selling an adapter. I couldn't get one shipped to me before I embarked on our cruise, so this was the best that I could do: </P><SPAN><IMG height=480 alt=[Image] hspace=4 src="../Images/alaska_sunset.jpg" width=640 align=left border=0 cd:pos="2"><BR clear=all></SPAN>
<P>I also tried out the Nikon 1.5x teleconverter. This would convert my 280mm equivalent zoom to a 420mm. Unfortunately for me, I balked at buying the teleconverter, and bought a remote shutter release instead. This is why my best shot of wild sea otters in Alaska looks like this:</P><SPAN><IMG height=480 alt=[Image] hspace=4 src="../Images/sea_otter.jpg" width=640 align=left border=0 cd:pos="2"><BR clear=all></SPAN>
<P>Now here's a number of things that are I find annoying about the Coolpix 5700:</P>
<P>1) The positioning of the controls on the left hand side of the lens body. I find that I accidently hit these controls, particularly when composing shots on a tripod. The worst offender is the button that selects the image size. Why this is present as its own button and not as a menu option is beyond me. This button would be far better served as a toggle through the white balance settings on the camera. Hitting this button accidently and setting the camera into Hi mode has cost me at least two really great pictures. It takes a <EM>long</EM> time to write a Hi image out to the CF card.</P>
<P>2) The fact that you can't go into BSS (Best Shot Selector) mode if you've got Noise Reduction enabled. I find that I frequently go from one or the other when I'm passing through the threshold of 1/4 second exposures into slower shutter speeds. </P>
<P>3) The fact that you have use the menu to measure middle-grey to set the white balance of the camera. A shortcut button here would be really useful.</P>
<P>4) Why isn't the quick action mode enabled by default in the camera? This is the mode that significantly reduces shutter lag in the camera. It took me weeks to find this setting in the manual (and it took reading the brochure to discover this feature even existed!).</P>
<P>5) Why isn't the manual for the Coolpix 5700 available for download on the web? I left my paper manual at home, and couldn't download a new copy like I could for my venerable Coolpix 950.</P></P>
    <a href="javascript:HaloScan2('Weblog/LivingwiththeNikonCoolpix.html');"><script type="text/javascript">postCount('Weblog/LivingwiththeNikonCoolpix.html');</script></a>
  </BLOCKQUOTE>
      <P></P>
 
<P>
  <span class="article_heading">
    <A href="../Weblog/TheGreatHoneymoonTrick.html">The Great Honeymoon Trick</A>
  </span><BR>
  19 Aug, 2002

  <BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
    <P><P>This is a story about how we started off driving to Tobermory, but wound up in Alaska. I'm writing this on Day 6 of our honeymoon cruise. I'm sitting at a table in La Playa Grill, a cafeteria&nbsp;on our cruise ship, the Carnival Spirit. A pack of noisy teenagers just ran by, looking for trouble. The table that I'm sitting at is angled so that it faces the port side of the ship at a 45 degree angle. There are floor-to-ceiling windows in front of me, and I'm looking at the Gulf of Alaska on a mostly cloudy day. We just left our final port of call, the city of Sitka, where we went on a wildlife cruise through the islands around Sitka. How we got onto this cruise ship in Alaska makes for a great story. So it's time to reflect back on the events following our wedding.</P>
<P>When Carolyn and I were planning our wedding, we "decided" that we would do a simple honeymoon following our wedding, and then do something longer and more interesting during Christmas break. Our original plan was to go to Tobermory for our honeymoon. Tobermory is a small town at the northern tip of the Bruce Peninsula in Georgian Bay. It's a picturesque tourist town and a favorite dive spot. A friend of ours from college runs an Inn and a gift shop in Tobermory, so it made a perfect cover story for my evil scheme.</P>
<P>In the interests of operational security, only my brother and my dad knew about my scheme, and only my brother was privy to all of the details. This, of course, meant that I had to consistently lie to everybody who asked where we were going on our honeymoon. Now, Carolyn believes that she can always detect when I'm lying; in fact, her exact words are "you can't lie worth shit". As my evil scheme unfolded, I enjoyed making her eat those very words time and time again. To all of our friends and family that I did lie to about our honeymoon plans, please accept my sincere apologies for having deceived you ;)&nbsp;Now back to our regularly scheduled story.</P>
<P>On the day after our wedding, we woke up late in the morning after spending a wonderful night at the Old Mill Inn in Toronto. Carolyn's quite used to my anal-retentive scheduling behavior, so she didn't put up much of a fight when I told her that we needed to be on the road by 1:30pm. We were driving her car to "Tobermory", and I "volunteered" to drive the first leg in the 5 hour drive. Carolyn was on the cel phone talking to her parents as we drove north on Highway 427. Fortunately, Highway 427 in Toronto passes right by the airport. Surprisingly, she didn't say anything when I detoured and drove into the airport. It wasn't until the concrete in the short-term parking garage cut off her cel phone signal that she began asking me what was going on.</P>
<P>While driving to the airport, I had a primary cover story planned to continue the deception. When we pulled into the airport, I decided to improvise a bit so that I could keep her in the dark a bit longer. While we were unloading our luggage from our car, I told Carolyn that we were going to take a float plane up to Tobermory and that she should thank her uncle Jim, who is an Air Canada pilot. She got so excited that she called her parents back to tell them about our revised plan. </P>
<P>Now, I realized that this little feint would only last until we walked into the boarding area of the Boeing 767 that was going to fly us to Vancouver. So I decided to 'fess up earlier, and sprang my primary cover story on her. When we walked into Pearson International Airport's Terminal 2, we were met by my brother Thomas, who was also my best man at our wedding. Thomas' job was to drive our car home (in reality he's going to spend 10 days driving around in our Subaru Outback wagon). Thomas was in on the real plan so he helped out by reinforcing the "real" story.</P>
<P>This time, I told Carolyn that we were flying to Vancouver so that we could drive down to Seattle. My story involved some rich Microsoft "volunteers" who would loan us their spectacular hillside vacation home on the side of Mt. Ranier in Seattle (I even talked about how owning such a home would be advantageous under the US taxation code). Unfortunately for us, the home wouldn't be ready for us until Wednesday, so we would stay for a couple of nights in Vancouver before traveling by car to Seattle. </P>
<P>We spent those evenings at the Fairmont Waterfront, which as it turns out, is right across the street from the Cruise Ship Terminal. During the days, we walked around Stanley Park in Vancouver, and did some shopping. The shopping was necessary because I had earlier&nbsp;explained to Carolyn that we were going to attend a formal function that was to be held at Bill Gates' house. So off we went to buy her some formal clothes that she would need for our formal nights on board the cruise ship.</P>
<P>On Wednesday, I began to get worried because she pointed to the giant cruise ship (the Carnival Spirit) which had docked at the Cruise Ship terminal early in the morning. Fearing that she would put two and two together, I decided to throw one more curve ball at her. Early in the morning we needed to finish some shopping. The previous day, I had ordered a Nikon EU1 remote shutter release from a Dunn and Brundle, a camera store on Granville street in Vancouver. While returning from that shopping trip (which I made alone), I dropped by the bell stand at the Fairmont and got Vincent, one of the bell captains, involved in my evil scheme.</P>
<P>Vincent would pick up our luggage from our room and have it stored in the luggage room. As our departure time (1:30) approached, he would have our luggage loaded onto one of the hotel courtesy cars to drive us to our "car rental place", where we would pick up our car to drive to Seattle. After pulling away from the hotel, he asked me what "car rental place" we were picking up our car at. I told him Thrifty's, as this would give us an excuse to drive into the Cruise Ship Terminal. </P>
<P>We drove around for a while in downtown Vancouver due to some construction that was taking place next to the hotel, before returning to the cruise ship terminal. We pulled up to the cruise ship departure gate and asked the traffic attendant where Thrifty's was. She told us that it was one level down from where we were, but we "elected" to offload our bags where we were.</P>
<P>What happened next was priceless. A Carnival baggage attendant came over to pick up our bags. Carolyn began arguing with the baggage attendant as she tried to explain to him that we weren't going on a cruise; we were really there to pick up a rental car! That was when I had to tell her that we were going on an Alaskan cruise. The surprise was so complete that Carolyn refused to believe that we were going to Alaska, and she kept hitting me in line and drawing lots of attention. She kept asking me where we <EM>really</EM> were going. Eventually, reality sunk in as she saw all of the signs proclaiming that we were going to Alaska, and she got a chance to look at our cruise ship tickets. </P>
<P>So there you go. That's the story of the Great Honeymoon Trick, and how we wound up driving towards Tobermory, but wound up in Alaska instead.</P></P>
    <a href="javascript:HaloScan2('Weblog/TheGreatHoneymoonTrick.html');"><script type="text/javascript">postCount('Weblog/TheGreatHoneymoonTrick.html');</script></a>
  </BLOCKQUOTE>
      <P></P>
 
<P>
  <span class="article_heading">
    <A href="../Weblog/Wereoff.html">We're off!</A>
  </span><BR>
  10 Aug, 2002

  <BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
    <P><P>We're off to get married! Thanks to everyone who sent along their&nbsp;best wishes. I wish that I had the time to respond to each of you personally. Thanks again to everyone;&nbsp;it really meant a lot to us.</P>
<P>We'll be back the week of August 26th. See y'all then!</P></P>
    <a href="javascript:HaloScan2('Weblog/Wereoff.html');"><script type="text/javascript">postCount('Weblog/Wereoff.html');</script></a>
  </BLOCKQUOTE>
      <P></P>
 
<P>
  <span class="article_heading">
    <A href="../Weblog/Imgettingmarried.html">I'm getting married!</A>
  </span><BR>
  09 Aug, 2002

  <BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
    <P>I'm marrying Carolyn Kerr! We met at college almost 14 years ago, and after many many years, we're (finally) getting married!&nbsp;I'm really looking forward to spending the rest of my days with her beginning this Sunday. Wish us luck!</P>
    <a href="javascript:HaloScan2('Weblog/Imgettingmarried.html');"><script type="text/javascript">postCount('Weblog/Imgettingmarried.html');</script></a>
  </BLOCKQUOTE>
      <P></P>
 
<P>
  <span class="article_heading">
    <A href="../Weblog/Publickeysandpublickeytok.html">Public keys and public key tokens</A>
  </span><BR>
  05 Aug, 2002

  <BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
    <P><P>I spent some time this morning doing some "dotting the i's work" on my metadata engine.&nbsp;One of the things that I've been holding out implementing for a while because it wasn't particularly important in my test cases was adding some code that would generate efficient assembly references to strongly-named assemblies. </P>
<P>Strongly-named assemblies contain the signer's public key embedded in the assembly. You can see this by opening up the assembly using ILDASM and viewing its manifest. Inside the manifest, there must be a .publickey section if that assembly has a strong name. If you look at one of these sections, you'll see that it is rather large. For example, System.Web.dll's&nbsp;public key is 160 bytes in length.</P>
<P>When one assembly references a strongly-named assembly, it must embed a reference to the strongly-named assembly's public key to ensure that an attacker cannot substitute another assembly for the one that it was expecting to find. The simplest solution would be to simply embed the strongly-named assembly's public key in the referencing assembly. As you can see, however, this is not a very efficient solution due to the large size of the public keys.</P>
<P>Microsoft solves the "public key bloat" problem by using a hash of the strongly-named assembly's public key. These hashes are referred to as public key tokens, and are the low 8 bytes of the SHA1 hash of the strongly-named assembly's public key. SHA1 hashes are 160 bit (20 byte) hashes, and the top 12 bytes of the hash are simply discarded in this algorithm.</P>
<P>Calculating the SHA1 hash of an assembly's public key turns out to be really straightforward using the CryptoAPI hashing functions. Here's a simple piece of code that will generate&nbsp;an SHA1&nbsp;hash:</P><CODE>
<P>bool CalculatePublicKeyToken( const unsigned char *publicKey, ULONG publicKeyLen )<BR>{<BR>&nbsp; if( 0 == publicKeyLen )<BR>&nbsp;&nbsp;&nbsp; return true;</P>
<P>&nbsp; bool&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = false;<BR>&nbsp; HCRYPTPROV&nbsp;&nbsp;&nbsp; hProv = 0;<BR>&nbsp; HCRYPTHASH&nbsp;&nbsp;&nbsp; hHash = 0;<BR>&nbsp; unsigned char buffer[ 20 ];<BR>&nbsp; DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bufferLen = 20;</P>
<P>&nbsp; if( CryptAcquireContext( &amp;hProv, 0, 0, PROV_RSA_FULL, 0 ) )<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp; if( CryptCreateHash( hProv, CALG_SHA1, 0, 0, &amp;hHash ) )<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if( CryptHashData( hHash, publicKey, publicKeyLen, 0 ) )<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if( CryptGetHashParam( hHash, HP_HASHVAL, buffer, &amp;bufferLen, 0 ) )<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DumpPublicKeyToken( buffer, bufferLen );<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = true;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR>&nbsp; }</P>
<P>&nbsp; if( hHash ) CryptDestroyHash( hHash );<BR>&nbsp; if( hProv ) CryptReleaseContext( hProv, 0 );</P>
<P>&nbsp; return result;<BR>}</P></CODE>
<P>It is also possible to use the StrongNameTokenFromAssembly API defined in the StrongName.h header file in the Framework SDK. However, this API assumes that the assembly isn't loaded already, which certainly isn't the case in my code.</P>
<P>&nbsp;</P></CODE></P>
    <a href="javascript:HaloScan2('Weblog/Publickeysandpublickeytok.html');"><script type="text/javascript">postCount('Weblog/Publickeysandpublickeytok.html');</script></a>
  </BLOCKQUOTE>
      <P></P>

<div class="copyright">Site contents copyright 2001-2002 by John Lam. No animals were harmed during the production of this site. Some assembly required. Your mileage may vary. Use at your own risk.</div>
</td>
<td class="right_panel"></td>
</tr>
</table>
</BODY>
</HTML>
