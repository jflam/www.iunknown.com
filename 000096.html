<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>iunknown.com: Resisting repaving is good for you</title>

<link rel="stylesheet" href="http://www.iunknown.com/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.iunknown.com/index.rdf" />

<link rel="start" href="http://www.iunknown.com/" title="Home" />
<link rel="prev" href="http://www.iunknown.com/000095.html" title="Get Organized!" />

<link rel="next" href="http://www.iunknown.com/000097.html" title="Enforcing development policies using aspects" />


<script type="text/javascript" language="javascript">
<!--

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

var HOST = 'www.iunknown.com';

// Copyright (c) 1996-1997 Athenia Associates.
// http://www.webreference.com/js/
// License is granted if and only if this entire
// copyright notice is included. By Tomer Shiran.

function setCookie (name, value, expires, path, domain, secure) {
    var curCookie = name + "=" + escape(value) + ((expires) ? "; expires=" + expires.toGMTString() : "") + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + ((secure) ? "; secure" : "");
    document.cookie = curCookie;
}

function getCookie (name) {
    var prefix = name + '=';
    var c = document.cookie;
    var nullstring = '';
    var cookieStartIndex = c.indexOf(prefix);
    if (cookieStartIndex == -1)
        return nullstring;
    var cookieEndIndex = c.indexOf(";", cookieStartIndex + prefix.length);
    if (cookieEndIndex == -1)
        cookieEndIndex = c.length;
    return unescape(c.substring(cookieStartIndex + prefix.length, cookieEndIndex));
}

function deleteCookie (name, path, domain) {
    if (getCookie(name))
        document.cookie = name + "=" + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + "; expires=Thu, 01-Jan-70 00:00:01 GMT";
}

function fixDate (date) {
    var base = new Date(0);
    var skew = base.getTime();
    if (skew > 0)
        date.setTime(date.getTime() - skew);
}

function rememberMe (f) {
    var now = new Date();
    fixDate(now);
    now.setTime(now.getTime() + 365 * 24 * 60 * 60 * 1000);
    setCookie('mtcmtauth', f.author.value, now, '', HOST, '');
    setCookie('mtcmtmail', f.email.value, now, '', HOST, '');
    setCookie('mtcmthome', f.url.value, now, '', HOST, '');
}

function forgetMe (f) {
    deleteCookie('mtcmtmail', '', HOST);
    deleteCookie('mtcmthome', '', HOST);
    deleteCookie('mtcmtauth', '', HOST);
    f.email.value = '';
    f.author.value = '';
    f.url.value = '';
}

//-->
</script>





</head>

<body>

<div id="banner">
<h1><a href="http://www.iunknown.com/" accesskey="1"><img src="/mt-static/images/iunknown.png" width="350" height="60" border="0"></a></h1>
<span class="description">Home of the Practical Eye for the .NET Guy</span>
</div>

<div id="container">

<div class="blog">

<div id="menu">
<a href="http://www.iunknown.com/000095.html">&laquo; Get Organized!</a> |

<a href="http://www.iunknown.com/">Main</a>
| <a href="http://www.iunknown.com/000097.html">Enforcing development policies using aspects &raquo;</a>

</div>

</div>


<div class="blog">

<h2 class="date">May 20, 2002</h2>

<div class="blogbody">

<h3 class="title">Resisting repaving is good for you</h3>

<div class="midAds">
<script type="text/javascript"><!--
google_ad_client = "pub-8264790134546506";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_channel ="";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

<p><P>If you're like me, you tend to love having a nice, pristine machine to work on. As we all know, over time, our computers gradually degrade as we install more software, use bizarre combinations of features of existing software, or write really nasty bits that hook into existing software ;) This is a story of me successfully resisting my urge to repave whenever I run into a nasty problem.</P><br />
<P>This weekend, as part of <A href="Weblog/GetOrganized.html">my larger effort to reorganize my life</A>, I decided to fix some of the IT problems in our home office. One of our other computers (a dual proc Win2K Advanced Server box) kept on faulting in spoolsv.exe. This, of course, meant that you couldn't print using that machine. Also, Active Directory was messed up something awful, and I couldn't add any new accounts to our Exchange Server. It would fail with a "The name could not be resolved. The name could not be matched to a name in the address list." error every time I attempted to check a name in Exchange.</P><br />
<P>These two issues killed the better part of a day. The first one - spoolsv.exe, could be fixed by some judicious editing of the registry.[1] This one was actually quite easy to find - just type "spoolsv.exe" into Google, and it's the 4th entry. </P><br />
<P>The second problem, however, turned out to be really evil. My first step was to streamline my Active Directory install. I killed a redundant domain controller on my network , and got myself down to a single Global Catalog Server. This wasn't as easy as it looked - I had to manually delete Active Directory on that machine by - you will never guess - editing the registry and deleting the \winnt\ntds directory from the machine.[2]</P><br />
<P>Once I got to that stage, I blew many hours twiddling various Exchange settings and messing around with ADSIEdit. It got to the point where I almost was ready to repave. However, repaving my Exchange / Domain Controller box would result in several days worth of downtime. I was almost willing to live with not being able to add a new account to Exchange to avoid several days worth of reinstallation / backups / restores. </P><br />
<P>My savior turned out to be Google, once again. However instead of trying to find the solution on the Web, the answer turned up in a search of Google Groups. At roughly 3am, I found a link to this Microsoft KB article[3] that had me make yet another very minor tweak to the Registry. Apparently, installing the Q311401 Windows 2000 Security Rollup Package on my Global Catalog Server was what prevented name resolution in the Exchange Global Catalog List. </P><br />
<P>Needless to say, I was <EM>very </EM>happy to find this KB article. It also goes to show how difficult it is to be a part-time sys admin without having better diagnostic tools for determining what these problems are and linking the diagnostic tools to the solutions / KB articles. However, the bigger take-home message was that it is possible to fix a machine without repaving. In fact repaving in this case would have only cost me a few days worth of work with ZERO benefit since I would most likely install the Q311401 Security Rollup Package before trying to add the accounts. </P><br />
<P>[1] <A href="http://www.jsifaq.com/SUBJ/tip4900/rh4900.htm">http://www.jsifaq.com/SUBJ/tip4900/rh4900.htm</A></P><br />
<P>[2] <A href="http://www.jsifaq.com/SUBG/TIP3200/rh3222.htm">http://www.jsifaq.com/SUBG/TIP3200/rh3222.htm</A></P><br />
<P>[3] <A href="http://support.microsoft.com/default.aspx?scid=kb;en-us;Q309622">http://support.microsoft.com/default.aspx?scid=kb;en-us;Q309622</A></P><br />
<P>&nbsp;</P></p>

<a name="more"></a>


<span class="posted">Posted by John at May 20, 2002 12:29 PM

<br /></span>

</div>

<div class="comments-head"><a name="mailthisentry"></a>Mail this entry</div>

<form method="post" action="http://www.iunknown.com/cgi-bin/mt-send-entry.cgi">
<input type="hidden" name="entry_id" value="96" />
<input type="hidden" name="_redirect" value="http://www.iunknown.com/000096.html" />
Email this entry to:<br />
<input name="to" size="20" /><br /><br />
Your email address:<br />
<input name="from" size="20" /><br /><br />
Message (optional):<br />
<textarea name="message" rows="5" cols="20" wrap="virtual"></textarea><br /><br />
<input type="submit" value="Send" />
</form>


<div class="comments-head"><a name="comments"></a>Comments</div>





</div>
</div>
</body>
</html>
