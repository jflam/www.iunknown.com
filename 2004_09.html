<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>iunknown.com: September 2004 Archives</title>

<link rel="stylesheet" href="http://www.iunknown.com/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.iunknown.com/index.rdf" />
<link rel="start" href="http://www.iunknown.com/" title="Home" />
<link rel="prev" href="http://www.iunknown.com/2004_08.html" title="August 2004" />

<link rel="next" href="http://www.iunknown.com/2004_10.html" title="October 2004" />


<script language="javascript" type="text/javascript">
function OpenComments (c) {
    window.open(c,
                    'comments',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}
</script>

</head>

<body>	

<div id="banner">
<h1><a href="http://www.iunknown.com/" accesskey="1"><img src="/mt-static/images/iunknown.png" width="350" height="60" border="0"></a></h1>
<span class="description">Home of the Practical Eye for the .NET Guy</span>
</div>

<div id="container">

<div class="blog">

<div id="menu">
<a href="http://www.iunknown.com/2004_08.html">&laquo; August 2004</a> |

<a href="http://www.iunknown.com/">Main</a>
| <a href="http://www.iunknown.com/2004_10.html">October 2004 &raquo;</a>

</div>

</div>

<div class="blog">
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000491"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/235"
    dc:title="MSAgent making its rounds"
    dc:identifier="http://www.iunknown.com/2004_09.html#000491"
    dc:subject="Blog"
    dc:description="It seems that my original post about creating a birthday song for Matthew using Python/win32all/MSAgent has made its rounds around the web. Most recently, John Wiseman wrote a Lisp implementation as did Gordon Weakliem using Scheme and this Perl implementation..."
    dc:creator="John"
    dc:date="2004-09-29T10:19:32-05:00" />
</rdf:RDF>
-->


<h2 class="date">September 29, 2004</h2>


<div class="blogbody">
<a name="000491"></a>
<h3 class="title">MSAgent making its rounds</h3>

<p>It seems that my original post about creating a birthday song for Matthew using Python/win32all/MSAgent has made its rounds around the web. Most recently, John Wiseman wrote a <a href="http://www.lemonodor.com/archives/000925.html">Lisp implementation</a> as did Gordon Weakliem <a href="http://www.eighty-twenty.net/blog/urn:www-eighty-twenty-net:1291.html">using Scheme</a> and this <a href="http://larsen.perlmonk.org/blog/archives/000050.html">Perl implementation</a></p>

<p>It would be fun to see an implementation in Lisp/Scheme that compiles/interprets a little language similar to the one I defined in Python via Lisp S-expressions. That's next on my "fun things to explore that don't help me pay my mortgage" queue.</p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000491.html">10:19 AM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=491" onclick="OpenComments(this.href); return false">Comments (1)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=491" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000490"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/234"
    dc:title="Fun time at PyGTA"
    dc:identifier="http://www.iunknown.com/2004_09.html#000490"
    dc:subject="Blog"
    dc:description="I attended the local Python user group meeting here in Toronto to meet some folks who are working on Python. The meeting was held at the offices of givex in downtown Toronto. Givex runs their business using Python (they&apos;re the..."
    dc:creator="John"
    dc:date="2004-09-29T10:09:42-05:00" />
</rdf:RDF>
-->




<div class="blogbody">
<a name="000490"></a>
<h3 class="title">Fun time at PyGTA</h3>

<p>I attended the local <a href="http://web.engcorp.com/pygta">Python user group</a> meeting here in Toronto to meet some folks who are working on Python. The meeting was held at the offices of <a href="http://web.givex.com/">givex</a> in downtown Toronto. </p>

<p>Givex runs their business using Python (they're the folks behind many of the gift cards in Canada - like the Chapters and Ikea gift cards). Python controls the interactions between their "transaction servers" - which are PostgreSQL databases, and their "application servers" which act as traditional middleware that routes messages from different communications channels to one of the transaction servers. </p>

<p>There was a fun talk on creating 3D Lorenz Attractor images using Python and the Visual Python Module. I love it when folks talk about topics that have zero practical application, but serve to illustrate some technique or library. Afterwards, the discussion continued at the Charlotte Room across the street. </p>

<p>I had a fun time discussing all manner of topics with <a href="http://blog.vrplumber.com/361">Michael Fletcher</a> who's a smart guy and a very active member in the Python community. He's <a href="http://www.vrplumber.com/programming/">responsible for</a> (among other things) PyOpenGL, SimpleParse, PyTable and wxPython. We had a fun discussion about society and government and the role of efficiency vs. grand ideas that lasted until we threw ourselves out of the place.</p>

<p>Unfortunately, <a href="http://www.win-dev.com">WinDev</a> will keep me out of town for the next meeting, so we'll have to wait a while before resuming our discussion.</p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000490.html">10:09 AM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=490" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=490" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000489"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/233"
    dc:title="A better ExecuteOnce"
    dc:identifier="http://www.iunknown.com/2004_09.html#000489"
    dc:subject="Blog"
    dc:description="Via dilip&apos;s comment, I discovered that Sjoerd Visscher had written a javascript version of my ExecuteOnce program. He had an ingenious solution that avoided the need for the temporary boolean sentinel, as well as the shadow method. So in the..."
    dc:creator="John"
    dc:date="2004-09-22T15:32:49-05:00" />
</rdf:RDF>
-->


<h2 class="date">September 22, 2004</h2>


<div class="blogbody">
<a name="000489"></a>
<h3 class="title">A better ExecuteOnce</h3>

<p>Via dilip's comment, I discovered that <a href="http://w3future.com/weblog/2004/09/22.xml#closuresForAnonymousStorage">Sjoerd Visscher</a> had written a javascript version of my <a href="http://www.iunknown.com/000484.html">ExecuteOnce</a> program. He had an ingenious solution that avoided the need for the temporary boolean sentinel, as well as the shadow method. So in the spirit of sharing, I've updated my code to reflect his technique:</p>

<pre>
class ExecuteOnce(type):

    def donothing(): pass
    
    def sentinel(name, method):
        def _method(self, *arg1, **argd):
            result = method(self, *arg1, **argd)
            setattr(self, name, ExecuteOnce.donothing)
            return result
        return _method

    sentinel = staticmethod(sentinel)
    donothing = staticmethod(donothing)
    
    def __new__(cls, classname, bases, classdict):
        for name, item in classdict.items():
            if callable(item):
                classdict[name] = ExecuteOnce.sentinel(name, item)

        return type.__new__(cls, classname, bases, classdict)

class Test(object):
    __metaclass__ = ExecuteOnce
    def method1(self):
        print &quot;In method1&quot;

t = Test()
t.method1()
t.method1()
t.method1()
</pre><p>Also, he also taught me one extremely powerful aspect of closures - anonymous storage. The <code>method</code> parameter passed to the <code>sentinel</code> method is really a function object which is stored within the body of the closure - hence the term he uses: "anonymous storage". It neatly avoids polluting the attribute space of the class, as well as eliminating the possibility of namespace collisions. </p>

<p>And the program is also now much shorter and easier to read. There's just so much to love about Python!</p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000489.html">03:32 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=489" onclick="OpenComments(this.href); return false">Comments (2)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=489" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000488"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/232"
    dc:title="Happy Birthday Matthew!"
    dc:identifier="http://www.iunknown.com/2004_09.html#000488"
    dc:subject="Blog"
    dc:description="My son Matthew is one year old today! I&apos;m putting the finishing touches on Matthew&apos;s birthday present program - and I&apos;m really excited about trying it out on him when he wakes up in the morning! My brother shot this..."
    dc:creator="John"
    dc:date="2004-09-22T01:05:10-05:00" />
</rdf:RDF>
-->




<div class="blogbody">
<a name="000488"></a>
<h3 class="title">Happy Birthday Matthew!</h3>

<p>My son Matthew is one year old today! I'm putting the finishing touches on Matthew's birthday present program - and I'm really excited about trying it out on him when he wakes up in the morning!</p>

<p><img src="Images/mafoo_birthday.JPG" alt="" /></p>

<p>My brother shot this photo using his Canon <span class="caps">A80</span> this weekend when we had a family pre-birthday party for Matthew. Thomas applied a bit of Photoshop magic to create this really nice photo.</p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000488.html">01:05 AM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=488" onclick="OpenComments(this.href); return false">Comments (3)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=488" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000487"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/231"
    dc:title="The more you learn the shorter it gets"
    dc:identifier="http://www.iunknown.com/2004_09.html#000487"
    dc:subject="Blog"
    dc:description="I thought that my earlier blog entry on emulating String.Format() in Python had some crufty code in it - specifically the code that expanded a list into a comma separated string. So after a bit of random reading in the..."
    dc:creator="John"
    dc:date="2004-09-22T00:55:28-05:00" />
</rdf:RDF>
-->




<div class="blogbody">
<a name="000487"></a>
<h3 class="title">The more you learn the shorter it gets</h3>

<p>I thought that my <a href="http://www.iunknown.com/000485.html">earlier blog entry</a> on emulating <code>String.Format()</code> in Python had some crufty code in it - specifically the code that expanded a list into a comma separated string. So after a bit of random reading in the Python Cookbook tonight, I discovered the <code>map</code> function. </p>

<p>It takes a function object as its first parameter, and list object as its second parameter. It calls the function for each member of the list and returns a new list containing the results of calling that function.</p>

<p>My original version of code looked like:</p>

<pre>
for n in argIndices:
    expr += 'mo.group(%s), ' % n
</pre><p>My new version of code looks like:</p>

<pre>groups = ','.join(map(lambda str: 'mo.group(%s)' % str, argIndices))</pre><p>It also has the side-effect of not requiring the (A,B,) syntax for declaring tuples. </p>

<p>While this is arguably longer than my original version (in characters typed) - learning this technique lets me do a different optimization that may be more efficient than my current implementation. But I'll need to try it out first :)</p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000487.html">12:55 AM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=487" onclick="OpenComments(this.href); return false">Comments (2)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=487" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000486"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/230"
    dc:title="Python books"
    dc:identifier="http://www.iunknown.com/2004_09.html#000486"
    dc:subject="Blog"
    dc:description="The two books that I&apos;m using to learn Python are: Python in a Nutshell by Alex Martelli Python Cookbook by Alex Martelli and David Ascher Both are very good books. I briefly had a copy of Learning Python but I..."
    dc:creator="John"
    dc:date="2004-09-21T23:43:42-05:00" />
</rdf:RDF>
-->


<h2 class="date">September 21, 2004</h2>


<div class="blogbody">
<a name="000486"></a>
<h3 class="title">Python books</h3>

<p>The two books that I'm using to learn Python are:</p>


<ol>
<li><a href="http://www.amazon.com/exec/obidos/tg/detail/-/0596001886/qid=1095824427/sr=8-1/ref=pd_ka_1/104-5193069-9916769?v=glance&amp;s=books&amp;n=507846">Python in a Nutshell</a> by Alex Martelli</li>
<li><a href="http://www.amazon.com/exec/obidos/tg/detail/-/0596001673/ref=pd_bxgy_img_2/104-5193069-9916769?v=glance&amp;s=books">Python Cookbook</a> by Alex Martelli and David Ascher</li>
</ol>

<p>Both are very good books. I briefly had a copy of <a href="http://www.amazon.com/exec/obidos/tg/detail/-/0596002815/ref=pd_bxgy_text_1/104-5193069-9916769?v=glance&amp;s=books&amp;st=*">Learning Python</a> but I traded it in for the Python Cookbook (I had bought it before I realized that I already had a copy of Python in a Nutshell on my bookcase).</p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000486.html">11:43 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=486" onclick="OpenComments(this.href); return false">Comments (2)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=486" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000485"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/229"
    dc:title="Emulating String.Format() semantics in Python"
    dc:identifier="http://www.iunknown.com/2004_09.html#000485"
    dc:subject="Blog"
    dc:description="We&apos;re rather spoiled with positional identifiers in String.Format(). It&apos;s only when you go back to old-school printf style formatting that you realize this. I really wanted that feature back in Python, so I rolled my own today. It was surprisingly..."
    dc:creator="John"
    dc:date="2004-09-21T23:30:41-05:00" />
</rdf:RDF>
-->




<div class="blogbody">
<a name="000485"></a>
<h3 class="title">Emulating String.Format() semantics in Python</h3>

<p>We're rather spoiled with positional identifiers in String.Format(). It's only when you go back to old-school <code>printf</code> style formatting that you realize this. I really wanted that feature back in Python, so I rolled my own today. It was surprisingly easy, and today's Python program taught me a bunch of things about Python, specifically:</p>


<ol>
<li>tuples, lists of tuples, tuples as return values, and tuples in <code>for</code> statements</li>
<li>using <code>eval</code> to compile a custom function on the fly</li>
<li>marveling at how tuples allow both (a,b,) <span class="caps">AND </span>(a,b)</li>
</ol>

<p>Here is today's adventure in Python:</p>

<pre>
import re

url = r'\b((http|ftp|mailto):[\w;/#~:.?+=&amp;%@!\-] +?)(?=[.:?\-]*[^\w;/#~:.?+=&amp;%@!\-]|$)'

inline_args = [\
    (r'\@(.*?)\@', r'<code>$1</code>'),
    (r'\_(.*?)\_', r'&lt;emph&gt;$1&lt;/emph&gt;'),\
    (r'\*(.*?)\*', r'&lt;strong&gt;$1&lt;/strong&gt;'),\
    (r'\&quot;(.*?)\&quot;:(%s)' % url, r'&lt;a href=&quot;$2&quot;&gt;$1&lt;/a&gt;')\
]

re_parseTemplate = re.compile(r'\$(\d+)', re.IGNORECASE)

class parser:
    
    def __init__(self):
        self.templates = list()
        for (regex, template) in inline_args:
            self.templates.append(templateExpression(regex, template))            

    def parse(self, str):
        for template in self.templates:
            str = template.expand(str)
        return str
            
class templateExpression:

    def generateTemplateExpression(self, template):
        templateExpr    = re_parseTemplate.sub(r'%s', template)
        argIndices      = re_parseTemplate.findall(template)

        expr = &quot;'&quot; + templateExpr + &quot;' % (&quot;
        for n in argIndices:
            expr += 'mo.group(%s), ' % n
        expr += ')'
        return expr

    def __init__(self, regex, template):
        self.re_parser = re.compile(regex, re.IGNORECASE)
        expr = self.generateTemplateExpression(template)
        self.lfunc = eval(r'lambda mo : ' + expr)
    
    def expand(self, str):
        return self.re_parser.sub(self.lfunc, str)

p = parser()
print p.parse(r'this is a &quot;url&quot;:http://www.iunknown.com @that@ i _want_ to *test*')
</pre>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000485.html">11:30 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=485" onclick="OpenComments(this.href); return false">Comments (5)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=485" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000484"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/228"
    dc:title="Method interception made easy"
    dc:identifier="http://www.iunknown.com/2004_09.html#000484"
    dc:subject="Blog"
    dc:description="This morning on the train ride into Toronto, I decided to hack up a piece of code that emulates in Python what took me nearly 6 months using C++ and the CLR. One of the wicked cool features of Python..."
    dc:creator="John"
    dc:date="2004-09-20T11:22:43-05:00" />
</rdf:RDF>
-->


<h2 class="date">September 20, 2004</h2>


<div class="blogbody">
<a name="000484"></a>
<h3 class="title">Method interception made easy</h3>

<p>This morning on the train ride into Toronto, I decided to hack up a piece of code that emulates in Python what took me nearly 6 months using C++ and the <span class="caps">CLR. </span>One of the wicked cool features of Python is the ability to dynamically bind and unbind methods to class <em>attributes</em>. An attribute is roughly analogous to a class member in .NET. </p>

<p>This sample adds "execute once" semantics to all methods of a class that belongs to the <code>ExecuteOnce</code> metaclass. There's a couple of interesting things to point out in the code:</p>


<ol>
<li>The <code>StaticCallable</code> class exists only to let me call a static method. This hack seems rather crufty in a language like Python that excels at reducing friction. <strong>Update:</strong> not needed anymore in Python 2.2+.</li>
<li>The <code>sentinel</code> method is the method that gets called in place of the "real" method that I'm intercepting. In it, I check for the existence of a sentinel flag that marks whether that method has executed already. </li>
</ol>

<p>Here's the code in all of its glory. Once again, marvel at the elegence of this technique:</p>

<pre>

# Metaclass that performs execute-once semantics
    
class ExecuteOnce(type):
    def sentinel(methodname):
        def _method(self, *arg1, **argd):
            sentinelname = '_shadow_%s_executed' % methodname
            shadowmethodname = '_shadow_%s' % methodname

            if hasattr(self, sentinelname) == False:
                setattr(self, sentinelname, True)
                return getattr(self, shadowmethodname)(*arg1, **argd)
            else:
                return
            
        return _method

    sentinel = staticmethod(sentinel)
    
    def __new__(cls, classname, bases, classdict):
        for attr, item in classdict.items():
            if callable(item):
                classdict['_shadow_%s' % attr] = item
                classdict[attr] = ExecuteOnce.sentinel(attr)

        return type.__new__(cls, classname, bases, classdict)

class Test(object):
    __metaclass__ = ExecuteOnce
    def method1(self):
        print &quot;In method1&quot;

t = Test()
t.method1()
t.method1()
t.method1()
</pre><p><strong>Update:</strong> I've incorporated Alan Hecht's suggestion from my comments to fix a bug error in my code and eliminate the need for the <code>StaticCallable</code> helper class.</p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000484.html">11:22 AM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=484" onclick="OpenComments(this.href); return false">Comments (9)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=484" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000483"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/227"
    dc:title="Python and parsing"
    dc:identifier="http://www.iunknown.com/2004_09.html#000483"
    dc:subject="Blog"
    dc:description="Wow. I&apos;m having fun tonight. I discovered a package called ToyParser which is an LL parser generator with limited backtracking abilities. It&apos;s sufficient for building simple grammars for little languages. I refactored my earlier program that parses song input, and..."
    dc:creator="John"
    dc:date="2004-09-18T02:36:01-05:00" />
</rdf:RDF>
-->


<h2 class="date">September 18, 2004</h2>


<div class="blogbody">
<a name="000483"></a>
<h3 class="title">Python and parsing</h3>

<p>Wow. I'm having fun tonight. I discovered a package called <a href="http://christophe.delord.free.fr/en/tpg/">ToyParser</a> which is an <acronym title="1+">LL</acronym> parser generator with limited backtracking abilities. It's sufficient for building simple grammars for little languages.</p>

<p>I refactored my earlier program that parses song input, and I defined a little language for scripting <a href="http://www.microsoft.com/msagent/default.asp">Microsoft Agent</a> characters. Here's a simple script that I just wrote:</p>

<pre>
show
move 300,400
play Greet
speak &quot;Hello, Matthew!&quot;
speak &quot;I'm so happy to meet you!!&quot;
play Pleased
speak &quot;I hear it's your birthday!&quot;
speak &quot;So I will sing you a birthday song!&quot;
play MoveRight
move 1000,0
sing &quot;!f#c Hap- #c p #d birth-#c day !s#f to #e you.&quot;
sing &quot;!f#c Hap- #c p #d birth-#c day !s#g to #f you.&quot;
sing &quot;!f#c Hap- #c p #cc birth- #aa day !s#f to  #e Maa- #d foo.&quot;
sing &quot;!f#bbf Hap- #bbf p #aa birth- #f day !s#g to #f you.&quot;
play Wave
speak &quot;Would you like to play a game?&quot;
play DoMagic1
speak &quot;Isn't this great magic?&quot;
hide
</pre><p>And here is the ridiculously simple Python program that I wrote that parses it. Notable things in this program are my first Python classes, <code>SongParser</code> and <code>AgentParser</code>. Also, notice how I use the <code>exec</code> statement to execute the code that my <code>AgentParser</code> class generates:</p>

<pre>
import re
import tpg
import win32com.client
import fileinput

class SongParser:
    notes = dict([['c',65],['d',73],['e',82],['f',87],\
                  ['g',98],['aa',110],['bbf',117],['cc',131]])
    tempo = dict([['f',130],['s',55]])

    re_markup = re.compile(r'([\#|\!])(\w+)', re.IGNORECASE)

    markup = dict([['#', (lambda mo : '\\pit=%s\\' \
                          % SongParser.notes[mo.group(2)])],
                   ['!', (lambda mo : '\\spd=%s\\' \
                          % SongParser.tempo[mo.group(2)])]])

    def parseSong(self, song):
        return '\\chr=\&quot;monotone\&quot;\\' + \
               SongParser.re_markup.sub(lambda mo : \
                                        SongParser.markup[mo.group(1)](mo), song)

class AgentParser(tpg.Parser):
    r&quot;&quot;&quot;
        # Tokens
        separator   spaces  '\s+';
        token       int     '\d+' int;
        token       id      '\w+' ;
        token       string  '\&quot;.*\&quot;' ;

        # Rules
        START/s -&gt; statement/s (statement/k $ s += k $)*;
        statement/s -&gt; (show/k | move/k | play/k | speak/k | sing/k | hide/k) $ s = 'self.agent.%s\n' % k $;

        show/s  -&gt; 'show'                               $ s = 'Show()' $;
        move/m  -&gt; 'move' int/x ',' int/y               $ m = &quot;MoveTo(%i, %i)&quot; % (x, y) $;
        play/p  -&gt; 'play' id/n                          $ p = &quot;Play(\&quot;%s\&quot;)&quot; % n $;
        speak/s -&gt; 'speak' string/n                     $ s = &quot;Speak(%s)&quot; % n $;
        sing/s  -&gt; 'sing' string/n                      $ s = &quot;Speak(self.songParser.parseSong(%s))&quot; % n$;
        hide/h  -&gt; 'hide'                               $ h = 'Hide()' $;
    &quot;&quot;&quot;
    def __init__(self, name, file, size):
        self.server = win32com.client.Dispatch(&quot;Agent.Control.2&quot;)
        self.songParser = SongParser()
        self.server.Connected = -1
        self.server.Characters.Load(name, file)
        self.agent = self.server.Characters(name)
        self.agent.Width = size;
        self.agent.Height = size;
        tpg.Parser.__init__(self)

    def run(self, expr):
        exec self(expr)

peedy = AgentParser(&quot;Peedy&quot;, &quot;Peedy.acs&quot;, 600)
for line in fileinput.input():
    peedy.run(line)
fileinput.close()
</pre><p>I'm blown away by how productive this environment is.</p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000483.html">02:36 AM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=483" onclick="OpenComments(this.href); return false">Comments (3)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=483" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000482"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/226"
    dc:title="Experiments with lambda functions"
    dc:identifier="http://www.iunknown.com/2004_09.html#000482"
    dc:subject="Blog"
    dc:description="Lambda functions in Python, which are somewhat related to anonymous methods in C# can be really useful in certain situations. In this example, I&apos;m using lambda functions to define jump tables based on dictionaries. Using a single line of code,..."
    dc:creator="John"
    dc:date="2004-09-17T20:57:02-05:00" />
</rdf:RDF>
-->


<h2 class="date">September 17, 2004</h2>


<div class="blogbody">
<a name="000482"></a>
<h3 class="title">Experiments with lambda functions</h3>

<p>Lambda functions in Python, which are somewhat related to <a href="http://download.microsoft.com/download/8/1/6/81682478-4018-48fe-9e5e-f87a44af3db9/SpecificationVer2.doc">anonymous methods in C#</a> can be really useful in certain situations. </p>

<p>In this example, I'm using lambda functions to define jump tables based on dictionaries. Using a single line of code, I can substitute arbitrary markup blocks in a "little" language that I defined for writing music. There are two markup characters: ! and #. ! lets me declare the tempo of the music, and # lets me declare the pitch of the note. </p>

<pre>
import re
import win32com.client

notes = dict([['c',65],['d',73],['e',82],['f',87],['g',98],['aa',110],['bbf',117],['cc',131]])
tempo = dict([['f',130],['s',55]])

re_markup = re.compile(r'([\#|\!])(\w+)', re.IGNORECASE)

markup = dict([['#', (lambda mo : '\\pit=%s\\' % notes[mo.group(2)])],
               ['!', (lambda mo : '\\spd=%s\\' % tempo[mo.group(2)])]])

def parseSong(song):
    return '\\chr=\&quot;monotone\&quot;\\' + re_markup.sub(lambda mo : markup[mo.group(1)](mo), song)

song = ['!f#c Hap- #c p #d birth-#c day !s#f to #e you.',
        '!f#c Hap- #c p #d birth-#c day !s#g to #f you.',
        '!f#c Hap- #c p #cc birth- #aa day !s#f to  #e Maa- #d foo.',
        '!f#bbf Hap- #bbf p #aa birth- #f day !s#g to #f you.']

agent = win32com.client.Dispatch(&quot;Agent.Control.2&quot;)
agent.Connected = -1
agent.Characters.Load(&quot;Peedy&quot;, &quot;Peedy.acs&quot;)

peedy = agent.Characters(&quot;Peedy&quot;)
peedy.Height = 600
peedy.Width = 600
peedy.LanguageID = 0x409
peedy.Show()

for line in song:
    peedy.Speak(parseSong(line))

peedy.Hide()
</pre><p>I'm amazed that I can create in such a compact form a "little language" for writing a birthday song for my boy Matthew who will turn one on September 22. Note that this little sample program also uses <span class="caps">COM</span> to talk to Microsoft Agent via <a href="http://starship.python.net/crew/mhammond/">Mark Hammond's</a> most excellent <code>win32com</code> libraries (and <span class="caps">IDE</span>!)</p>

<p>Wow. Programming is becoming a lot of fun again. </p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000482.html">08:57 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=482" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=482" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000481"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/225"
    dc:title="Why?"
    dc:identifier="http://www.iunknown.com/2004_09.html#000481"
    dc:subject="Blog"
    dc:description="Luke Tymowski is an old friend of mine. I think I&apos;ve known Luke for almost 8 years now. He&apos;s an excellent photographer, and is documenting street scenes in Toronto with at least one brand new photograph each day. This blog..."
    dc:creator="John"
    dc:date="2004-09-17T15:03:59-05:00" />
</rdf:RDF>
-->




<div class="blogbody">
<a name="000481"></a>
<h3 class="title">Why?</h3>

<p><a href="http://tripping.seeto.com">Luke Tymowski</a> is an old friend of mine. I think I've known Luke for almost 8 years now. He's an excellent photographer, and is documenting street scenes in Toronto with at least one brand new photograph each day. This blog is hosted on a computer in Luke's apartment.</p>

<p>Many years ago, Luke tried to introduce me to a content publishing system called <a href="http://www.zope.org">Zope</a>, which was built using an obscure language (both to me and to most folks at that time) called <a href="http://www.python.org">Python</a>. </p>

<p>In those days, I was, um, rather resistent to new ideas. I'm not exactly sure why - perhaps it was due to the fact that I was too respectful of authority. Here's an interesting anecdote from my checkered past:</p>

<p>In my Ph.D. candidacy oral examination (a not-so-fun event where a panel of professors gang up on you to prove in no uncertain terms that you still don't know everything), one of the professors made a mistake. <a href="http://www.chem.utoronto.ca/people/academic/kresgej.html">Jerry Kresge</a> who is one of the luminaries in Physical Organic Chemistry was trying to get me to represent one of the intermediates in my research as an enolate - a chemical intermediate that he had spent the better part of his life studying. I realized that Dr. Kresge was wrong - the intermediate was actually an ylide, not an enolate - but I wasted serveral minutes at the blackboard trying to follow his faulty chain of reasoning. But then again, who was I to question Jerry <em>Kresge</em>?</p>

<p>When <a href="http://www.chem.utoronto.ca/people/academic/klugerr.html">Ronald Kluger</a>, my Ph.D. research supervisor debriefed me after the exam, he pointed out that I hadn't challenged Kresge on his mistake. He pointed out then that I was too respectful of authority, and that authorities can and do make mistakes. Valuable advice that I had promptly forgotten, of course.</p>

<p>Back to the point of this post: I hadn't spent much time looking at Python because I was rather closed-minded. I had categorically dismissed scripting / dynamically typed languages for the same reasons. I belonged, after all to the strongly-typed C++/COM fraternity and those authorities <em>must</em> be right. </p>

<p>I wonder what would have happened if, say, <a href="http://www.gotdotnet.com/team/dbox/">Don Box</a> had told me to look at this new language called Python back then. Maybe things would be a lot different today. </p>

<p>It's time to change my default filters - and Luke - you were right.</p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000481.html">03:03 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=481" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=481" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000480"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/224"
    dc:title="Expanding my horizons"
    dc:identifier="http://www.iunknown.com/2004_09.html#000480"
    dc:subject="Blog"
    dc:description="<![CDATA[Wow ... this was fun (but not the part where I had to discover the magic agent.Connected = -1 invocation). import win32com.client agent = win32com.client.Dispatch(&quot;Agent.Control.2&quot;) agent.Connected = -1 agent.Characters.Load(&quot;Peedy&quot;, &quot;Peedy.acs&quot;) peedy = agent.Characters(&quot;Peedy&quot;) peedy.LanguageID = 0x409 peedy.Show() peedy.Speak(&quot;Hello, World!&quot;) peedy.Play(&quot;Blink&quot;)...]]>"
    dc:creator="John"
    dc:date="2004-09-17T14:31:21-05:00" />
</rdf:RDF>
-->




<div class="blogbody">
<a name="000480"></a>
<h3 class="title">Expanding my horizons</h3>

<p>Wow ... this was fun (but not the part where I had to discover the magic <code>agent.Connected = -1</code> invocation). </p>

<pre>
import win32com.client

agent = win32com.client.Dispatch(&quot;Agent.Control.2&quot;)
agent.Connected = -1
agent.Characters.Load(&quot;Peedy&quot;, &quot;Peedy.acs&quot;)

peedy = agent.Characters(&quot;Peedy&quot;)

peedy.LanguageID = 0x409
peedy.Show()
peedy.Speak(&quot;Hello, World!&quot;)
peedy.Play(&quot;Blink&quot;)
</pre>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000480.html">02:31 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=480" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=480" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000479"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/223"
    dc:title="Paul Graham "
    dc:identifier="http://www.iunknown.com/2004_09.html#000479"
    dc:subject="Blog"
    dc:description="I just finished reading Hackers and Painters today. There are a lot of thought-provoking essays in this book. You can either buy the book like I did, or you can read his essays online at his web site. This book..."
    dc:creator="John"
    dc:date="2004-09-16T16:41:19-05:00" />
</rdf:RDF>
-->


<h2 class="date">September 16, 2004</h2>


<div class="blogbody">
<a name="000479"></a>
<h3 class="title">Paul Graham </h3>

<p>I just finished reading <a href="http://www.paulgraham.com">Hackers and Painters</a> today. There are a lot of thought-provoking essays in this book. You can either buy the book like I did, or you can read his essays online at his web site. </p>

<p>This book is interesting because it gets you to stop, think, and re-evaluate your assumptions. You will not agree with everything he says in this book, but he will get you to think about his opinions because they are stated very persuasively.</p>

<p>Paul's a Lisp-bigot. That's fine, because he defends his position with a zeal that you do not normally see. And he makes some very good points about programming languages being a notation for ideas, and the need to keep the number of operators (or axioms as he likes to refer to them) to an absolute minimum to enable composition of those ideas.</p>

<p>Paul (unfortunately) toes the party line on open source as well. It seems that he's heavily influenced by the Eric <span class="caps">S. </span>Raymond school of thought - which is fine because at least you know where he's coming from. It's also unfortunate because some of that zealotry shines through: large companies are incapable of producing good software, the web is the one true way, and the open source community will deliver us from the tyranny of Microsoft. That zealotry has the unfortunate side-effect of getting some folks to flip the "bozo bit" on him and ignore the very good points that he has to make.</p>

<p>The chapters on <a href="http://www.paulgraham.com/nerds.html">Why nerds are unpopular</a> and <a href="http://www.paulgraham.com/hp.html">Hackers and painters</a> are excellent. Hackers and painters can be used to motivate extreme programming principles based on the painter analogy of beginining with a sketch and filling in the details. He also identifies <em>morale</em> as being an important component of software development, which is enncouraged by iterative development. Finally, he spends a lot of time talking about programming languages that don't get in the way of expression (can you guess whether he favors static or dynamic typing?). </p>

<p>Highly recommended reading for all developers.</p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000479.html">04:41 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=479" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=479" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000478"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/222"
    dc:title="NAnt target inheritance"
    dc:identifier="http://www.iunknown.com/2004_09.html#000478"
    dc:subject="Blog"
    dc:description="The engine that controls my new publishing system is a set of NAnt scripts. My primary reason for creating my publishing system was to ensure accuracy in the technical content that I produce. I have always felt that it was..."
    dc:creator="John"
    dc:date="2004-09-15T19:48:24-05:00" />
</rdf:RDF>
-->


<h2 class="date">September 15, 2004</h2>


<div class="blogbody">
<a name="000478"></a>
<h3 class="title">NAnt target inheritance</h3>

<p>The engine that controls my new publishing system is a set of NAnt scripts. My primary reason for creating my publishing system was to ensure accuracy in the technical content that I produce. I have always felt that it was unforgivable to have code that doesn&#8217;t compile and run in a technical publication. My recent experience with LaTeX and numerous errors in its published documentation only reinforces my belief that users are incredibly frustrated when they need to learn a new concept <strong>and</strong> correct careless syntax errors.</p>

<p>I set a very high bar for simplicity and extensibility of my build scripts. Ideally, you would create a new directory and code within that directory would be auto-magically compiled, unit tested and deployed based on a set of predefined rules. This is the simplicity angle. However, not all code fits into a standard template of &#8220;compile this stuff into a <span class="caps">DLL</span> assembly that references all of the standard <code>System.*</code> assemblies&#8221;. This is the extensibility angle.</p>

<p>I would gain simplicity through default targets such as <code>Compile</code>, which simply compiles all <code>*.cs</code> files in a directory into a library assembly that references the standard <code>System.*</code> assemblies. I would gain extensibility through custom targets such as <code>CustomCompile</code>, which would be supplied in a custom <code>.build</code> file in the directory. In effect, I would allow users to <em>override</em> the behavior of the default target through custom targets. But wait, how do you override a target in NAnt?</p>

<p>The answer is: you can&#8217;t. But you can fake it and get almost the same semantics. NAnt 0.85 adds custom functions and expressions. You can test for the existence of a target, and invoke it if it exists. In effect, you would write:</p>

<pre>
&lt;if test=&#148;${target::exists(&#145;CustomCompile&#146;)}&#148;&gt;
  &lt;call target=&#148;CustomCompile&#148;/&gt;
&lt;/if&gt;
&lt;ifnot test=&#148;${target::exists(&#145;CustomCompile)}&#148;&gt;
  &lt;csc target=&quot;library&quot; output=&quot;output.dll&quot;&gt;
    &lt;references&gt;
      &lt;include name=&quot;${nant.settings.currentframework.frameworkdirectory}/system.*.dll&quot;/&gt;
      &lt;exclude name=&quot;${nant.settings.currentframework.frameworkdirectory}/system.enterpriseservices.thunk.dll&quot;/&gt;
    &lt;/references&gt;
    &lt;sources&gt;
      &lt;include name=&#148;*.cs&quot;/&gt;
    &lt;/sources&gt;
  &lt;/csc&gt;
&lt;/ifnot&gt;
</pre><p>If you&#8217;re lucky enough to be using MSBuild (I&#8217;m not), Alex Kipman &amp; co. natively expose the ability to override targets.</p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000478.html">07:48 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=478" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=478" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000477"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/221"
    dc:title="Leaky abstractions and macro languages"
    dc:identifier="http://www.iunknown.com/2004_09.html#000477"
    dc:subject="Blog"
    dc:description="I&apos;ve been working rather extensively with TeX/LaTeX/ConTeXt over the past couple of weeks. For the uninitiated, this is an extremely powerful desktop typesetting system that&apos;s been under development for over 25 years. Donald Knuth implemented the core TeX (pronounced &quot;tech&quot;)..."
    dc:creator="John"
    dc:date="2004-09-12T15:26:47-05:00" />
</rdf:RDF>
-->


<h2 class="date">September 12, 2004</h2>


<div class="blogbody">
<a name="000477"></a>
<h3 class="title">Leaky abstractions and macro languages</h3>

<p>I've been working rather extensively with TeX/LaTeX/ConTeXt over the past couple of weeks. For the uninitiated, this is an extremely powerful desktop typesetting system that's been under development for over 25 years. Donald Knuth implemented the core TeX (pronounced "tech") system that defines low-level typesetting commands and algorithms. Leslie Lamport implemented LaTeX, which is a set of macros that layer on top of TeX, and Hans Hagen implemented ConTeXt, which is a competing set of macros that layer on top of TeX.</p>

<p>I chose to work initially in LaTeX to avoid the complexities of dealing directly with TeX. In other words, I chose an abstraction over the core technology. In this way, I feel very much like a VB programmer who chose to use an abstraction (VB) that layers on top of the core technology (Win32) as opposed to say a C/C++ programmer who chose to speak directly to the underlying <span class="caps">API.</span></p>

<p>There are certainly pros and cons to this approach. I was able to get a document produced very rapidly using LaTeX. However, my "hello, world" documents had very little relation to the documents that I really wanted to produce - a set of courseware for my company, <a href="http://www.objectsharp.com">ObjectSharp</a>. My requirements didn't fit into the abstractions defined by a couple of standard set of macro packages that I experimented with: the ubiquitous <code>book</code> class and the more powerful <code>memoir</code> class.  </p>

<p>So I decided to look further. After a bit of digging in the TeX distribution that I used, <a href="http://www.miktex.org">MikTeX</a>, I discovered <a href="http://www.pragma-ade.com/">ConTeXt</a>. The sample documents (see the manuals) created under ConTeXt were beautiful - far better than most of the other macro packages that I had seen. So I decided to give ConTeXt a try even though I had already adapted my publishing system to generate LaTeX macros.</p>

<p>At first everything worked quite nicely. Then I wanted to do something simple that I had avoided while working with LaTeX: switch fonts. Fonts are something that neither LaTeX nor ConTeXt do a good job at defining an abstraction for. This led to two very pain-filled days where I attempted to wrestle with the TeX font system. The documentation is sparse, and at times misleading. There are many steps that must be followed precisely otherwise nothing works. </p>

<p>After many attempts and late nights, I finally have the magic incantation that allowed me to import arbitrary PostScript and TrueType fonts that I wanted to use to define the typefaces for my documents. But I still have no idea what I'm doing.</p>

<p>The abstraction that LaTeX and ConTeXt try to present to you is <a href="http://www.joelonsoftware.com/articles/LeakyAbstractions.html">leaky, like all non-trivial abstractions</a>. I don't have the time required to study the underlying technology (TeX) that they attempt to abstract - I need to get my publishing system working so that I can go back to my real job - creating content. And I'll take all sorts of shortcuts to try and get me there faster.</p>

<p>My experience with TeX/LaTeX/ConTeXt has given me far more appreciation for the typical day of a VB programmer. They need to understand just enough of the technology to get their jobs done - which in the end involve modeling some sort of business process, and very little with the technology itself. </p>

<p>My job at ObjectSharp is to reflect on my experiences learning a different technology and discover <em>why</em> certain elements caused me pain. When explaining .NET to students, I need to explain how the abstraction that they work with models the underlying technology. I need to explain to them how to figure out what's going on when something doesn't work as they expected it to. I need to tell them where to look for more information when they need to do something a little off the beaten path. </p>

<p>That's the story that I would have loved to have heard about ConTeXt and TeX: how they relate to each other, a look at how TeX works, and details about the abstraction that ConTeXt layers over TeX. I would have loved to learn how to debug my scripts - instead of changing a parameter, recompiling and looking at the results. I would have loved to have some detailed documentation (or at least enough understanding to be able to make sense of the source code for the macros that weren't documented). </p>

<p>One observation that I do take away from my experience is just how difficult it is to create a uniform <span class="caps">API</span> that responds predictably. ConTeXt is far better than LaTeX in this regard: it was developed as a single macro package and is far more uniform in its design than LaTeX.</p>

<p>It also has an awful lot of documentation that ships with the standard distribution. While the quantity and presentation of the documentation is impressive, the story that it presents is awful. It's little more than a laundry list of features without anything to explain how the features tie together, or how those features are implemented on top of TeX. Furthermore, they don't provide source code for the manuals, which makes it very difficult to copy-paste-and-tweak the examples.</p>

<p>But overall, I'm very impressed with what I can do with this technology. Hopefully our students will as well.</p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000477.html">03:26 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=477" onclick="OpenComments(this.href); return false">Comments (5)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=477" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/2004_09.html#000476"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/220"
    dc:title="Guess Who&apos;s Back?"
    dc:identifier="http://www.iunknown.com/2004_09.html#000476"
    dc:subject="Blog"
    dc:description=" It&apos;s been BUSY. In no particular order this is what I&apos;ve been up to over the past month: Moved to our new house Sold our old apartment Designed a new curriculum for ObjectSharp Taught two classes using our new..."
    dc:creator="John"
    dc:date="2004-09-11T12:10:05-05:00" />
</rdf:RDF>
-->


<h2 class="date">September 11, 2004</h2>


<div class="blogbody">
<a name="000476"></a>
<h3 class="title">Guess Who's Back?</h3>

<p><img src="Images/whoisback.jpg" alt="" /></p>

<p>It's been <span class="caps">BUSY. </span>In no particular order this is what I've been up to over the past month:</p>


<ol>
<li>Moved to our new house</li>
<li>Sold our old apartment</li>
<li>Designed a new curriculum for <a href="http://www.objectsharp.com">ObjectSharp</a></li>
<li>Taught two classes using our new courseware</li>
<li>Wrote an automated publishing system using NAnt/Perl/TeX/LaTeX/ConTeXt</li>
</ol>

<p>Throw in babysitting duties, adjusting to a new community and all of the new house "issues", and something had to give.</p>

<p>What's in store in the near future:</p>


<ol>
<li>A visit to <span class="caps">MSFT</span> the week of Oct. 4. Should be fun to catch up with old friends out there.</li>
<li>Win-Dev the week of Oct 25. Yes I'm still working on talks for this - Unit testing with <span class="caps">ASP.NET</span> and Understanding <span class="caps">IIS 6.0 </span>/ <span class="caps">ASP.NET 1.1.</span></li>
<li>A whole pile of work here in Toronto. I'm really optimistic about the recent surge in business for us at ObjectSharp. Should be a fun year coming up.</li>
</ol>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000476.html">12:10 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=476" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
		| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=476" onclick="OpenTrackback(this.href); return false">TrackBack</a>
	
</div>

</div>


</div>
</div>

</body>
</html>
