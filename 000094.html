<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>iunknown.com: Hello from WinDev 2002</title>

<link rel="stylesheet" href="http://www.iunknown.com/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.iunknown.com/index.rdf" />

<link rel="start" href="http://www.iunknown.com/" title="Home" />
<link rel="prev" href="http://www.iunknown.com/000093.html" title="Complications arising from weaving system methods" />

<link rel="next" href="http://www.iunknown.com/000095.html" title="Get Organized!" />


<script type="text/javascript" language="javascript">
<!--

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

var HOST = 'www.iunknown.com';

// Copyright (c) 1996-1997 Athenia Associates.
// http://www.webreference.com/js/
// License is granted if and only if this entire
// copyright notice is included. By Tomer Shiran.

function setCookie (name, value, expires, path, domain, secure) {
    var curCookie = name + "=" + escape(value) + ((expires) ? "; expires=" + expires.toGMTString() : "") + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + ((secure) ? "; secure" : "");
    document.cookie = curCookie;
}

function getCookie (name) {
    var prefix = name + '=';
    var c = document.cookie;
    var nullstring = '';
    var cookieStartIndex = c.indexOf(prefix);
    if (cookieStartIndex == -1)
        return nullstring;
    var cookieEndIndex = c.indexOf(";", cookieStartIndex + prefix.length);
    if (cookieEndIndex == -1)
        cookieEndIndex = c.length;
    return unescape(c.substring(cookieStartIndex + prefix.length, cookieEndIndex));
}

function deleteCookie (name, path, domain) {
    if (getCookie(name))
        document.cookie = name + "=" + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + "; expires=Thu, 01-Jan-70 00:00:01 GMT";
}

function fixDate (date) {
    var base = new Date(0);
    var skew = base.getTime();
    if (skew > 0)
        date.setTime(date.getTime() - skew);
}

function rememberMe (f) {
    var now = new Date();
    fixDate(now);
    now.setTime(now.getTime() + 365 * 24 * 60 * 60 * 1000);
    setCookie('mtcmtauth', f.author.value, now, '', HOST, '');
    setCookie('mtcmtmail', f.email.value, now, '', HOST, '');
    setCookie('mtcmthome', f.url.value, now, '', HOST, '');
}

function forgetMe (f) {
    deleteCookie('mtcmtmail', '', HOST);
    deleteCookie('mtcmthome', '', HOST);
    deleteCookie('mtcmtauth', '', HOST);
    f.email.value = '';
    f.author.value = '';
    f.url.value = '';
}

//-->
</script>





</head>

<body>

<div id="banner">
<h1><a href="http://www.iunknown.com/" accesskey="1"><img src="/mt-static/images/iunknown.png" width="350" height="60" border="0"></a></h1>
<span class="description">Home of the Practical Eye for the .NET Guy</span>
</div>

<div id="container">

<div class="blog">

<div id="menu">
<a href="http://www.iunknown.com/000093.html">&laquo; Complications arising from weaving system methods</a> |

<a href="http://www.iunknown.com/">Main</a>
| <a href="http://www.iunknown.com/000095.html">Get Organized! &raquo;</a>

</div>

</div>


<div class="blog">

<h2 class="date">May 05, 2002</h2>

<div class="blogbody">

<h3 class="title">Hello from WinDev 2002</h3>

<div class="midAds">
<script type="text/javascript"><!--
google_ad_client = "pub-8264790134546506";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_channel ="";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

<p><P>The spring conference circuit is finally over! After logging over 20,000 miles over the past month, I'm relieved to be writing this on the plane ride home, where I plan on staying put for at least 6 weeks or so.</P><br />
<P>I presented several sessions at WinDev 2002 in New Orleans this year. There were some oldies: Understanding XSLT, which I have presented quite a few times in the past, and some brand new talks such as WebForms Internals. The WebForms Internals talk provided me with an excuse to show off CLAW to yet another audience. The demo, however, required me to modify CLAW so that it works with ASP.NET code.</P><br />
<P>I spent the first couple of days at WinDev updating CLAW so that it works correctly inside the aspnet_wp.exe worker process. This proved to be rather painful for two reasons. The first was complications involved in recompiling CLAW itself, and the second involved complications involved in redefining weaves.</P><br />
<P>To understand why recompiling CLAW was painful, we need to understand how the CLR loads profilers.&nbsp;CLR profilers are loaded based on the presence of two environment variables: Cor_Enable_Profiling and COR_PROFILER. Cor_Enable_Profiling must be set to 0x01, and COR_PROFILER must be set to the CLSID of the COM object that contains the profiler's implementation. When the CLR creates a new managed process, it looks for the presence of these environment variables. If they are set, it loads the designated profiler. </P><br />
<P>However, recompiling CLAW was painful because </P><br />
<P>&nbsp;Recompiling CLAW required rebooting IIS using the IISRESET command .to restart inetinfo.exe, and by extension, aspnet_wp.exe which is a child process of inetinfo.exe.</P><br />
<P>&nbsp;</P></p>

<a name="more"></a>


<span class="posted">Posted by John at May  5, 2002 08:30 AM

<br /></span>

</div>

<div class="comments-head"><a name="mailthisentry"></a>Mail this entry</div>

<form method="post" action="http://www.iunknown.com/cgi-bin/mt-send-entry.cgi">
<input type="hidden" name="entry_id" value="94" />
<input type="hidden" name="_redirect" value="http://www.iunknown.com/000094.html" />
Email this entry to:<br />
<input name="to" size="20" /><br /><br />
Your email address:<br />
<input name="from" size="20" /><br /><br />
Message (optional):<br />
<textarea name="message" rows="5" cols="20" wrap="virtual"></textarea><br /><br />
<input type="submit" value="Send" />
</form>


<div class="comments-head"><a name="comments"></a>Comments</div>





</div>
</div>
</body>
</html>
