<!DOCTYPE html>
<html xmlns:fb="http://www.facebook.com/2008/fbml" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
      <meta http-equiv="X-UA-Compatible" content="chrome=1" />
      <meta name="width" content="500" />
      <meta name="generator" content="Posterous" />
      <script src="/javascripts/vendor/modernizr.custom.09241.js?1347051610" type="text/javascript"></script>
      <!--[if lt IE 9]>
        <script src="/javascripts/innershiv.js?1347051610" type="text/javascript"></script>
      <![endif]-->
      <link href="/bundles/posts.css" media="screen" rel="stylesheet" type="text/css" />
      <!--[if lt IE 9]>
        <link href="/bundles/ie.css" media="screen" rel="stylesheet" type="text/css" />
      <![endif]-->
      <link rel="alternate" type="application/rss+xml" href="http://feeds.feedburner.com/LessIsBetter"/>
      <meta name="medium" content="blog" /><link rel="image_src" href="http://posterous.com/images/profile/missing-public-space-75.png" />
      <script type="text/javascript">
//<![CDATA[
window._token = 'GjijbpbQ7s4PAVou+XXaUAqSqpOg1cBKohxQBCKJ7J0='; beforeload = (new Date()).getTime(); pagetype = 'list';
//]]>
</script>
      <script src="/bundles/sites_initialization.js" type="text/javascript"></script>
      <script type="text/javascript">
//<![CDATA[
var $j = jQuery.noConflict();
//]]>
</script>
      <script type="text/javascript">
//<![CDATA[
var POSTEROUS_HOSTNAME = 'posterous.com'
//]]>
</script>
      <script data-posterous-deferred-content-url="http://iunknown.com/posts/deferred_content.jsonp" data-posts-data="%5B%7B%22post_is_private%22%3Afalse%2C%22post_id%22%3A36932770%2C%22post_url_slug%22%3A%22ben-and-us%22%2C%22user_id%22%3A931119%7D%2C%7B%22post_is_private%22%3Afalse%2C%22post_id%22%3A36932759%2C%22post_url_slug%22%3A%22introducing-benjamin-peter-lam%22%2C%22user_id%22%3A931119%7D%2C%7B%22post_is_private%22%3Afalse%2C%22post_id%22%3A36932758%2C%22post_url_slug%22%3A%22dreamhost-for-22-usd-first-year%22%2C%22user_id%22%3A931119%7D%2C%7B%22post_is_private%22%3Afalse%2C%22post_id%22%3A36932756%2C%22post_url_slug%22%3A%22clr-object-lifetime%22%2C%22user_id%22%3A931119%7D%2C%7B%22post_is_private%22%3Afalse%2C%22post_id%22%3A36932752%2C%22post_url_slug%22%3A%22mindbinders%22%2C%22user_id%22%3A931119%7D%2C%7B%22post_is_private%22%3Afalse%2C%22post_id%22%3A36932750%2C%22post_url_slug%22%3A%22how-meta-can-you-go%22%2C%22user_id%22%3A931119%7D%2C%7B%22post_is_private%22%3Afalse%2C%22post_id%22%3A36932746%2C%22post_url_slug%22%3A%22refactoring-cil%22%2C%22user_id%22%3A931119%7D%2C%7B%22post_is_private%22%3Afalse%2C%22post_id%22%3A36932740%2C%22post_url_slug%22%3A%22hello-rubyclr%22%2C%22user_id%22%3A931119%7D%2C%7B%22post_is_private%22%3Afalse%2C%22post_id%22%3A36932735%2C%22post_url_slug%22%3A%22democamp%22%2C%22user_id%22%3A931119%7D%2C%7B%22post_is_private%22%3Afalse%2C%22post_id%22%3A36932732%2C%22post_url_slug%22%3A%22third-drop-of-rbdynamicmethod%22%2C%22user_id%22%3A931119%7D%5D" id="posterous_initialization_script" src="/javascripts/initialize.js?1347051610" type="text/javascript"></script>
      
    <script src="/bundles/tags.js" type="text/javascript"></script><link rel="canonical" href="http://iunknown.com" />
<link href="/themes/light-matter/post-style.css" rel="stylesheet" type="text/css" />
<!--[if lte IE 8]>
	<link href="/themes/light-matter/ie-style.css" rel="stylesheet" type="text/css" />
<![endif]-->
<title>John Lam on Software - Home</title>
</head>
<body><div class="posterous_site_data" data-post-id="undefined" data-posterous-hostname="posterous.com" data-show-type="site" data-site-id="2278433" data-site-is-private="false" data-site-location="false" data-site-type="posterous" data-user-id="931119"></div><div class="posterous_ojs" data-posterous-admin-box="true"></div><div class="posterousPrivateBox">
	
	
</div>
      <div id="fb-root"></div>
        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId  : '6694405826',
              status : true, // check login status
              cookie : true, // enable cookies to allow the server to access the session
              xfbml  : true, // parse XFBML
              oauth  : true

            });
            
          };

          (function() {
            var e = document.createElement('script');
            e.type = 'text/javascript';
            e.src = 'http://connect.facebook.net/en_US/all.js';
            e.async = true;
            document.getElementById('fb-root').appendChild(e);
          }());
        </script>
    
  <div id="pbar">
        				<noscript>
  <div id="posterousbar_nojs">
    <a href="http://posterous.com/"><img src="/images/header/yellow.png" alt="Posterous" /></a>
  </div>
</noscript>
              </div>
<div id="header-container">
	<div id="header">
		
		<h1 class="site-name"><a href="http://iunknown.com">John Lam on Software</a></h1>
		<p class="site-description"></p>
	</div>
</div>

                
	<div id="pages-container">
		<div id="pages">
            <ul>
            	
                
                    <li><a href="http://about.me/jlam" title="About me" class="">About me</a></li>
                
              
            </ul>
		</div>
	</div>

              
<div id="container">
	<ul class="post-list clearfix">
		
			<li class="post-item clearfix" id="post_36932770">
				<div class="title-block">
					
						<h3 class="title" id="posttitle_36932770"><a href="http://iunknown.com/2005/12/ben-and-us.html">Ben and us</a></h3>
					
					
						<ul class="meta">
							<li class="date">24 Dec 2005</li>
							<li class="comments"><a href="http://iunknown.com/2005/12/ben-and-us.html" id="comment_link_36932770">0 Responses</a></li>
							<li class="views"><div class="posterous_ojs" data-posterous-view-count="true" data-posterous-post-id="36932770"></div>&nbsp;views</li>
                            
                
              
						</ul>
					
					
					<div class="editbox clearfix" id="editunit_36932770">
						
        				
                  <ul class="mini_commands posterous_edit_box posterous_edit_box_hidden" data-posterous-edit-box="true" data-posterous-post-id="36932770">
	
	<li><a href="http://posterous.com/posts/edit/36932770">Edit</a></li>
  <li><a href="/posts/destroy/36932770" onclick="if (confirm('Are you sure you want to delete this post?')) { var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var m = document.createElement('input'); m.setAttribute('type', 'hidden'); m.setAttribute('name', '_method'); m.setAttribute('value', 'delete'); f.appendChild(m);var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'GjijbpbQ7s4PAVou+XXaUAqSqpOg1cBKohxQBCKJ7J0='); f.appendChild(s);f.submit(); };return false;">Delete</a></li>
	<li><a href="http://posterous.com/posts/36932770/tags/edit_multiple" data-post-id="36932770" data-posterous-modal="true" data-posterous-tag-form="true">Tags</a></li>
	
	  <li><a href="//posterous.com/autopost/crosspost?post_id=36932770" data-posterous-modal="true">Autopost</a>
	
</ul>

                
                
					</div>
					
				</div>
				<div class="post-content" id="postbox_36932770">
					<div class="copy">
						<p>A <strong>big</strong> thanks to everyone who sent along their best wishes to us!</p>
<p>Carolyn made it out of the hospital much quicker (24 hours) than the last time around. She&rsquo;s also feeling much stronger than she did after Matthew&rsquo;s birth.</p>
<p>Fortunately, since Ben&rsquo;s birthday is so close to Christmas, we&rsquo;ve got a house full of family to help us out as we adjust to having a toddler, a baby, a dog (and four other adults!) under the same roof.</p>
<p><strong>Update:</strong> Here&rsquo;s a photo of Ben that I made this afternoon:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FoIbJbtbJksfhrHxjwoHcHclxHavhjmbapcmybjcBnzGxADwfDrtEvtIqCBAB%2Fmedia_httpstaticflick_DusJf.jpg.scaled1000.jpg%22%2C%22originalWidth%22%3A%22399%22%2C%22largeWidth%22%3A%22399%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FoIbJbtbJksfhrHxjwoHcHclxHavhjmbapcmybjcBnzGxADwfDrtEvtIqCBAB%2Fmedia_httpstaticflick_DusJf.jpg.thumb.jpg%22%2C%22originalHeight%22%3A%22500%22%2C%22largeHeight%22%3A%22500%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22500%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile0.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FoIbJbtbJksfhrHxjwoHcHclxHavhjmbapcmybjcBnzGxADwfDrtEvtIqCBAB%2Fmedia_httpstaticflick_DusJf.jpg.scaled500.jpg%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%22101%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FoIbJbtbJksfhrHxjwoHcHclxHavhjmbapcmybjcBnzGxADwfDrtEvtIqCBAB%2Fmedia_httpstaticflick_DusJf.jpg%22%2C%22width%22%3A%22399%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.flickr.com%2Fphotos%2F23649168%40N00%2Fsets%2F1629635%2F%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22ben-and-us%22%7D'>
<img alt="Media_httpstaticflick_dusjf" height="500" src="http://getfile0.posterous.com/getfile/files.posterous.com/import-fueh/oIbJbtbJksfhrHxjwoHcHclxHavhjmbapcmybjcBnzGxADwfDrtEvtIqCBAB/media_httpstaticflick_DusJf.jpg.scaled500.jpg" width="399" />

</div>
</p>
						
					</div>

						<ul class="social">
							<li class="tweet">
								
              
            
							</li>
							<li class="like">
								<fb:like href="http://iunknown.com/2005/12/ben-and-us.html" layout="button_count"></fb:like> 
							</li>
						</ul>
								
                    
				</div>	
				
			</li>		
		
			<li class="post-item clearfix" id="post_36932759">
				<div class="title-block">
					
						<h3 class="title" id="posttitle_36932759"><a href="http://iunknown.com/2005/12/introducing-benjamin-peter-lam.html">Introducing Benjamin Peter Lam</a></h3>
					
					
						<ul class="meta">
							<li class="date">21 Dec 2005</li>
							<li class="comments"><a href="http://iunknown.com/2005/12/introducing-benjamin-peter-lam.html" id="comment_link_36932759">9 Responses</a></li>
							<li class="views"><div class="posterous_ojs" data-posterous-view-count="true" data-posterous-post-id="36932759"></div>&nbsp;views</li>
                            
                
              
						</ul>
					
					
					<div class="editbox clearfix" id="editunit_36932759">
						
        				
                  <ul class="mini_commands posterous_edit_box posterous_edit_box_hidden" data-posterous-edit-box="true" data-posterous-post-id="36932759">
	
	<li><a href="http://posterous.com/posts/edit/36932759">Edit</a></li>
  <li><a href="/posts/destroy/36932759" onclick="if (confirm('Are you sure you want to delete this post?')) { var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var m = document.createElement('input'); m.setAttribute('type', 'hidden'); m.setAttribute('name', '_method'); m.setAttribute('value', 'delete'); f.appendChild(m);var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'GjijbpbQ7s4PAVou+XXaUAqSqpOg1cBKohxQBCKJ7J0='); f.appendChild(s);f.submit(); };return false;">Delete</a></li>
	<li><a href="http://posterous.com/posts/36932759/tags/edit_multiple" data-post-id="36932759" data-posterous-modal="true" data-posterous-tag-form="true">Tags</a></li>
	
	  <li><a href="//posterous.com/autopost/crosspost?post_id=36932759" data-posterous-modal="true">Autopost</a>
	
</ul>

                
                
					</div>
					
				</div>
				<div class="post-content" id="postbox_36932759">
					<div class="copy">
						<p>Say hello to our new boy Ben! He was born Wednesday December 21, 2005 at 9:02AM.</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FlqxntpCBBItIlAEeDJmwjxaylqEwpCGHfjpdprzrhilnnEbAxjABigonuwiv%2Fmedia_httpstaticflick_lsFlq.jpg.scaled1000.jpg%22%2C%22originalWidth%22%3A%22500%22%2C%22largeWidth%22%3A%22500%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FlqxntpCBBItIlAEeDJmwjxaylqEwpCGHfjpdprzrhilnnEbAxjABigonuwiv%2Fmedia_httpstaticflick_lsFlq.jpg.thumb.jpg%22%2C%22originalHeight%22%3A%22333%22%2C%22largeHeight%22%3A%22333%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22333%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile0.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FlqxntpCBBItIlAEeDJmwjxaylqEwpCGHfjpdprzrhilnnEbAxjABigonuwiv%2Fmedia_httpstaticflick_lsFlq.jpg.scaled500.jpg%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2293%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile2.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FlqxntpCBBItIlAEeDJmwjxaylqEwpCGHfjpdprzrhilnnEbAxjABigonuwiv%2Fmedia_httpstaticflick_lsFlq.jpg%22%2C%22width%22%3A%22500%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fstatic.flickr.com%2F43%2F75988270_5248165125.jpg%3Fv%3D0%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22introducing-benjamin-peter-lam%22%7D'>
<img alt="Media_httpstaticflick_lsflq" height="333" src="http://getfile0.posterous.com/getfile/files.posterous.com/import-fueh/lqxntpCBBItIlAEeDJmwjxaylqEwpCGHfjpdprzrhilnnEbAxjABigonuwiv/media_httpstaticflick_lsFlq.jpg.scaled500.jpg" width="500" />

</div>
</p>
<p>Here are a few more photos from his <a href="http://www.flickr.com/photos/23649168@N00/sets/1629635/">flickr photostream</a>.</p>
						
					</div>

						<ul class="social">
							<li class="tweet">
								
              
            
							</li>
							<li class="like">
								<fb:like href="http://iunknown.com/2005/12/introducing-benjamin-peter-lam.html" layout="button_count"></fb:like> 
							</li>
						</ul>
								
                    
				</div>	
				
			</li>		
		
			<li class="post-item clearfix" id="post_36932758">
				<div class="title-block">
					
						<h3 class="title" id="posttitle_36932758"><a href="http://iunknown.com/2005/12/dreamhost-for-22-usd-first-year.html">Dreamhost for $22 USD first year</a></h3>
					
					
						<ul class="meta">
							<li class="date">19 Dec 2005</li>
							<li class="comments"><a href="http://iunknown.com/2005/12/dreamhost-for-22-usd-first-year.html" id="comment_link_36932758">0 Responses</a></li>
							<li class="views"><div class="posterous_ojs" data-posterous-view-count="true" data-posterous-post-id="36932758"></div>&nbsp;views</li>
                            
                
              
						</ul>
					
					
					<div class="editbox clearfix" id="editunit_36932758">
						
        				
                  <ul class="mini_commands posterous_edit_box posterous_edit_box_hidden" data-posterous-edit-box="true" data-posterous-post-id="36932758">
	
	<li><a href="http://posterous.com/posts/edit/36932758">Edit</a></li>
  <li><a href="/posts/destroy/36932758" onclick="if (confirm('Are you sure you want to delete this post?')) { var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var m = document.createElement('input'); m.setAttribute('type', 'hidden'); m.setAttribute('name', '_method'); m.setAttribute('value', 'delete'); f.appendChild(m);var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'GjijbpbQ7s4PAVou+XXaUAqSqpOg1cBKohxQBCKJ7J0='); f.appendChild(s);f.submit(); };return false;">Delete</a></li>
	<li><a href="http://posterous.com/posts/36932758/tags/edit_multiple" data-post-id="36932758" data-posterous-modal="true" data-posterous-tag-form="true">Tags</a></li>
	
	  <li><a href="//posterous.com/autopost/crosspost?post_id=36932758" data-posterous-modal="true">Autopost</a>
	
</ul>

                
                
					</div>
					
				</div>
				<div class="post-content" id="postbox_36932758">
					<div class="copy">
						<p>I have a confession to make: I&rsquo;m addicted to <a href="http://www.redflagdeals.com">Red Flag Deals</a>. Thanks to their forums, I&rsquo;ve gotten more than my fair share of good deals. One deal that I thought I&rsquo;d pass along here is <a href="http://www.dreamhost.com">Dreamhost</a> hosting package for only $22 <span class="caps">USD</span> for the first year on a new registration.</p>
<p>This is an <em>insanely</em> good deal. With that you get a free year&rsquo;s registration on a domain name of your choice, 4.8GB disk space, and 120GB / month transfer. You can create shell accounts, host an unlimited number of MySQL databases, and of course run <a href="http://www.rubyonrails.com">Rails</a> web sites as well.</p>
<p>Here&rsquo;s a link to the <a href="http://www.redflagdeals.com/forums/showthread.php?t=230288">original deal page</a> on  RedFlagDeals so that the props can go out to the appropriate folks.</p>
						
					</div>

						<ul class="social">
							<li class="tweet">
								
              
            
							</li>
							<li class="like">
								<fb:like href="http://iunknown.com/2005/12/dreamhost-for-22-usd-first-year.html" layout="button_count"></fb:like> 
							</li>
						</ul>
								
                    
				</div>	
				
			</li>		
		
			<li class="post-item clearfix" id="post_36932756">
				<div class="title-block">
					
						<h3 class="title" id="posttitle_36932756"><a href="http://iunknown.com/2005/12/clr-object-lifetime.html">CLR object lifetime</a></h3>
					
					
						<ul class="meta">
							<li class="date">17 Dec 2005</li>
							<li class="comments"><a href="http://iunknown.com/2005/12/clr-object-lifetime.html" id="comment_link_36932756">0 Responses</a></li>
							<li class="views"><div class="posterous_ojs" data-posterous-view-count="true" data-posterous-post-id="36932756"></div>&nbsp;views</li>
                            
                
              
						</ul>
					
					
					<div class="editbox clearfix" id="editunit_36932756">
						
        				
                  <ul class="mini_commands posterous_edit_box posterous_edit_box_hidden" data-posterous-edit-box="true" data-posterous-post-id="36932756">
	
	<li><a href="http://posterous.com/posts/edit/36932756">Edit</a></li>
  <li><a href="/posts/destroy/36932756" onclick="if (confirm('Are you sure you want to delete this post?')) { var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var m = document.createElement('input'); m.setAttribute('type', 'hidden'); m.setAttribute('name', '_method'); m.setAttribute('value', 'delete'); f.appendChild(m);var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'GjijbpbQ7s4PAVou+XXaUAqSqpOg1cBKohxQBCKJ7J0='); f.appendChild(s);f.submit(); };return false;">Delete</a></li>
	<li><a href="http://posterous.com/posts/36932756/tags/edit_multiple" data-post-id="36932756" data-posterous-modal="true" data-posterous-tag-form="true">Tags</a></li>
	
	  <li><a href="//posterous.com/autopost/crosspost?post_id=36932756" data-posterous-modal="true">Autopost</a>
	
</ul>

                
                
					</div>
					
				</div>
				<div class="post-content" id="postbox_36932756">
					<div class="copy">
						<p>My Ruby <span class="caps">CLR</span> bridge works by creating, on the fly, small <span class="caps">CIL</span> shims that invoke the appropriate method(s) on a <span class="caps">CLR</span> object. Today I want to talk about how I manage the lifetimes of those <span class="caps">CIL</span> shims.</p>
<p>When you execute some code like <code>a = ArrayList.new</code> for the first time, I construct a new <code>ArrayList</code> Ruby class object on the fly. When you execute a method on a class instance such as <code>a.Sort</code>, I construct a <span class="caps">CIL</span> shim that knows how to invoke the <code>Sort</code> method on the <code>ArrayList</code> object. That <span class="caps">CIL</span> shim is bound to the Ruby class object via a call to <code>rb_define_method</code>.</p>
<p>The <span class="caps">CIL</span> shim is created using the <code>DynamicMethod</code> API in <span class="caps">CLR 2</span>.0. After I finish defining the body of the dynamic method using my <code>RbDynamicMethod</code> API, I construct a delegate object that represents that method. These delegate objects are eligible for garbage collection, which means that I need to keep a reference to them. Now, when I said that the <span class="caps">CIL</span> shim is bound to the Ruby class object, Ruby only knows about the function pointer to the delegate object that represents the <span class="caps">CIL</span> shim. That function pointer is only a <em>weak reference</em> to the delegate, which means that it cannot keep the delegate object from being collected by the <span class="caps">CLR GC</span>.</p>
<p>To work around this problem, I&rsquo;ve added a <code>List&lt;Delegate&gt;</code> object to the Ruby class object. Its job is to hold onto references to all of the dynamically created <span class="caps">CIL</span> shim delegate objects <em>for that class</em>. When the Ruby class object is garbage collected by <em>Ruby&rsquo;s GC</em>, my automagical object reference cleanup code will <code>Free</code> the <code>GCHandle</code> object that I use to keep a reference to the <code>List&lt;Delegate&gt;</code> object.</p>
<p>I actually had a far more complicated and convoluted mechanism for dealing with this problem in my initial implementation of the bridge. I&rsquo;m much happier with the simplicity of this approach in V2.</p>
						
					</div>

						<ul class="social">
							<li class="tweet">
								
              
            
							</li>
							<li class="like">
								<fb:like href="http://iunknown.com/2005/12/clr-object-lifetime.html" layout="button_count"></fb:like> 
							</li>
						</ul>
								
                    
				</div>	
				
			</li>		
		
			<li class="post-item clearfix" id="post_36932752">
				<div class="title-block">
					
						<h3 class="title" id="posttitle_36932752"><a href="http://iunknown.com/2005/12/mindbinders.html">MindBinders</a></h3>
					
					
						<ul class="meta">
							<li class="date">17 Dec 2005</li>
							<li class="comments"><a href="http://iunknown.com/2005/12/mindbinders.html" id="comment_link_36932752">2 Responses</a></li>
							<li class="views"><div class="posterous_ojs" data-posterous-view-count="true" data-posterous-post-id="36932752"></div>&nbsp;views</li>
                            
                
              
						</ul>
					
					
					<div class="editbox clearfix" id="editunit_36932752">
						
        				
                  <ul class="mini_commands posterous_edit_box posterous_edit_box_hidden" data-posterous-edit-box="true" data-posterous-post-id="36932752">
	
	<li><a href="http://posterous.com/posts/edit/36932752">Edit</a></li>
  <li><a href="/posts/destroy/36932752" onclick="if (confirm('Are you sure you want to delete this post?')) { var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var m = document.createElement('input'); m.setAttribute('type', 'hidden'); m.setAttribute('name', '_method'); m.setAttribute('value', 'delete'); f.appendChild(m);var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'GjijbpbQ7s4PAVou+XXaUAqSqpOg1cBKohxQBCKJ7J0='); f.appendChild(s);f.submit(); };return false;">Delete</a></li>
	<li><a href="http://posterous.com/posts/36932752/tags/edit_multiple" data-post-id="36932752" data-posterous-modal="true" data-posterous-tag-form="true">Tags</a></li>
	
	  <li><a href="//posterous.com/autopost/crosspost?post_id=36932752" data-posterous-modal="true">Autopost</a>
	
</ul>

                
                
					</div>
					
				</div>
				<div class="post-content" id="postbox_36932752">
					<div class="copy">
						<p>I was looking for a source of Moleskine notebooks in Toronto (Indigo is one place to get them, but they were sold out), and I stumbled across this photo via Technorati:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile1.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FqaqjwessxFuxCIEqpqrkJJIJqfBqpBkqCiqqfsseiornDjCkkICkAGIbkaIA%2Fmedia_httpstaticflick_tacJx.jpg.scaled1000.jpg%22%2C%22originalWidth%22%3A%22500%22%2C%22largeWidth%22%3A%22500%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FqaqjwessxFuxCIEqpqrkJJIJqfBqpBkqCiqqfsseiornDjCkkICkAGIbkaIA%2Fmedia_httpstaticflick_tacJx.jpg.thumb.jpg%22%2C%22originalHeight%22%3A%22375%22%2C%22largeHeight%22%3A%22375%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22375%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FqaqjwessxFuxCIEqpqrkJJIJqfBqpBkqCiqqfsseiornDjCkkICkAGIbkaIA%2Fmedia_httpstaticflick_tacJx.jpg.scaled500.jpg%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%22134%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile1.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FqaqjwessxFuxCIEqpqrkJJIJqfBqpBkqCiqqfsseiornDjCkkICkAGIbkaIA%2Fmedia_httpstaticflick_tacJx.jpg%22%2C%22width%22%3A%22500%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3Anull%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22mindbinders%22%7D'>
<img alt="Media_httpstaticflick_tacjx" height="375" src="http://getfile3.posterous.com/getfile/files.posterous.com/import-fueh/qaqjwessxFuxCIEqpqrkJJIJqfBqpBkqCiqqfsseiornDjCkkICkAGIbkaIA/media_httpstaticflick_tacJx.jpg.scaled500.jpg" width="500" />

</div>
</p>
<p>When I was in grad school, I spent a lot of time creating index cards; I had several thousand by the time I was done. <a href="http://www.mindbinders.com/products/products.html">These</a> look like a really nice way to replicate some of that goodness in a nice, compact form factor.</p>
<p>I love the depth of field on his Sony Cybershot camera (shot at F/2).</p>
						
					</div>

						<ul class="social">
							<li class="tweet">
								
              
            
							</li>
							<li class="like">
								<fb:like href="http://iunknown.com/2005/12/mindbinders.html" layout="button_count"></fb:like> 
							</li>
						</ul>
								
                    
				</div>	
				
			</li>		
		
			<li class="post-item clearfix" id="post_36932750">
				<div class="title-block">
					
						<h3 class="title" id="posttitle_36932750"><a href="http://iunknown.com/2005/12/how-meta-can-you-go.html">How meta can you go?</a></h3>
					
					
						<ul class="meta">
							<li class="date">16 Dec 2005</li>
							<li class="comments"><a href="http://iunknown.com/2005/12/how-meta-can-you-go.html" id="comment_link_36932750">0 Responses</a></li>
							<li class="views"><div class="posterous_ojs" data-posterous-view-count="true" data-posterous-post-id="36932750"></div>&nbsp;views</li>
                            
                
              
						</ul>
					
					
					<div class="editbox clearfix" id="editunit_36932750">
						
        				
                  <ul class="mini_commands posterous_edit_box posterous_edit_box_hidden" data-posterous-edit-box="true" data-posterous-post-id="36932750">
	
	<li><a href="http://posterous.com/posts/edit/36932750">Edit</a></li>
  <li><a href="/posts/destroy/36932750" onclick="if (confirm('Are you sure you want to delete this post?')) { var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var m = document.createElement('input'); m.setAttribute('type', 'hidden'); m.setAttribute('name', '_method'); m.setAttribute('value', 'delete'); f.appendChild(m);var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'GjijbpbQ7s4PAVou+XXaUAqSqpOg1cBKohxQBCKJ7J0='); f.appendChild(s);f.submit(); };return false;">Delete</a></li>
	<li><a href="http://posterous.com/posts/36932750/tags/edit_multiple" data-post-id="36932750" data-posterous-modal="true" data-posterous-tag-form="true">Tags</a></li>
	
	  <li><a href="//posterous.com/autopost/crosspost?post_id=36932750" data-posterous-modal="true">Autopost</a>
	
</ul>

                
                
					</div>
					
				</div>
				<div class="post-content" id="postbox_36932750">
					<div class="copy">
						<p>I just figured out what Ruby was doing, because I forgot just how &ldquo;meta&rdquo; my programming was. Consider this code frag:</p>
<div class="CodeRay">
  <div class="code"><pre>def const_missing(symbol)
alias_const_missing(symbol) unless symbol == :ArrayList
obj = create_clr_class_object
# remember that the code below is in a string
obj.class_eval %{
def initialize(*params)
create_safe_ruby_instance_method(
self.class, 'initialize') do
include     'System.Collections'
declare     &quot;#{symbol}&quot;, :obj
...</pre></div>
</div>

<p>Look at the last line of code and the <code>declare</code> statement. Notice how I&rsquo;m referencing the <code>symbol</code> variable that is the input parameter to the <code>const_missing</code> method declaration on the first line? I have to escape that reference as a string to access that variable. Why? Because that code is embedded in a string (that&rsquo;s what the funny <code>%{</code> means: it&rsquo;s a begin string quotation symbol).</p>
<p>Now this has interesting implications for other string manipulation functions that are inside of the <em>string</em> that is passed to <code>obj.class_eval</code>. For example consider this snippet of code.</p>
<div class="CodeRay">
  <div class="code"><pre>sigs          = get_constructor_signatures(&quot;#{symbol}&quot;)
switch_labels = (1..sigs.length).collect { |i| (&quot;l&quot; + i.to_s).to_sym }</pre></div>
</div>

<p>I <em>really</em> wanted to write the string expression as:</p>
<p><code>"l#{i}".to_sym</code></p>
<p>But this cannot work since it would try and find an <code>i</code> variable defined in the enclosing method. So I wound up writing it in the somewhat more verbose way that I did to make it work. I wound up scratching my head about this behavior for quite a while before I realized that, doh! the code was executing <em>inside of a string</em>.</p>
<p>That&rsquo;s how powerful Ruby&rsquo;s metaprogramming facilities are: oftentimes you forget that you&rsquo;re really programming at a meta level of abstraction instead of at the &ldquo;concrete&rdquo; level.</p>
						
					</div>

						<ul class="social">
							<li class="tweet">
								
              
            
							</li>
							<li class="like">
								<fb:like href="http://iunknown.com/2005/12/how-meta-can-you-go.html" layout="button_count"></fb:like> 
							</li>
						</ul>
								
                    
				</div>	
				
			</li>		
		
			<li class="post-item clearfix" id="post_36932746">
				<div class="title-block">
					
						<h3 class="title" id="posttitle_36932746"><a href="http://iunknown.com/2005/12/refactoring-cil.html">Refactoring CIL</a></h3>
					
					
						<ul class="meta">
							<li class="date">16 Dec 2005</li>
							<li class="comments"><a href="http://iunknown.com/2005/12/refactoring-cil.html" id="comment_link_36932746">2 Responses</a></li>
							<li class="views"><div class="posterous_ojs" data-posterous-view-count="true" data-posterous-post-id="36932746"></div>&nbsp;views</li>
                            
                
              
						</ul>
					
					
					<div class="editbox clearfix" id="editunit_36932746">
						
        				
                  <ul class="mini_commands posterous_edit_box posterous_edit_box_hidden" data-posterous-edit-box="true" data-posterous-post-id="36932746">
	
	<li><a href="http://posterous.com/posts/edit/36932746">Edit</a></li>
  <li><a href="/posts/destroy/36932746" onclick="if (confirm('Are you sure you want to delete this post?')) { var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var m = document.createElement('input'); m.setAttribute('type', 'hidden'); m.setAttribute('name', '_method'); m.setAttribute('value', 'delete'); f.appendChild(m);var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'GjijbpbQ7s4PAVou+XXaUAqSqpOg1cBKohxQBCKJ7J0='); f.appendChild(s);f.submit(); };return false;">Delete</a></li>
	<li><a href="http://posterous.com/posts/36932746/tags/edit_multiple" data-post-id="36932746" data-posterous-modal="true" data-posterous-tag-form="true">Tags</a></li>
	
	  <li><a href="//posterous.com/autopost/crosspost?post_id=36932746" data-posterous-modal="true">Autopost</a>
	
</ul>

                
                
					</div>
					
				</div>
				<div class="post-content" id="postbox_36932746">
					<div class="copy">
						<p>I had a great day today. I had one of those a-ha experiences where you get to benefit from an earlier decision in ways that you did not expect. I started down the path of generating constructor shims using <code>RbDynamicMethod</code>. I completed my first spike yesterday, when I successfully constructed <code>ArrayList</code> objects using <code>RbDynamicMethod</code>.</p>
<p>Today, I wanted to make a slightly more generic constructor shim that would let me call both a default and a single argument constructor: <code>ArrayList()</code> and <code>ArrayList(Int32)</code>. While I was writing this code, I began to feel some <span class="caps">CIL</span> pain (it is, after all <strong>assembly language</strong>). So I did what came naturally: I began to refactor the code.</p>
<p>This reminds me of the talk that I saw this year at <span class="caps">OOPSLA</span> where Ward Cunningham was refactoring assembly language using IntelliJ. In my case, I refactored <span class="caps">CIL</span> using emacs :) Here&rsquo;s the end result:</p>
<div class="CodeRay">
  <div class="code"><pre>def initialize(*params)
create_ruby_instance_method(self.class, 'initialize') do
include     'System.Collections'
declare     &quot;#{symbol}&quot;, :obj
ldarg_0
switch      [:zero_param, :one_param]
br_s        :end_switch
label       :zero_param
newobj      '#{symbol}()'
stloc_s     :obj
br_s        :end_switch
label       :one_param
ld_rb_param 0, 'Int32'
newobj      '#{symbol}(Int32)'
stloc_s     :obj
label       :end_switch
ret_objref  :obj
end
initialize(*params)
end</pre></div>
</div>

<p>While this is mostly <span class="caps">CIL</span>, it also contains a number of macros and fun Ruby string stuff. The macros that I used are: <code>ld_rb_param</code>, <code>ret_objref</code>. As it turns out, these will be very common code fragments that will be used throughout the bridge. Writing those macros was even easier. Here&rsquo;s a sample:</p>
<div class="CodeRay">
  <div class="code"><pre>module RbDynamicMethodHelpers
def ld_self
ldarg_2
end
def ld_rb_param(index, type)
ldarg_1
case index
when 1:
ldc_i4_4
add
when 2:
ldc_i4_8
add
else
ldc_i4    index &lt;&lt; 2
add
end
ldind_i4
call      &quot;static Marshal::To#{type}(VALUE)&quot;
end
def ret_objref(local_variable_name)
ld_self
ldloc_s  local_variable_name
call     'static Marshal::AssignToClassInstance(VALUE, Object)'
ret
end
end</pre></div>
</div>

<p>It turned out it was a good thing that I left the method declarations as strings, since I could do some simple string manipulation to inject implement syntactic sugar methods such as <code>ld_rb_param</code> (which is actually a very efficient <span class="caps">CIL</span> implementation that is optimized for the common cases).</p>
<p>Oh yeah, how much extra code did I have to add to <code>RbDynamicMethod</code> to enable macros? I changed:</p>
<p><code>object.extend RbDynamicMethod</code></p>
<p>to:</p>
<p><code>object.extend RbDynamicMethod, RbDynamicMethodHelpers</code></p>
<p>Did I mention how much I love Ruby? :)</p>
						
					</div>

						<ul class="social">
							<li class="tweet">
								
              
            
							</li>
							<li class="like">
								<fb:like href="http://iunknown.com/2005/12/refactoring-cil.html" layout="button_count"></fb:like> 
							</li>
						</ul>
								
                    
				</div>	
				
			</li>		
		
			<li class="post-item clearfix" id="post_36932740">
				<div class="title-block">
					
						<h3 class="title" id="posttitle_36932740"><a href="http://iunknown.com/2005/12/hello-rubyclr.html">Hello RubyClr</a></h3>
					
					
						<ul class="meta">
							<li class="date">15 Dec 2005</li>
							<li class="comments"><a href="http://iunknown.com/2005/12/hello-rubyclr.html" id="comment_link_36932740">1 Response</a></li>
							<li class="views"><div class="posterous_ojs" data-posterous-view-count="true" data-posterous-post-id="36932740"></div>&nbsp;views</li>
                            
                
              
						</ul>
					
					
					<div class="editbox clearfix" id="editunit_36932740">
						
        				
                  <ul class="mini_commands posterous_edit_box posterous_edit_box_hidden" data-posterous-edit-box="true" data-posterous-post-id="36932740">
	
	<li><a href="http://posterous.com/posts/edit/36932740">Edit</a></li>
  <li><a href="/posts/destroy/36932740" onclick="if (confirm('Are you sure you want to delete this post?')) { var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var m = document.createElement('input'); m.setAttribute('type', 'hidden'); m.setAttribute('name', '_method'); m.setAttribute('value', 'delete'); f.appendChild(m);var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'GjijbpbQ7s4PAVou+XXaUAqSqpOg1cBKohxQBCKJ7J0='); f.appendChild(s);f.submit(); };return false;">Delete</a></li>
	<li><a href="http://posterous.com/posts/36932740/tags/edit_multiple" data-post-id="36932740" data-posterous-modal="true" data-posterous-tag-form="true">Tags</a></li>
	
	  <li><a href="//posterous.com/autopost/crosspost?post_id=36932740" data-posterous-modal="true">Autopost</a>
	
</ul>

                
                
					</div>
					
				</div>
				<div class="post-content" id="postbox_36932740">
					<div class="copy">
						<p>I spent most of yesterday and today hacking out the first spike of the Ruby rewrite of my original Ruby to <span class="caps">CLR</span> bridge. I wound up adding some additional code to <code>RbDynamicMethod</code> to support some scenarios that I didn&rsquo;t envision (nothing like having a &lsquo;customer&rsquo; to reveal deficiencies in an <span class="caps">API</span>!). I also spent a <strong>lot</strong> of time learning about how objects are constructed in Ruby. Here&rsquo;s a very simplified explanation of Ruby&rsquo;s object model; for a complete description, see Chapter 24 of Dave Thomas&rsquo; excellent <a href="http://www.amazon.com/exec/obidos/ASIN/0974514055/ref=nosim/iunknowncom-20">Programming Ruby</a>.</p>
<p><br />
<div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FhjkGExozlfivslofnrmibFIAupednsFGcIimHJDyvBHpoCHEuGtfvDmpyhGo%2Fmedia_httpimagesamazo_axpHs.jpg%22%2C%22originalWidth%22%3A%22240%22%2C%22largeWidth%22%3A%22240%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile0.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FhjkGExozlfivslofnrmibFIAupednsFGcIimHJDyvBHpoCHEuGtfvDmpyhGo%2Fmedia_httpimagesamazo_axpHs.jpg.thumb.jpg%22%2C%22originalHeight%22%3A%22240%22%2C%22largeHeight%22%3A%22240%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22240%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FhjkGExozlfivslofnrmibFIAupednsFGcIimHJDyvBHpoCHEuGtfvDmpyhGo%2Fmedia_httpimagesamazo_axpHs.jpg.scaled500.jpg%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%228%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-fueh%2FhjkGExozlfivslofnrmibFIAupednsFGcIimHJDyvBHpoCHEuGtfvDmpyhGo%2Fmedia_httpimagesamazo_axpHs.jpg%22%2C%22width%22%3A%22240%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.amazon.com%2Fexec%2Fobidos%2FASIN%2F0974514055%2Fref%3Dnosim%2Fiunknowncom-20%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22hello-rubyclr%22%7D'>
<img alt="Media_httpimagesamazo_axphs" height="240" src="http://getfile7.posterous.com/getfile/files.posterous.com/import-fueh/hjkGExozlfivslofnrmibFIAupednsFGcIimHJDyvBHpoCHEuGtfvDmpyhGo/media_httpimagesamazo_axpHs.jpg.scaled500.jpg" width="240" />

</div>

<br /></p>
<p>In Ruby, objects are instances of classes. However, classes are also objects in Ruby, which means that a class is an instance of a class called <code>Class</code>. Let&rsquo;s consider the following code fragment:</p>
<div class="CodeRay">
  <div class="code"><pre>a = ArrayList.new
puts a.Count</pre></div>
</div>

<p>In the first line, we&rsquo;ve created an instance of class <code>ArrayList</code> and assigned it to the variable <code>a</code>. Next, we invoke the <code>Count</code> instance method of the <code>ArrayList</code> object. So far so good, right?</p>
<p>Next let&rsquo;s see how Ruby invokes instance methods. Every Ruby object contains a reference to its class object. This is stored in an internal field called <code>klass</code>. When we invoke the <code>Count</code> method on the <code>ArrayList</code> object, Ruby follows the <code>klass</code> reference to find the <code>ArrayList</code> class object. It searches its method table, finds the <code>Count</code> method and invokes it.</p>
<p>In my bridge, I delay binding to a method on a <span class="caps">CLR</span> object until it is called. When it is called, I build a small piece of <span class="caps">CIL</span> code using <code>RbDynamicMethod</code> to call the method and marshal data back to the caller. I can delay binding to the method using the <code>method_missing</code> instance method of the object. In the case of the call to the <code>Count</code> method, you could imagine a piece of code that looks like:</p>
<div class="CodeRay">
  <div class="code"><pre>alias alias_method_missing method_missing
def method_missing(name, *params)
alias_method_missing(name, *params) unless name == :Count
create_ruby_instance_method(self.class, 'Count') do
include  'System.Collections'
ldarg_2
call     'static Marshal::ToClrObject(VALUE)'
call     'ArrayList::get_Count()'
call     'static Marshal::ToRubyNumber(Int32)'
ret
end
self.Count
end</pre></div>
</div>

<p>This is a hard-coded example that generates a shim for the <code>Count</code> method. The shim invokes the <code>get_Count</code> method to retrieve the value of the <code>Count</code> property of the <code>ArrayList</code> object. It marshals the return value (an <code>Int32</code>) back to the caller using the <code>Marshal::ToRubyNumber()</code> helper method in the <code>RbDynamicMethod</code> library.</p>
<p>Where things get interesting is the first two lines of <span class="caps">CIL</span> code in the shim. Here, I reach into the Ruby object and pull out the actual <code>ArrayList</code> object reference that is stored in a <em>secret</em> field of the Ruby object. This secret field is completely inaccessible to Ruby code. Once I have the object reference, I can freely invoke the <code>get_Count</code> instance method using the <span class="caps">CIL</span> <code>call</code> instruction.</p>
<p>Notice that I&rsquo;m defining an instance method called <code>Count</code> on the <code>ArrayList</code> class object. At the end of the <code>method_missing</code> method, I invoke the <code>Count</code> method that I just defined. However, all <em>subsequent</em> calls to the <code>Count</code> instance method will go directly to the <span class="caps">CIL</span> code that I just wrote (which of course will have been compiled into x86 code as well). This means that we will have excellent performance since we completely avoid having to use the <code>Reflection</code> APIs in the <span class="caps">CLR</span>.</p>
<p>You&rsquo;re probably wondering how the <code>ArrayList</code> object reference got stored in the secret field? I&rsquo;ll talk about that in tomorrow&rsquo;s installment of the story when we look at how objects get created in Ruby (and it&rsquo;s nowhere near as simple as it looks!).</p>
						
					</div>

						<ul class="social">
							<li class="tweet">
								
              
            
							</li>
							<li class="like">
								<fb:like href="http://iunknown.com/2005/12/hello-rubyclr.html" layout="button_count"></fb:like> 
							</li>
						</ul>
								
                    
				</div>	
				
			</li>		
		
			<li class="post-item clearfix" id="post_36932735">
				<div class="title-block">
					
						<h3 class="title" id="posttitle_36932735"><a href="http://iunknown.com/2005/12/democamp.html">DemoCamp</a></h3>
					
					
						<ul class="meta">
							<li class="date">13 Dec 2005</li>
							<li class="comments"><a href="http://iunknown.com/2005/12/democamp.html" id="comment_link_36932735">1 Response</a></li>
							<li class="views"><div class="posterous_ojs" data-posterous-view-count="true" data-posterous-post-id="36932735"></div>&nbsp;views</li>
                            
                
              
						</ul>
					
					
					<div class="editbox clearfix" id="editunit_36932735">
						
        				
                  <ul class="mini_commands posterous_edit_box posterous_edit_box_hidden" data-posterous-edit-box="true" data-posterous-post-id="36932735">
	
	<li><a href="http://posterous.com/posts/edit/36932735">Edit</a></li>
  <li><a href="/posts/destroy/36932735" onclick="if (confirm('Are you sure you want to delete this post?')) { var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var m = document.createElement('input'); m.setAttribute('type', 'hidden'); m.setAttribute('name', '_method'); m.setAttribute('value', 'delete'); f.appendChild(m);var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'GjijbpbQ7s4PAVou+XXaUAqSqpOg1cBKohxQBCKJ7J0='); f.appendChild(s);f.submit(); };return false;">Delete</a></li>
	<li><a href="http://posterous.com/posts/36932735/tags/edit_multiple" data-post-id="36932735" data-posterous-modal="true" data-posterous-tag-form="true">Tags</a></li>
	
	  <li><a href="//posterous.com/autopost/crosspost?post_id=36932735" data-posterous-modal="true">Autopost</a>
	
</ul>

                
                
					</div>
					
				</div>
				<div class="post-content" id="postbox_36932735">
					<div class="copy">
						<p>I went to <a href="http://barcamp.org/index.cgi?SignUpHere">DemoCamp</a> tonight and I saw a bunch of cool demos put on by folks working on startups here in Toronto.</p>
<ul>
<li>The <a href="http://www.bubbleshare.com">BubbleShare</a> folks had a really cool demo of an upcoming feature of their photo sharing service. They&rsquo;ve implemented the core interface of iPhoto using <span class="caps">AJAX</span> (you know the one: dragging a slider that dynamically resizes the thumbnails). You have to see it to believe it. Apparently this feature goes live on their site next week sometime.</li>
<li>If you&rsquo;re into ego surfing, you should definitely check out <a href="http://ehlist.ca/">Eh List</a>. Chris Nolan&rsquo;s done a really good job of aggregating a bunch of services to show you just where you rank (or don&rsquo;t) in the blogosphere.</li>
<li>I&rsquo;m continually amazed by how Randy Charles Morin is able to generate revenue from his various ventures. Tonight he demonstrated <a href="http://www.r-mail.org/">RMail</a> which is a service that emails you <span class="caps">RSS</span> feeds. Randy monetizes this by including links within the blog entries that point back to his custom search engine.</li>
<li>Sutha Kamal of <a href="http://www.ambientvector.com">Ambient Vector</a> demonstrated his social collaborative search engine that improves the quality of mobile search based on its analysis of your preferences and <em>your peer group&rsquo;s preferences</em>. This is a really powerful idea that greatly improves the quality of recommendations, since you can think of search results as recommendations. This ties back into the idea that providing search context is a good thing.</li>
</ul>
<p>It was also cool to hang out with <a href="http://www.braithwaite-lee.com/weblog/">Reg Braithwaite</a> again. Tonight I got a great idea about building a Firefox extension based on his ideas about context-based recommendations. I <em>so</em> want to do something cool in this space.</p>
						
					</div>

						<ul class="social">
							<li class="tweet">
								
              
            
							</li>
							<li class="like">
								<fb:like href="http://iunknown.com/2005/12/democamp.html" layout="button_count"></fb:like> 
							</li>
						</ul>
								
                    
				</div>	
				
			</li>		
		
			<li class="post-item clearfix" id="post_36932732">
				<div class="title-block">
					
						<h3 class="title" id="posttitle_36932732"><a href="http://iunknown.com/2005/12/third-drop-of-rbdynamicmethod.html">Third drop of RbDynamicMethod</a></h3>
					
					
						<ul class="meta">
							<li class="date">13 Dec 2005</li>
							<li class="comments"><a href="http://iunknown.com/2005/12/third-drop-of-rbdynamicmethod.html" id="comment_link_36932732">2 Responses</a></li>
							<li class="views"><div class="posterous_ojs" data-posterous-view-count="true" data-posterous-post-id="36932732"></div>&nbsp;views</li>
                            
                
              
						</ul>
					
					
					<div class="editbox clearfix" id="editunit_36932732">
						
        				
                  <ul class="mini_commands posterous_edit_box posterous_edit_box_hidden" data-posterous-edit-box="true" data-posterous-post-id="36932732">
	
	<li><a href="http://posterous.com/posts/edit/36932732">Edit</a></li>
  <li><a href="/posts/destroy/36932732" onclick="if (confirm('Are you sure you want to delete this post?')) { var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var m = document.createElement('input'); m.setAttribute('type', 'hidden'); m.setAttribute('name', '_method'); m.setAttribute('value', 'delete'); f.appendChild(m);var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'GjijbpbQ7s4PAVou+XXaUAqSqpOg1cBKohxQBCKJ7J0='); f.appendChild(s);f.submit(); };return false;">Delete</a></li>
	<li><a href="http://posterous.com/posts/36932732/tags/edit_multiple" data-post-id="36932732" data-posterous-modal="true" data-posterous-tag-form="true">Tags</a></li>
	
	  <li><a href="//posterous.com/autopost/crosspost?post_id=36932732" data-posterous-modal="true">Autopost</a>
	
</ul>

                
                
					</div>
					
				</div>
				<div class="post-content" id="postbox_36932732">
					<div class="copy">
						<p>Here&rsquo;s <a href="/images/RbDynamicMethod.zip">another drop</a> of <code>RbDynamicMethod</code>. New to this release is a custom implementation of <code>Type.GetMethod</code> that correctly finds overloaded generic methods. The .NET implementation of this method does not support resolving generic methods, so I wound up rolling my own. If you&rsquo;re interested in its implementation you should check out <code>FindGenericMethodTemplate</code> in the sources.</p>
<p>This is what using <code>RbDynamicMethod</code> to call a generic method looks like:</p>
<div class="CodeRay">
  <div class="code"><pre>create_ruby_module_function(RbDynamicMethod, 'call_generic_min_method') do
include   'RbDynamicMethodTests'
ldc_i4_3
ldc_i4_2
call      'static GenericMethodTests::Min&lt;Int32&gt;(Int32, Int32)'
call      'static Marshal::ToRubyNumber(Int32)'
ret
end
assert_equal 2, call_generic_min_method</pre></div>
</div>

<p>This should be the last drop of this library for the next little while since I think it&rsquo;s good enough to begin building my new Ruby to <span class="caps">CLR</span> bridge on top of it.</p>
						
					</div>

						<ul class="social">
							<li class="tweet">
								
              
            
							</li>
							<li class="like">
								<fb:like href="http://iunknown.com/2005/12/third-drop-of-rbdynamicmethod.html" layout="button_count"></fb:like> 
							</li>
						</ul>
								
                    
				</div>	
				
			</li>		
		
		<li class="pagination">
			<div class="pagination"><span class="disabled prev_page">&laquo; Previous</span> <span class="current">1</span> <a href="http://iunknown.com/archive/12/2005?page=2" rel="next">2</a> <a href="http://iunknown.com/archive/12/2005?page=3">3</a> <a href="http://iunknown.com/archive/12/2005?page=2" class="next_page" rel="next">Next &raquo;</a></div> 
		</li>		
	</ul>
</div>

<div id="footer-container">
	<div id="footer">
	
		<ul class="three-column clearfix">
    		<li class="column clearfix">
				
                    <h4>About</h4>
                    <p>I create software tools for scientists and engineers in the Technical Computing Group at Microsoft. Before that, I was a founding member of the IronRuby team.</p>
                    <div class="siteviews">119877 Views</div>
				
                
			</li>
			<li class="column">
            
                
                
                    <h4>Archive</h4>
                    <ul class="archive">
                        
                
                            <li>
                                <a href="#" id="archive_year2011">2011</a> <span>(4)</span>
                                <ul id="archive_months2011" style="display:none;">
                                
                                  
                                              
                                      <li class="inner"><a href="/archive/2/2011">February </a> <span>(1)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/1/2011">January </a> <span>(3)</span></li>
                                  
              
                                
                                </ul>
                            </li>
                        
                <div class="posterous_ojs" data-posterous-show-on-click="true" data-posterous-id-to-show-on-click="archive_months2011" data-posterous-action-trigger-id="archive_year2011" data-posterous-hide-on-click-id="none"></div>                
              
                
                            <li>
                                <a href="#" id="archive_year2010">2010</a> <span>(13)</span>
                                <ul id="archive_months2010" style="display:none;">
                                
                                  
                                              
                                      <li class="inner"><a href="/archive/12/2010">December </a> <span>(12)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/11/2010">November </a> <span>(1)</span></li>
                                  
              
                                
                                </ul>
                            </li>
                        
                <div class="posterous_ojs" data-posterous-show-on-click="true" data-posterous-id-to-show-on-click="archive_months2010" data-posterous-action-trigger-id="archive_year2010" data-posterous-hide-on-click-id="none"></div>                
              
                
                            <li>
                                <a href="#" id="archive_year2009">2009</a> <span>(5)</span>
                                <ul id="archive_months2009" style="display:none;">
                                
                                  
                                              
                                      <li class="inner"><a href="/archive/12/2009">December </a> <span>(1)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/11/2009">November </a> <span>(1)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/5/2009">May </a> <span>(1)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/1/2009">January </a> <span>(2)</span></li>
                                  
              
                                
                                </ul>
                            </li>
                        
                <div class="posterous_ojs" data-posterous-show-on-click="true" data-posterous-id-to-show-on-click="archive_months2009" data-posterous-action-trigger-id="archive_year2009" data-posterous-hide-on-click-id="none"></div>                
              
                
                            <li>
                                <a href="#" id="archive_year2008">2008</a> <span>(30)</span>
                                <ul id="archive_months2008" style="display:none;">
                                
                                  
                                              
                                      <li class="inner"><a href="/archive/10/2008">October </a> <span>(1)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/9/2008">September </a> <span>(2)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/7/2008">July </a> <span>(1)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/6/2008">June </a> <span>(2)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/5/2008">May </a> <span>(1)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/4/2008">April </a> <span>(2)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/3/2008">March </a> <span>(9)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/2/2008">February </a> <span>(8)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/1/2008">January </a> <span>(4)</span></li>
                                  
              
                                
                                </ul>
                            </li>
                        
                <div class="posterous_ojs" data-posterous-show-on-click="true" data-posterous-id-to-show-on-click="archive_months2008" data-posterous-action-trigger-id="archive_year2008" data-posterous-hide-on-click-id="none"></div>                
              
                
                            <li>
                                <a href="#" id="archive_year2007">2007</a> <span>(59)</span>
                                <ul id="archive_months2007" style="display:none;">
                                
                                  
                                              
                                      <li class="inner"><a href="/archive/7/2007">July </a> <span>(4)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/6/2007">June </a> <span>(16)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/5/2007">May </a> <span>(23)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/4/2007">April </a> <span>(2)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/3/2007">March </a> <span>(6)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/2/2007">February </a> <span>(4)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/1/2007">January </a> <span>(4)</span></li>
                                  
              
                                
                                </ul>
                            </li>
                        
                <div class="posterous_ojs" data-posterous-show-on-click="true" data-posterous-id-to-show-on-click="archive_months2007" data-posterous-action-trigger-id="archive_year2007" data-posterous-hide-on-click-id="none"></div>                
              
                
                            <li>
                                <a href="#" id="archive_year2006">2006</a> <span>(214)</span>
                                <ul id="archive_months2006" style="display:none;">
                                
                                  
                                              
                                      <li class="inner"><a href="/archive/12/2006">December </a> <span>(2)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/11/2006">November </a> <span>(2)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/10/2006">October </a> <span>(8)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/9/2006">September </a> <span>(12)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/8/2006">August </a> <span>(34)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/7/2006">July </a> <span>(29)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/6/2006">June </a> <span>(23)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/5/2006">May </a> <span>(34)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/4/2006">April </a> <span>(15)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/3/2006">March </a> <span>(23)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/2/2006">February </a> <span>(23)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/1/2006">January </a> <span>(9)</span></li>
                                  
              
                                
                                </ul>
                            </li>
                        
                <div class="posterous_ojs" data-posterous-show-on-click="true" data-posterous-id-to-show-on-click="archive_months2006" data-posterous-action-trigger-id="archive_year2006" data-posterous-hide-on-click-id="none"></div>                
              
                
                            <li>
                                <a href="#" id="archive_year2005">2005</a> <span>(46)</span>
                                <ul id="archive_months2005" style="display:none;">
                                
                                  
                                              
                                      <li class="inner"><a href="/archive/12/2005">December </a> <span>(22)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/11/2005">November </a> <span>(17)</span></li>
                                  
              
                                              
                                      <li class="inner"><a href="/archive/10/2005">October </a> <span>(7)</span></li>
                                  
              
                                
                                </ul>
                            </li>
                        
                <div class="posterous_ojs" data-posterous-show-on-click="true" data-posterous-id-to-show-on-click="archive_months2005" data-posterous-action-trigger-id="archive_year2005" data-posterous-hide-on-click-id="none"></div>                
              
                    </ul>
                
              
            
				<h4>Get Updates</h4>
          <div class="subscribe_to_mysite clearfix">
              
              <div><a href="http://feeds.feedburner.com/LessIsBetter" class="subscribe_link" target="_blank">Subscribe via RSS</a> </div>
              <div class="social-bookmarks">
                  <a href="http://twitter.com/john_lam" class="p_external_site p_twitter" rel="me">Twitter</a>
              </div>
          </div>

			</li>
            <li class="column last">
                
                
              

            </li>
		</ul>
		
		<form class="search-form" method="get">
            <input name="sort" value="" type="hidden" />
            <input name="search" class="search" id="searchbox" value="" type="text" />
            <input class="search_button" value="Search" type="submit" />
        </form>
        
              
            
	
	</div>
</div>



  
      <script type="text/javascript">
    	var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    	document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    	</script>
    	<script type="text/javascript">
    	var pageTracker = _gat._getTracker("UA-4054156-1");
    	pageTracker._setDomainName("none");
    	pageTracker._setAllowLinker(true);
    	pageTracker._setAllowHash(false);
    	pageTracker._initData();
    	pageTracker._trackPageview();
    	</script>
    
  
  <!-- Quantcast Tag --> 
  <script type="text/javascript">
    var _qevents = _qevents || [];
    _qevents.push( { qacct:"p-16ewveTurfCCM"} );
  </script>
  <script type="text/javascript" src="//edge.quantserve.com/quant.js" async></script>
  <noscript>
  <div style="display: none;"><img src="https://pixel.quantserve.com/pixel/p-16ewveTurfCCM.gif" height="1" width="1" alt="Quantcast"/></div>
  </noscript>
  <!-- End Quantcast tag -->


	<script type="text/javascript">
		try {
			var pageTrackerUser = _gat._getTracker("UA-12323255-1");
			pageTrackerUser._trackPageview();
		} catch (err) {}
	</script>


<script src="http://www.scribd.com/javascripts/view.js" type="text/javascript"></script>
<script src="/bundles/sites_views.js" type="text/javascript"></script>
<script src="/bundles/sites.js" type="text/javascript"></script>
<script src="http://www.google.com/recaptcha/api/js/recaptcha_ajax.js" type="text/javascript"></script>

<script>
	var fbid_site_owner = 1;
</script>












<div class="posterous_ojs" data-posterous-twitter-oauth="true" data-posterous-post-ids="%7B%2236932752%22%3A%22http%3A%2F%2Fiunknown.com%2F2005%2F12%2Fmindbinders.html%22%2C%2236932732%22%3A%22http%3A%2F%2Fiunknown.com%2F2005%2F12%2Fthird-drop-of-rbdynamicmethod.html%22%2C%2236932756%22%3A%22http%3A%2F%2Fiunknown.com%2F2005%2F12%2Fclr-object-lifetime.html%22%2C%2236932735%22%3A%22http%3A%2F%2Fiunknown.com%2F2005%2F12%2Fdemocamp.html%22%2C%2236932746%22%3A%22http%3A%2F%2Fiunknown.com%2F2005%2F12%2Frefactoring-cil.html%22%2C%2236932758%22%3A%22http%3A%2F%2Fiunknown.com%2F2005%2F12%2Fdreamhost-for-22-usd-first-year.html%22%2C%2236932770%22%3A%22http%3A%2F%2Fiunknown.com%2F2005%2F12%2Fben-and-us.html%22%2C%2236932759%22%3A%22http%3A%2F%2Fiunknown.com%2F2005%2F12%2Fintroducing-benjamin-peter-lam.html%22%2C%2236932750%22%3A%22http%3A%2F%2Fiunknown.com%2F2005%2F12%2Fhow-meta-can-you-go.html%22%2C%2236932740%22%3A%22http%3A%2F%2Fiunknown.com%2F2005%2F12%2Fhello-rubyclr.html%22%7D" data-posterous-redirect-url="http://posterous.com/oauth/init_oauth_and_redirect/?ssod=iunknown.com&oauth_provider_type="></div>
<script type="text/javascript" src="http://platform.twitter.com/widgets.js" defer></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<div style="display: none;"><iframe src="http://posterous.com/analytics_tracker" style="height: 1px; width: 1px;"></iframe></div></body>
</html>



