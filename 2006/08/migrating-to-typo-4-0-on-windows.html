<!DOCTYPE html>
<html xmlns:fb="http://www.facebook.com/2008/fbml" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
      <meta http-equiv="X-UA-Compatible" content="chrome=1" />
      <meta name="width" content="500" />
      <meta name="generator" content="Posterous" />
      <script src="/javascripts/vendor/modernizr.custom.09241.js?1367517938" type="text/javascript"></script>
      <!--[if lt IE 9]>
        <script src="/javascripts/innershiv.js?1367517938" type="text/javascript"></script>
      <![endif]-->
      <link href="/bundles/posts.css" media="screen" rel="stylesheet" type="text/css" />
      <!--[if lt IE 9]>
        <link href="/bundles/ie.css" media="screen" rel="stylesheet" type="text/css" />
      <![endif]-->
      <link rel="alternate" type="application/rss+xml" href="http://feeds.feedburner.com/LessIsBetter"/>
      <meta name="medium" content="blog" /><link rel="image_src" href="http://posterous.com/images/profile/missing-user-75.png" />
      <script type="text/javascript">
//<![CDATA[
window._token = 'K5qluXl5HOIU9bWdq9oJYrEuVokj7nLG7aYeXTLdHqg='; beforeload = (new Date()).getTime(); pagetype = 'show';
//]]>
</script>
      <script src="/bundles/sites_initialization.js" type="text/javascript"></script>
      <script type="text/javascript">
//<![CDATA[
var $j = jQuery.noConflict();
//]]>
</script>
      <script type="text/javascript">
//<![CDATA[
var POSTEROUS_HOSTNAME = 'posterous.com'
//]]>
</script>
      <script data-post-data="%7B%22post_id%22%3A36933569%2C%22post_is_private%22%3Afalse%2C%22user_id%22%3A931119%2C%22post_url_slug%22%3A%22migrating-to-typo-40-on-windows%22%7D" data-posterous-deferred-content-url="http://iunknown.com/posts/deferred_content.jsonp" data-posts-data="%5B%7B%22post_id%22%3A36933569%2C%22post_is_private%22%3Afalse%2C%22user_id%22%3A931119%2C%22post_url_slug%22%3A%22migrating-to-typo-40-on-windows%22%7D%5D" id="posterous_initialization_script" src="/javascripts/initialize.js?1367517938" type="text/javascript"></script>
      
    <script src="/bundles/tags.js" type="text/javascript"></script><link rel="canonical" href="http://iunknown.com/2006/08/migrating-to-typo-4-0-on-windows.html" />
<link href="/themes/light-matter/post-style.css" rel="stylesheet" type="text/css" />
<!--[if lte IE 8]>
	<link href="/themes/light-matter/ie-style.css" rel="stylesheet" type="text/css" />
<![endif]-->
<title>Migrating to Typo 4.0 on Windows - John Lam on Software</title>
</head>
<body><div class="posterous_site_data" data-post-id="36933569" data-posterous-hostname="posterous.com" data-show-type="post" data-site-id="2278433" data-site-is-private="false" data-site-location="false" data-site-type="posterous" data-slug-id="migrating-to-typo-40-on-windows" data-user-id="931119"></div><div class="posterous_ojs" data-posterous-admin-box="true"></div><div class="posterousPrivateBox">
	
	
</div>
      <div id="fb-root"></div>
        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId  : '6694405826',
              status : true, // check login status
              cookie : true, // enable cookies to allow the server to access the session
              xfbml  : true, // parse XFBML
              oauth  : true

            });
            
          };

          (function() {
            var e = document.createElement('script');
            e.type = 'text/javascript';
            e.src = 'http://connect.facebook.net/en_US/all.js';
            e.async = true;
            document.getElementById('fb-root').appendChild(e);
          }());
        </script>
    
  <div id="pbar">
        				<noscript>
  <div id="posterousbar_nojs">
    <a href="http://posterous.com/"><img src="/images/header/yellow.png" alt="Posterous" /></a>
  </div>
</noscript>
              </div>
<div id="header-container">
	<div id="header">
		
		<h1 class="site-name"><a href="http://iunknown.com">John Lam on Software</a></h1>
		<p class="site-description"></p>
	</div>
</div>

                
	<div id="pages-container">
		<div id="pages">
            <ul>
            	
                
                    <li><a href="http://about.me/jlam" title="About me" class="">About me</a></li>
                
              
            </ul>
		</div>
	</div>

              
<div id="container">
	<ul class="post-list clearfix">
		
			<li class="post-item clearfix" id="post_36933569">
				<div class="title-block">
					
						<h3 class="title" id="posttitle_36933569"><a href="http://iunknown.com/2006/08/migrating-to-typo-4-0-on-windows.html">Migrating to Typo 4.0 on Windows</a></h3>
					
					
						<ul class="meta">
							<li class="date">22 Aug 2006</li>
							<li class="comments"><a href="http://iunknown.com/2006/08/migrating-to-typo-4-0-on-windows.html" id="comment_link_36933569">1 Response</a></li>
							<li class="views"><div class="posterous_ojs" data-posterous-view-count="true" data-posterous-post-id="36933569"></div>&nbsp;views</li>
                            
                
              
						</ul>
					
					
					<div class="editbox clearfix" id="editunit_36933569">
						
        				
                  <ul class="mini_commands posterous_edit_box posterous_edit_box_hidden" data-posterous-edit-box="true" data-posterous-post-id="36933569">
	
	<li><a href="http://posterous.com/posts/edit/36933569">Edit</a></li>
  <li><a href="/posts/destroy/36933569" onclick="if (confirm('Are you sure you want to delete this post?')) { var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var m = document.createElement('input'); m.setAttribute('type', 'hidden'); m.setAttribute('name', '_method'); m.setAttribute('value', 'delete'); f.appendChild(m);var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'K5qluXl5HOIU9bWdq9oJYrEuVokj7nLG7aYeXTLdHqg='); f.appendChild(s);f.submit(); };return false;">Delete</a></li>
	<li><a href="http://posterous.com/posts/36933569/tags/edit_multiple" data-post-id="36933569" data-posterous-modal="true" data-posterous-tag-form="true">Tags</a></li>
	
	  <li><a href="//posterous.com/autopost/crosspost?post_id=36933569" data-posterous-modal="true">Autopost</a>
	
</ul>

                
                
					</div>
					
				</div>
				<div class="post-content" id="postbox_36933569">
					<div class="copy">
						<p>I did this initially before deciding to move my blog to <a href="http://www.dreamhost.com">Dreamhost</a>. I thought I&rsquo;d leave these notes up in case someone else wants to do this as well. Moving to Dreamhost was not without its own set of problems, but it turned out to be easier than migrating in Windows with <a href="http://rubyforge.org/projects/instantrails/">InstantRails</a>.</p>
<p>This took a lot longer than I thought it would like most of my adventures into sysadmin land :) Here are a few notes to try and cut down on the amount of effort that other folks might run into.</p>
<p>The first step is to create two side-by-side installs of Instant Rails. Instant Rails for Windows users is like &ldquo;VMWare for Rails&rdquo;. Essentially it&rsquo;s a single directory install of everything that you need to run Rails, but like many other technologies of its ilk, it comes in different versions :)</p>
<p>Step 1: I took the existing InstantRails install and fired it up using <code>instantrails</code>. This auto-starts both Apache and MySQL. I used the <code>mysqldump</code> utility to back up my existing Typo MySQL database to a plain-text <span class="caps">SQL</span> file:</p>
<div class="CodeRay">
  <div class="code"><pre>mysqldump -uroot typo &gt; typo.sql</pre></div>
</div>

<p>Step 2: Shut down the first InstantRails install, and startup the new InstantRails install. Install typo via gems:</p>
<div class="CodeRay">
  <div class="code"><pre>gem install typo --include-dependencies</pre></div>
</div>

<p>Step 3: Create a new typo blog:</p>
<div class="CodeRay">
  <div class="code"><pre>typo install \instantrails\rails_apps\typo</pre></div>
</div>

<p>Step 4: Copy your existing <code>.htaccess</code> and <code>database.yml</code> files from the old typo installation.</p>
<p>Step 5: Create a new <code>typo</code> database using the <span class="caps">PHP</span> web-based admin tool. This is the <strong>most important point</strong>. Make sure that the collation is set to latin1_swedish_ci!</p>
<p>Step 6: Import the existing mysql database into the new InstantRails install using <code>mysql</code>:</p>
<div class="CodeRay">
  <div class="code"><pre>mysql -uroot typo &lt; typo.sql</pre></div>
</div>

<p>Step 7: Use migrations to migrate your existing database schema to the Typo 4.0 schema:</p>
<div class="CodeRay">
  <div class="code"><pre>\instantrails\rails_apps\typo&gt;rake migrate</pre></div>
</div>

<p>Step 8: Create the appropriate section in the <code>\instantrails\conf_files\http.conf</code> file. It should look something like this:</p>
<div class="CodeRay">
  <div class="code"><pre>&amp;lt;VirtualHost *&gt;
ServerName www.iunknown.com
# handle all requests through SCGI
SCGIMount /dispatch.fcgi 127.0.0.1:9999
DocumentRoot ${path}/rails_apps/typo/public
&amp;lt;Directory ${path}/rails_apps/typo/public&gt;
Options +FollowSymLinks
Order allow,deny
allow from all
&amp;lt;/Directory&gt;
AddDefaultCharset utf-8
ErrorDocument 500 /500.html
ErrorDocument 404 /404.html
&amp;lt;/VirtualHost&gt;</pre></div>
</div>

<p>That should do it. I&rsquo;m too embarrassed to say how long this took me to figure out. Now back to easier stuff like writing RubyCLR :)</p>
						
					</div>

						<ul class="social">
							<li class="tweet">
								
              
            
							</li>
							<li class="like">
								<fb:like href="http://iunknown.com/2006/08/migrating-to-typo-4-0-on-windows.html" layout="button_count"></fb:like> 
							</li>
						</ul>
								
                    
                        
              
                
              
            
                    
				</div>	
				
					
              <aside class="p_responses light">
                
            
          
            
              <nav class='p_response_widget'>
<ul class='clearfix'>
<li class='p_responses_link'><a href="/responses/recent?post_id=36933569" data-posterous-response-count="36933569" data-response-post-id="36933569" title="View responses to this post"><strong>1</strong> response</a></li>
<li class='p_like_link'><a href="/likes/create?like_type=post&amp;post_id=36933569" class="like_post" data-like-url="/likes/create?like_type=post&amp;post_id=36933569" data-posterous-like-button-for-post-id="36933569" data-posterous-like-text="Like this post" data-posterous-like="true" data-posterous-unlike-text="Unlike this post" data-unlike-url="/likes/delete?like_type=post&amp;post_id=36933569" rel="nofollow" title="Like this post"><div class='p_like_icon'></div><div class='p_unlike_icon' style='display:none'></div><span>Like</span></a></li>
<li class='p_comment_link'><a href="/responses/recent?post_id=36933569" data-comment-post-id="36933569" title="Comment on this post"><div>Comment</div></a></li>
</ul>
</nav>

          		<esi:include src="http://posterous.com/responses?post_id=36933569&user_id=931119" />
          		<div class="posterous_ojs" data-posterous-new-comment-form="true"></div>
            
          
              </aside> 
        		
				
			</li>		
		
		<li class="pagination">
			 
		</li>		
	</ul>
</div>

<div id="footer-container">
	<div id="footer">
	
		<ul class="three-column clearfix">
    		<li class="column clearfix">
				
                
                    
              
            
                
			</li>
			<li class="column">
            
                
            
				<h4>Get Updates</h4>
          <div class="subscribe_to_mysite clearfix">
              
              <div><a href="http://feeds.feedburner.com/LessIsBetter" class="subscribe_link" target="_blank">Subscribe via RSS</a> </div>
              <div class="social-bookmarks">
                  <a href="http://twitter.com/john_lam" class="p_external_site p_twitter" rel="me">Twitter</a>
              </div>
          </div>

			</li>
            <li class="column last">
                
                
              

            </li>
		</ul>
		
		<form class="search-form" method="get">
            <input name="sort" value="" type="hidden" />
            <input name="search" class="search" id="searchbox" value="" type="text" />
            <input class="search_button" value="Search" type="submit" />
        </form>
        
	
	</div>
</div>



  
      <script type="text/javascript">
    	var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    	document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    	</script>
    	<script type="text/javascript">
    	var pageTracker = _gat._getTracker("UA-4054156-1");
    	pageTracker._setDomainName("none");
    	pageTracker._setAllowLinker(true);
    	pageTracker._setAllowHash(false);
    	pageTracker._initData();
    	pageTracker._trackPageview();
    	</script>
    
  
  <!-- Quantcast Tag --> 
  <script type="text/javascript">
    var _qevents = _qevents || [];
    _qevents.push( { qacct:"p-16ewveTurfCCM"} );
  </script>
  <script type="text/javascript" src="//edge.quantserve.com/quant.js" async></script>
  <noscript>
  <div style="display: none;"><img src="https://pixel.quantserve.com/pixel/p-16ewveTurfCCM.gif" height="1" width="1" alt="Quantcast"/></div>
  </noscript>
  <!-- End Quantcast tag -->


	<script type="text/javascript">
		try {
			var pageTrackerUser = _gat._getTracker("UA-12323255-1");
			pageTrackerUser._trackPageview();
		} catch (err) {}
	</script>


<script src="http://www.scribd.com/javascripts/view.js" type="text/javascript"></script>
<script src="/bundles/sites_views.js" type="text/javascript"></script>
<script src="/bundles/sites.js" type="text/javascript"></script>
<script type="text/javascript" src="http://platform.twitter.com/widgets.js" defer></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>

<script>
	var fbid_site_owner = 1;
</script>



<div class="posterous_ojs" data-posterous-twitter-oauth="true" data-posterous-post-ids="%7B%2236933569%22%3A%22http%3A%2F%2Fiunknown.com%2F2006%2F08%2Fmigrating-to-typo-4-0-on-windows.html%22%7D" data-posterous-redirect-url="http://posterous.com/oauth/init_oauth_and_redirect/?ssod=iunknown.com&oauth_provider_type="></div>
<script src="http://www.google.com/recaptcha/api/js/recaptcha_ajax.js" type="text/javascript"></script>
<iframe src="http://posterous.com/analytics_tracker" style="height: 1px; width: 1px; display: none;"></iframe>

      <script type="text/javascript">
        null_fn = function () {};
        var mpmetrics = { track_links: null_fn, track: null_fn, track_funnel: null_fn, register: null_fn, register_once: null_fn, register_funnel: null_fn };
      </script>
    </body>
</html>


