<!DOCTYPE html>
<html xmlns:fb="http://www.facebook.com/2008/fbml" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
      <meta http-equiv="X-UA-Compatible" content="chrome=1" />
      <meta name="width" content="500" />
      <meta name="generator" content="Posterous" />
      <script src="/javascripts/vendor/modernizr.custom.09241.js?1367517938" type="text/javascript"></script>
      <!--[if lt IE 9]>
        <script src="/javascripts/innershiv.js?1367517938" type="text/javascript"></script>
      <![endif]-->
      <link href="/bundles/posts.css" media="screen" rel="stylesheet" type="text/css" />
      <!--[if lt IE 9]>
        <link href="/bundles/ie.css" media="screen" rel="stylesheet" type="text/css" />
      <![endif]-->
      <link rel="alternate" type="application/rss+xml" href="http://feeds.feedburner.com/LessIsBetter"/>
      <meta name="medium" content="image" /><link rel="image_src" href="http://getfile7.posterous.com/getfile/files.posterous.com/import-sges/tqwkmeqsikteBqGbfjeDraoyfggqrxvxoagmevadqEfzlEggBkIFIzkrjAvv/media_httpwwwiunknown_pcodG.png.thumb100.png" />
      <script type="text/javascript">
//<![CDATA[
window._token = 'K5qluXl5HOIU9bWdq9oJYrEuVokj7nLG7aYeXTLdHqg='; beforeload = (new Date()).getTime(); pagetype = 'show';
//]]>
</script>
      <script src="/bundles/sites_initialization.js" type="text/javascript"></script>
      <script type="text/javascript">
//<![CDATA[
var $j = jQuery.noConflict();
//]]>
</script>
      <script type="text/javascript">
//<![CDATA[
var POSTEROUS_HOSTNAME = 'posterous.com'
//]]>
</script>
      <script data-post-data="%7B%22post_id%22%3A37117201%2C%22post_is_private%22%3Afalse%2C%22user_id%22%3A931119%2C%22post_url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D" data-posterous-deferred-content-url="http://iunknown.com/posts/deferred_content.jsonp" data-posts-data="%5B%7B%22post_id%22%3A37117201%2C%22post_is_private%22%3Afalse%2C%22user_id%22%3A931119%2C%22post_url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D%5D" id="posterous_initialization_script" src="/javascripts/initialize.js?1367517938" type="text/javascript"></script>
      
    <script src="/bundles/tags.js" type="text/javascript"></script><link rel="canonical" href="http://iunknown.com/2008/03/dynamic-silverlight-part-3-integrating-silverlight-with-asp-net-mvc.html" />
<link href="/themes/light-matter/post-style.css" rel="stylesheet" type="text/css" />
<!--[if lte IE 8]>
	<link href="/themes/light-matter/ie-style.css" rel="stylesheet" type="text/css" />
<![endif]-->
<title>Dynamic Silverlight Part 3: Integrating Silverlight with ASP.NET MVC - John Lam on Software</title>
</head>
<body><div class="posterous_site_data" data-post-id="37117201" data-posterous-hostname="posterous.com" data-show-type="post" data-site-id="2278433" data-site-is-private="false" data-site-location="false" data-site-type="posterous" data-slug-id="dynamic-silverlight-part-3-integrating-silver" data-user-id="931119"></div><div class="posterous_ojs" data-posterous-admin-box="true"></div><div class="posterousPrivateBox">
	
	
</div>
      <div id="fb-root"></div>
        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId  : '6694405826',
              status : true, // check login status
              cookie : true, // enable cookies to allow the server to access the session
              xfbml  : true, // parse XFBML
              oauth  : true

            });
            
          };

          (function() {
            var e = document.createElement('script');
            e.type = 'text/javascript';
            e.src = 'http://connect.facebook.net/en_US/all.js';
            e.async = true;
            document.getElementById('fb-root').appendChild(e);
          }());
        </script>
    
  <div id="pbar">
        				<noscript>
  <div id="posterousbar_nojs">
    <a href="http://posterous.com/"><img src="/images/header/yellow.png" alt="Posterous" /></a>
  </div>
</noscript>
              </div>
<div id="header-container">
	<div id="header">
		
		<h1 class="site-name"><a href="http://iunknown.com">John Lam on Software</a></h1>
		<p class="site-description"></p>
	</div>
</div>

                
	<div id="pages-container">
		<div id="pages">
            <ul>
            	
                
                    <li><a href="http://about.me/jlam" title="About me" class="">About me</a></li>
                
              
            </ul>
		</div>
	</div>

              
<div id="container">
	<ul class="post-list clearfix">
		
			<li class="post-item clearfix" id="post_37117201">
				<div class="title-block">
					
						<h3 class="title" id="posttitle_37117201"><a href="http://iunknown.com/2008/03/dynamic-silverlight-part-3-integrating-silverlight-with-asp-net-mvc.html">Dynamic Silverlight Part 3: Integrating Silverlight with ASP.NET MVC</a></h3>
					
					
						<ul class="meta">
							<li class="date">7 Mar 2008</li>
							<li class="comments"><a href="http://iunknown.com/2008/03/dynamic-silverlight-part-3-integrating-silverlight-with-asp-net-mvc.html" id="comment_link_37117201">8 Responses</a></li>
							<li class="views"><div class="posterous_ojs" data-posterous-view-count="true" data-posterous-post-id="37117201"></div>&nbsp;views</li>
                            
                
              
						</ul>
					
					
					<div class="editbox clearfix" id="editunit_37117201">
						
        				
                  <ul class="mini_commands posterous_edit_box posterous_edit_box_hidden" data-posterous-edit-box="true" data-posterous-post-id="37117201">
	
	<li><a href="http://posterous.com/posts/edit/37117201">Edit</a></li>
  <li><a href="/posts/destroy/37117201" onclick="if (confirm('Are you sure you want to delete this post?')) { var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var m = document.createElement('input'); m.setAttribute('type', 'hidden'); m.setAttribute('name', '_method'); m.setAttribute('value', 'delete'); f.appendChild(m);var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'K5qluXl5HOIU9bWdq9oJYrEuVokj7nLG7aYeXTLdHqg='); f.appendChild(s);f.submit(); };return false;">Delete</a></li>
	<li><a href="http://posterous.com/posts/37117201/tags/edit_multiple" data-post-id="37117201" data-posterous-modal="true" data-posterous-tag-form="true">Tags</a></li>
	
	  <li><a href="//posterous.com/autopost/crosspost?post_id=37117201" data-posterous-modal="true">Autopost</a>
	
</ul>

                
                
					</div>
					
				</div>
				<div class="post-content" id="postbox_37117201">
					<div class="copy">
						<p>We'll finish off our tour of Dynamic Silverlight (DSL) by looking at how we can connect it with an ASP.NET MVC app. Building on our flickr photo search app from <a href="http://www.iunknown.com/2008/03/dynamic-silve-1.html">Part 2</a>, we'll add support for saving links to your favorite photos to your MVC app. This is what the final app looks like:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FtqwkmeqsikteBqGbfjeDraoyfggqrxvxoagmevadqEfzlEggBkIFIzkrjAvv%2Fmedia_httpwwwiunknown_pcodG.png.scaled1000.png%22%2C%22originalWidth%22%3A%22500%22%2C%22largeWidth%22%3A%22500%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile8.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FtqwkmeqsikteBqGbfjeDraoyfggqrxvxoagmevadqEfzlEggBkIFIzkrjAvv%2Fmedia_httpwwwiunknown_pcodG.png.thumb.png%22%2C%22originalHeight%22%3A%22425%22%2C%22largeHeight%22%3A%22425%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22425%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FtqwkmeqsikteBqGbfjeDraoyfggqrxvxoagmevadqEfzlEggBkIFIzkrjAvv%2Fmedia_httpwwwiunknown_pcodG.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%22100%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FtqwkmeqsikteBqGbfjeDraoyfggqrxvxoagmevadqEfzlEggBkIFIzkrjAvv%2Fmedia_httpwwwiunknown_pcodG.png%22%2C%22width%22%3A%22500%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_15.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_pcodg" height="425" src="http://getfile3.posterous.com/getfile/files.posterous.com/import-sges/tqwkmeqsikteBqGbfjeDraoyfggqrxvxoagmevadqEfzlEggBkIFIzkrjAvv/media_httpwwwiunknown_pcodG.png.scaled500.png" width="500" />

</div>
 </p>
<p>You should download the solution for this part of the lab if you want to follow along. </p>
<p><a href="http://www.iunknown.com/files/demos3.zip">Download demos3.zip</a> </p>
<p><strong>Configuring ASP.NET MVC</strong></p>
<p>This tutorial shows Visual Studio integration so you'll need to have the Silverlight Tools for Visual Studio installed along with the Silverlight SDK. Let's open up the solution in the demos\mvc_start sub-directory using Visual Studio. The first thing you should notice is how we've organized things in the project:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FqDqrHjhwDhhadubvszCkmFpodpthubfswajzdBnosDIFkfelAobqtcJyIraB%2Fmedia_httpwwwiunknown_zApCs.png%22%2C%22originalWidth%22%3A%22253%22%2C%22largeWidth%22%3A%22253%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FqDqrHjhwDhhadubvszCkmFpodpthubfswajzdBnosDIFkfelAobqtcJyIraB%2Fmedia_httpwwwiunknown_zApCs.png.thumb.png%22%2C%22originalHeight%22%3A%22444%22%2C%22largeHeight%22%3A%22444%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22444%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FqDqrHjhwDhhadubvszCkmFpodpthubfswajzdBnosDIFkfelAobqtcJyIraB%2Fmedia_httpwwwiunknown_zApCs.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2224%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FqDqrHjhwDhhadubvszCkmFpodpthubfswajzdBnosDIFkfelAobqtcJyIraB%2Fmedia_httpwwwiunknown_zApCs.png%22%2C%22width%22%3A%22253%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_16.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_zapcs" height="444" src="http://getfile3.posterous.com/getfile/files.posterous.com/import-sges/qDqrHjhwDhhadubvszCkmFpodpthubfswajzdBnosDIFkfelAobqtcJyIraB/media_httpwwwiunknown_zApCs.png.scaled500.png" width="253" />

</div>
 </p>
<p>This is pretty much the standard ASP.NET MVC directory layout (I started from an ASP.NET MVC project); I added the App and Assets directories.</p>
<p>If you look at the App directory, you'll see that I've also added all of the DSL assemblies that are needed to run the app. Since we're going to be running Chiron statically (eg zap everything in this directory) instead of dynamically (look in this directory and figure out what languages I'm using and then find and zap all of those files), those files <em>must</em> be in that directory.</p>
<p>Next, we'll make sure that Chiron is integrated into the build system. If you recall from <a href="http://www.iunknown.com/2008/03/dynamic-silverl.html">Part 1 of this series</a>, Chiron is our local web server that will automatically generate XAP files. Since we're now going to be running using the ASP.NET Development Web Server, we'll need to <strong>statically</strong> generate our XAP file. The good news is that it's pretty easy to do this: you just need to add a post-build step to your project. The bad news is that you'll need to build the project to run changes in your script files - just refreshing the page in the browser won't do the trick. I know I've been caught by this once or twice while writing this app.</p>
<p>Let's add the post-build step. Open your Project properties page, click on the Build Events tab, and add this string to your project:</p>
<p>$(ProjectDir)DynamicSilverlight\chiron.exe /d:$(ProjectDir)App /x:$(ProjectDir)App.xap. </p>
<p>It should look like this when you're done: </p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile8.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FeqFgnfHgvjAdvtaeqmuehyqhvvJkmyfEbktbhevJcqkCfnuyDwidoABjnImG%2Fmedia_httpwwwiunknown_frsau.png%22%2C%22originalWidth%22%3A%22487%22%2C%22largeWidth%22%3A%22487%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile4.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FeqFgnfHgvjAdvtaeqmuehyqhvvJkmyfEbktbhevJcqkCfnuyDwidoABjnImG%2Fmedia_httpwwwiunknown_frsau.png.thumb.png%22%2C%22originalHeight%22%3A%22379%22%2C%22largeHeight%22%3A%22379%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22379%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FeqFgnfHgvjAdvtaeqmuehyqhvvJkmyfEbktbhevJcqkCfnuyDwidoABjnImG%2Fmedia_httpwwwiunknown_frsau.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2224%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile8.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FeqFgnfHgvjAdvtaeqmuehyqhvvJkmyfEbktbhevJcqkCfnuyDwidoABjnImG%2Fmedia_httpwwwiunknown_frsau.png%22%2C%22width%22%3A%22487%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_17.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_frsau" height="379" src="http://getfile5.posterous.com/getfile/files.posterous.com/import-sges/eqFgnfHgvjAdvtaeqmuehyqhvvJkmyfEbktbhevJcqkCfnuyDwidoABjnImG/media_httpwwwiunknown_frsau.png.scaled500.png" width="487" />

</div>
 </p>
<p>Notice that there's a DynamicSilverlight subdirectory which contains a local copy of Chiron. I did this so that this would be a self contained project. Once we work out the details of how we'll setup the paths and ship Chiron as part of a DSL SDK, you won't need the DynamicSilverlight directory. </p>
<p>We'll need to make other change to the project file: enable Silverlight debugging on the client. Click on the Web tab in the project's properties dialog and make sure you select the Silverlight checkbox under the Debuggers section: </p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FfhJHydjpvlCscklgJlotFDvhDvuBjEAchviFchjEzCEIebFIGbFhFDAxrnAJ%2Fmedia_httpwwwiunknown_meCtm.png.scaled1000.png%22%2C%22originalWidth%22%3A%22500%22%2C%22largeWidth%22%3A%22500%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FfhJHydjpvlCscklgJlotFDvhDvuBjEAchviFchjEzCEIebFIGbFhFDAxrnAJ%2Fmedia_httpwwwiunknown_meCtm.png.thumb.png%22%2C%22originalHeight%22%3A%22280%22%2C%22largeHeight%22%3A%22280%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22280%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FfhJHydjpvlCscklgJlotFDvhDvuBjEAchviFchjEzCEIebFIGbFhFDAxrnAJ%2Fmedia_httpwwwiunknown_meCtm.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2260%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile4.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FfhJHydjpvlCscklgJlotFDvhDvuBjEAchviFchjEzCEIebFIGbFhFDAxrnAJ%2Fmedia_httpwwwiunknown_meCtm.png%22%2C%22width%22%3A%22500%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_18.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_mectm" height="280" src="http://getfile9.posterous.com/getfile/files.posterous.com/import-sges/fhJHydjpvlCscklgJlotFDvhDvuBjEAchviFchjEzCEIebFIGbFhFDAxrnAJ/media_httpwwwiunknown_meCtm.png.scaled500.png" width="500" />

</div>
 </p>
<p>Next, we have to generate the correct HTML to boot our Silverlight app. We'll edit the code under Views\Home to add the Silverlight boostrap &lt;object&gt; tag to our MVC app: </p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FEBlbgBAuqxwIEhtbAkhsasgBxBzHuaCgCqiIIeBBsJwBqzAxcAeteeyIkHrv%2Fmedia_httpwwwiunknown_aGoEr.png.scaled1000.png%22%2C%22originalWidth%22%3A%22483%22%2C%22largeWidth%22%3A%22483%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile8.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FEBlbgBAuqxwIEhtbAkhsasgBxBzHuaCgCqiIIeBBsJwBqzAxcAeteeyIkHrv%2Fmedia_httpwwwiunknown_aGoEr.png.thumb.png%22%2C%22originalHeight%22%3A%22838%22%2C%22largeHeight%22%3A%22838%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22838%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile0.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FEBlbgBAuqxwIEhtbAkhsasgBxBzHuaCgCqiIIeBBsJwBqzAxcAeteeyIkHrv%2Fmedia_httpwwwiunknown_aGoEr.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2250%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile4.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FEBlbgBAuqxwIEhtbAkhsasgBxBzHuaCgCqiIIeBBsJwBqzAxcAeteeyIkHrv%2Fmedia_httpwwwiunknown_aGoEr.png%22%2C%22width%22%3A%22483%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_19.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_agoer" height="838" src="http://getfile0.posterous.com/getfile/files.posterous.com/import-sges/EBlbgBAuqxwIEhtbAkhsasgBxBzHuaCgCqiIIeBBsJwBqzAxcAeteeyIkHrv/media_httpwwwiunknown_aGoEr.png.scaled500.png" width="483" />

</div>
 </p>
<p>If you build and run your solution, you should see the app start up in your browser. If you look at the file system, you should see that Visual Studio + Chiron has generated the App.xap file for you. </p>
<p><strong>Tour of the Ruby code</strong> </p>
<p>The Ruby code looks an awful lot like the JScript code from <a href="http://www.iunknown.com/2008/03/dynamic-silve-1.html">Part 2</a> except for the parts of the app that generate WPF. In the JScript code, we were generating XAML strings and injecting them into the page. But we can do much better in IronRuby :) </p>
<p>We build up the WPF element tree for the photo and its border using this fragment of Ruby: </p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FctFvavwEAphzGFeIbHDJyAjDFsswEzkhFHnHecclxupgABAEHnDFklGguqBp%2Fmedia_httpwwwiunknown_buzqp.png%22%2C%22originalWidth%22%3A%22493%22%2C%22largeWidth%22%3A%22493%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile2.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FctFvavwEAphzGFeIbHDJyAjDFsswEzkhFHnHecclxupgABAEHnDFklGguqBp%2Fmedia_httpwwwiunknown_buzqp.png.thumb.png%22%2C%22originalHeight%22%3A%22364%22%2C%22largeHeight%22%3A%22364%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22364%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile2.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FctFvavwEAphzGFeIbHDJyAjDFsswEzkhFHnHecclxupgABAEHnDFklGguqBp%2Fmedia_httpwwwiunknown_buzqp.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2222%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FctFvavwEAphzGFeIbHDJyAjDFsswEzkhFHnHecclxupgABAEHnDFklGguqBp%2Fmedia_httpwwwiunknown_buzqp.png%22%2C%22width%22%3A%22493%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_20.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_buzqp" height="364" src="http://getfile2.posterous.com/getfile/files.posterous.com/import-sges/ctFvavwEAphzGFeIbHDJyAjDFsswEzkhFHnHecclxupgABAEHnDFklGguqBp/media_httpwwwiunknown_buzqp.png.scaled500.png" width="493" />

</div>
 </p>
<p>One of the reasons why programming with XAML is so easy is that the XAML parser does a lot of the heavy lifting involved in doing the proper <em>type conversions</em>. If you're programming against WPF directly, you're going to have to ensure that properties are assigned values of the correct type. </p>
<p>There's a fair amount of code in Silverlight.rb that does property transformations. For example, take a look at the code that sets render_transform_origin: </p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsrdnFfAlgAtcpjacmwnGktyskuspkifvwFpisrpexikChdIeDyrqaIFIhzGy%2Fmedia_httpwwwiunknown_qCjlB.png%22%2C%22originalWidth%22%3A%22369%22%2C%22largeWidth%22%3A%22369%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile1.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsrdnFfAlgAtcpjacmwnGktyskuspkifvwFpisrpexikChdIeDyrqaIFIhzGy%2Fmedia_httpwwwiunknown_qCjlB.png.thumb.png%22%2C%22originalHeight%22%3A%22183%22%2C%22largeHeight%22%3A%22183%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22183%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsrdnFfAlgAtcpjacmwnGktyskuspkifvwFpisrpexikChdIeDyrqaIFIhzGy%2Fmedia_httpwwwiunknown_qCjlB.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%227%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsrdnFfAlgAtcpjacmwnGktyskuspkifvwFpisrpexikChdIeDyrqaIFIhzGy%2Fmedia_httpwwwiunknown_qCjlB.png%22%2C%22width%22%3A%22369%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_21.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_qcjlb" height="183" src="http://getfile5.posterous.com/getfile/files.posterous.com/import-sges/srdnFfAlgAtcpjacmwnGktyskuspkifvwFpisrpexikChdIeDyrqaIFIhzGy/media_httpwwwiunknown_qCjlB.png.scaled500.png" width="369" />

</div>
 </p>
<p>Notice how we convert the Ruby array parameter into a WPF Point object before assigning to the property. Also notice how we've monkey-patched this behavior in the UIElement class, which is where the render_transform_origin property is introduced in the type hierarchy. All current and future descendents of UIElement will automatically inherit this behavior. </p>
<p>Another thing to point out is BounceAnimation. This is a class that encapsulates a WPF storyboard that knows how to generate the 'bounce' effect that you'll see when the photos appear (side note: I'm not really a Silverlight guy, I only play one on TV, and I'm too embarrassed to say just how long it took me to figure this out last year). If you look at the definition for BounceAnimation in Silverlight.rb, you'll see that it's quite compact: </p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FaIAtzblhFIdgwjjuofvrdAeiHouadarfbhqdBhhFuskbCoGchwkssofkvffd%2Fmedia_httpwwwiunknown_vcFmo.png.scaled1000.png%22%2C%22originalWidth%22%3A%22485%22%2C%22largeWidth%22%3A%22485%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FaIAtzblhFIdgwjjuofvrdAeiHouadarfbhqdBhhFuskbCoGchwkssofkvffd%2Fmedia_httpwwwiunknown_vcFmo.png.thumb.png%22%2C%22originalHeight%22%3A%22770%22%2C%22largeHeight%22%3A%22770%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22770%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile1.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FaIAtzblhFIdgwjjuofvrdAeiHouadarfbhqdBhhFuskbCoGchwkssofkvffd%2Fmedia_httpwwwiunknown_vcFmo.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2242%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile4.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FaIAtzblhFIdgwjjuofvrdAeiHouadarfbhqdBhhFuskbCoGchwkssofkvffd%2Fmedia_httpwwwiunknown_vcFmo.png%22%2C%22width%22%3A%22485%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_22.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_vcfmo" height="770" src="http://getfile1.posterous.com/getfile/files.posterous.com/import-sges/aIAtzblhFIdgwjjuofvrdAeiHouadarfbhqdBhhFuskbCoGchwkssofkvffd/media_httpwwwiunknown_vcFmo.png.scaled500.png" width="485" />

</div>
 </p>
<p>The other important thing to point out is that you now have a <em>named</em> animation. So you can now nicely encapsulate different animations, like Twirl or Zoom or Fade and simply apply them to your elements without having to copy and paste XAML. </p>
<p>While generating WPF trees using Ruby is more compact than generating them using XAML, there are other reasons why it is useful. Recall the code from Part 2 that loaded the images: </p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FBipbBanyHDjqviItoDbxtvmidiyoHcvutayFCExjfbvdqferhGfsbmhjbAqu%2Fmedia_httpwwwiunknown_wGolp.png%22%2C%22originalWidth%22%3A%22492%22%2C%22largeWidth%22%3A%22492%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FBipbBanyHDjqviItoDbxtvmidiyoHcvutayFCExjfbvdqferhGfsbmhjbAqu%2Fmedia_httpwwwiunknown_wGolp.png.thumb.png%22%2C%22originalHeight%22%3A%22301%22%2C%22largeHeight%22%3A%22301%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22301%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile8.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FBipbBanyHDjqviItoDbxtvmidiyoHcvutayFCExjfbvdqferhGfsbmhjbAqu%2Fmedia_httpwwwiunknown_wGolp.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2216%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FBipbBanyHDjqviItoDbxtvmidiyoHcvutayFCExjfbvdqferhGfsbmhjbAqu%2Fmedia_httpwwwiunknown_wGolp.png%22%2C%22width%22%3A%22492%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_23.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_wgolp" height="301" src="http://getfile8.posterous.com/getfile/files.posterous.com/import-sges/BipbBanyHDjqviItoDbxtvmidiyoHcvutayFCExjfbvdqferhGfsbmhjbAqu/media_httpwwwiunknown_wGolp.png.scaled500.png" width="492" />

</div>
 </p>
<p>This code uses a grotesque hack to ensure that the WPF for the photo isn't inserted into the scene <strong>until the image has finished loading. </strong>How does it do this? By loading the image <em>twice. </em></p>
<p>Let's look at how we can elegantly solve this problem by programmatically loading the photo from flickr: </p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsuhwAixAiGJjhIAbulGlcguAAzouHprydhsCnzjdAeofbjnappbcDDwvrpgq%2Fmedia_httpwwwiunknown_wtpEH.png%22%2C%22originalWidth%22%3A%22363%22%2C%22largeWidth%22%3A%22363%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsuhwAixAiGJjhIAbulGlcguAAzouHprydhsCnzjdAeofbjnappbcDDwvrpgq%2Fmedia_httpwwwiunknown_wtpEH.png.thumb.png%22%2C%22originalHeight%22%3A%22215%22%2C%22largeHeight%22%3A%22215%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22215%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile0.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsuhwAixAiGJjhIAbulGlcguAAzouHprydhsCnzjdAeofbjnappbcDDwvrpgq%2Fmedia_httpwwwiunknown_wtpEH.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%228%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsuhwAixAiGJjhIAbulGlcguAAzouHprydhsCnzjdAeofbjnappbcDDwvrpgq%2Fmedia_httpwwwiunknown_wtpEH.png%22%2C%22width%22%3A%22363%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_24.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_wtpeh" height="215" src="http://getfile0.posterous.com/getfile/files.posterous.com/import-sges/suhwAixAiGJjhIAbulGlcguAAzouHprydhsCnzjdAeofbjnappbcDDwvrpgq/media_httpwwwiunknown_wtpEH.png.scaled500.png" width="363" />

</div>
 </p>
<p>Here, we're using the Silverlight WebClient API to <em>asynchronously </em>download the image. The open_read_async method initiates the download, and the open_read_completed event fires when the download is complete. The args.result property references a Silverlight Stream object which we pass to the set_source method of the Bitmap object (created earlier). Notice how we can use a Ruby closure to close over the bitmap object without resorting to passing it as a parameter to the event handler. Finally, we inject the canvas object into the scene, and tell Silverlight to begin playing the animation that we assigned to the scene. </p>
<p><strong>Posting back to MVC</strong> </p>
<p>Let's add some additional functionality to the app. First, let's add an event handler to each photo so that it sends the photo's URI back to the MVC app when you click on it: </p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FseeyyFnxFkhebeptcEowcgaiiCDGHfDcarsokxEklAvmalIizGDDiwaihJHo%2Fmedia_httpwwwiunknown_Hepjb.png%22%2C%22originalWidth%22%3A%22485%22%2C%22largeWidth%22%3A%22485%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile2.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FseeyyFnxFkhebeptcEowcgaiiCDGHfDcarsokxEklAvmalIizGDDiwaihJHo%2Fmedia_httpwwwiunknown_Hepjb.png.thumb.png%22%2C%22originalHeight%22%3A%22228%22%2C%22largeHeight%22%3A%22228%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22228%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FseeyyFnxFkhebeptcEowcgaiiCDGHfDcarsokxEklAvmalIizGDDiwaihJHo%2Fmedia_httpwwwiunknown_Hepjb.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2212%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FseeyyFnxFkhebeptcEowcgaiiCDGHfDcarsokxEklAvmalIizGDDiwaihJHo%2Fmedia_httpwwwiunknown_Hepjb.png%22%2C%22width%22%3A%22485%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_25.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_hepjb" height="228" src="http://getfile5.posterous.com/getfile/files.posterous.com/import-sges/seeyyFnxFkhebeptcEowcgaiiCDGHfDcarsokxEklAvmalIizGDDiwaihJHo/media_httpwwwiunknown_Hepjb.png.scaled500.png" width="485" />

</div>
 </p>
<p>Notice that we're just posting the URI back to the server. Let's look at the ASP.NET MVC code that handles the HTTP GET request. This code lives in the Controllers\HomeController.cs file: </p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile1.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsElberImFAvmlhJyFrJkDFgjJjfvqwhtzrHBFEzxfyzgandElAFfAmpnBqzg%2Fmedia_httpwwwiunknown_nJJhb.png%22%2C%22originalWidth%22%3A%22485%22%2C%22largeWidth%22%3A%22485%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsElberImFAvmlhJyFrJkDFgjJjfvqwhtzrHBFEzxfyzgandElAFfAmpnBqzg%2Fmedia_httpwwwiunknown_nJJhb.png.thumb.png%22%2C%22originalHeight%22%3A%22161%22%2C%22largeHeight%22%3A%22161%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22161%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsElberImFAvmlhJyFrJkDFgjJjfvqwhtzrHBFEzxfyzgandElAFfAmpnBqzg%2Fmedia_httpwwwiunknown_nJJhb.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%229%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile1.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsElberImFAvmlhJyFrJkDFgjJjfvqwhtzrHBFEzxfyzgandElAFfAmpnBqzg%2Fmedia_httpwwwiunknown_nJJhb.png%22%2C%22width%22%3A%22485%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_26.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_njjhb" height="161" src="http://getfile7.posterous.com/getfile/files.posterous.com/import-sges/sElberImFAvmlhJyFrJkDFgjJjfvqwhtzrHBFEzxfyzgandElAFfAmpnBqzg/media_httpwwwiunknown_nJJhb.png.scaled500.png" width="485" />

</div>
 </p>
<p>Notice how we're just stuffing URLs into the ASP.NET Session object. It's an exercise left to the reader to add user management and hook this up to a database to make this a real multi-user app. </p>
<p>Once the user has selected some favorites, we want to let them see their collection of favorite photos. First, we'll need to add some code to our HomeController to display the view: </p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FCbBkonFqnqjqDglxtwtbcHvmGsvzkmbekmyJyeGhfzxadlFlfhHnjqklIhzt%2Fmedia_httpwwwiunknown_jjurG.png%22%2C%22originalWidth%22%3A%22497%22%2C%22largeWidth%22%3A%22497%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FCbBkonFqnqjqDglxtwtbcHvmGsvzkmbekmyJyeGhfzxadlFlfhHnjqklIhzt%2Fmedia_httpwwwiunknown_jjurG.png.thumb.png%22%2C%22originalHeight%22%3A%22104%22%2C%22largeHeight%22%3A%22104%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22104%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile2.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FCbBkonFqnqjqDglxtwtbcHvmGsvzkmbekmyJyeGhfzxadlFlfhHnjqklIhzt%2Fmedia_httpwwwiunknown_jjurG.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%226%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FCbBkonFqnqjqDglxtwtbcHvmGsvzkmbekmyJyeGhfzxadlFlfhHnjqklIhzt%2Fmedia_httpwwwiunknown_jjurG.png%22%2C%22width%22%3A%22497%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_27.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_jjurg" height="104" src="http://getfile2.posterous.com/getfile/files.posterous.com/import-sges/CbBkonFqnqjqDglxtwtbcHvmGsvzkmbekmyJyeGhfzxadlFlfhHnjqklIhzt/media_httpwwwiunknown_jjurG.png.scaled500.png" width="497" />

</div>
 </p>
<p>Notice how we're adding our list of semi-colon separated URIs to our ViewData. </p>
<p>Next we'll generate a new &lt;object&gt; tag that injects a list of favorites into the initParams property. We'll need to add a Favorites view to our MVC project. Everything in Favorites.aspx is identical to the code that I showed you earlier for Index.aspx, except for the part where we set the initParams property: </p>
<p>&lt;param name="initParams" <br />&nbsp; value="urls=&lt;%= ViewData["urls"] %&gt;,debug=true,reportErrors=errorLocation" /&gt; </p>
<p>Here, we retrieve our list of URIs from ViewData and inject it into the page.</p>
<p>Finally, we'll add a button that connects the UI on the client to the Favorites view. Open Views\Shared\Site.Master, and edit the code in there to add a Favorites button: </p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FnpJiyvmButvhItjqszvppFdgkchuCpobsnvACtpgEIjrhkpaHbJcliDajtJm%2Fmedia_httpwwwiunknown_zzavH.png%22%2C%22originalWidth%22%3A%22410%22%2C%22largeWidth%22%3A%22410%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile8.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FnpJiyvmButvhItjqszvppFdgkchuCpobsnvACtpgEIjrhkpaHbJcliDajtJm%2Fmedia_httpwwwiunknown_zzavH.png.thumb.png%22%2C%22originalHeight%22%3A%22211%22%2C%22largeHeight%22%3A%22211%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22211%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile1.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FnpJiyvmButvhItjqszvppFdgkchuCpobsnvACtpgEIjrhkpaHbJcliDajtJm%2Fmedia_httpwwwiunknown_zzavH.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%228%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FnpJiyvmButvhItjqszvppFdgkchuCpobsnvACtpgEIjrhkpaHbJcliDajtJm%2Fmedia_httpwwwiunknown_zzavH.png%22%2C%22width%22%3A%22410%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_28.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-3-integrating-silver%22%7D'>
<img alt="Media_httpwwwiunknown_zzavh" height="211" src="http://getfile1.posterous.com/getfile/files.posterous.com/import-sges/npJiyvmButvhItjqszvppFdgkchuCpobsnvACtpgEIjrhkpaHbJcliDajtJm/media_httpwwwiunknown_zzavH.png.scaled500.png" width="410" />

</div>
 </p>
<p>If you run the app now, you'll be able to add photos to favorites, and look at your favorites. The solution is also in the zip file - look in the mvc_end sub-directory. </p>
<p>It's an exercise left to the reader to improve the UI of the app so that favorite photos are selected when you click on them :) </p>
<p><strong>Summary</strong> </p>
<p>We saw how IronRuby can generate WPF scenes without using any XAML at all. The heavy lifting of doing the type conversions is done behind the scenes by the code in Silverlight.rb. We also saw how straightforward it is to add some Dynamic Silverlight code to an MVC app. It's as simple as adding a post-build step and adding some the DSL files to a standard MVC project.</p>
						
					</div>

						<ul class="social">
							<li class="tweet">
								
              
            
							</li>
							<li class="like">
								<fb:like href="http://iunknown.com/2008/03/dynamic-silverlight-part-3-integrating-silverlight-with-asp-net-mvc.html" layout="button_count"></fb:like> 
							</li>
						</ul>
								
                    
                        
              
                
              
            
                    
				</div>	
				
					
              <aside class="p_responses light">
                
            
          
            
              <nav class='p_response_widget'>
<ul class='clearfix'>
<li class='p_responses_link'><a href="/responses/recent?post_id=37117201" data-posterous-response-count="37117201" data-response-post-id="37117201" title="View responses to this post"><strong>8</strong> responses</a></li>
<li class='p_like_link'><a href="/likes/create?like_type=post&amp;post_id=37117201" class="like_post" data-like-url="/likes/create?like_type=post&amp;post_id=37117201" data-posterous-like-button-for-post-id="37117201" data-posterous-like-text="Like this post" data-posterous-like="true" data-posterous-unlike-text="Unlike this post" data-unlike-url="/likes/delete?like_type=post&amp;post_id=37117201" rel="nofollow" title="Like this post"><div class='p_like_icon'></div><div class='p_unlike_icon' style='display:none'></div><span>Like</span></a></li>
<li class='p_comment_link'><a href="/responses/recent?post_id=37117201" data-comment-post-id="37117201" title="Comment on this post"><div>Comment</div></a></li>
</ul>
</nav>

          		<esi:include src="http://posterous.com/responses?post_id=37117201&user_id=931119" />
          		<div class="posterous_ojs" data-posterous-new-comment-form="true"></div>
            
          
              </aside> 
        		
				
			</li>		
		
		<li class="pagination">
			 
		</li>		
	</ul>
</div>

<div id="footer-container">
	<div id="footer">
	
		<ul class="three-column clearfix">
    		<li class="column clearfix">
				
                
                    
              
            
                
			</li>
			<li class="column">
            
                
            
				<h4>Get Updates</h4>
          <div class="subscribe_to_mysite clearfix">
              
              <div><a href="http://feeds.feedburner.com/LessIsBetter" class="subscribe_link" target="_blank">Subscribe via RSS</a> </div>
              <div class="social-bookmarks">
                  <a href="http://twitter.com/john_lam" class="p_external_site p_twitter" rel="me">Twitter</a>
              </div>
          </div>

			</li>
            <li class="column last">
                
                
              

            </li>
		</ul>
		
		<form class="search-form" method="get">
            <input name="sort" value="" type="hidden" />
            <input name="search" class="search" id="searchbox" value="" type="text" />
            <input class="search_button" value="Search" type="submit" />
        </form>
        
	
	</div>
</div>



  
      <script type="text/javascript">
    	var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    	document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    	</script>
    	<script type="text/javascript">
    	var pageTracker = _gat._getTracker("UA-4054156-1");
    	pageTracker._setDomainName("none");
    	pageTracker._setAllowLinker(true);
    	pageTracker._setAllowHash(false);
    	pageTracker._initData();
    	pageTracker._trackPageview();
    	</script>
    
  
  <!-- Quantcast Tag --> 
  <script type="text/javascript">
    var _qevents = _qevents || [];
    _qevents.push( { qacct:"p-16ewveTurfCCM"} );
  </script>
  <script type="text/javascript" src="//edge.quantserve.com/quant.js" async></script>
  <noscript>
  <div style="display: none;"><img src="https://pixel.quantserve.com/pixel/p-16ewveTurfCCM.gif" height="1" width="1" alt="Quantcast"/></div>
  </noscript>
  <!-- End Quantcast tag -->


	<script type="text/javascript">
		try {
			var pageTrackerUser = _gat._getTracker("UA-12323255-1");
			pageTrackerUser._trackPageview();
		} catch (err) {}
	</script>


<script src="http://www.scribd.com/javascripts/view.js" type="text/javascript"></script>
<script src="/bundles/sites_views.js" type="text/javascript"></script>
<script src="/bundles/sites.js" type="text/javascript"></script>
<script type="text/javascript" src="http://platform.twitter.com/widgets.js" defer></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>

<script>
	var fbid_site_owner = 1;
</script>



<div class="posterous_ojs" data-posterous-twitter-oauth="true" data-posterous-post-ids="%7B%2237117201%22%3A%22http%3A%2F%2Fiunknown.com%2F2008%2F03%2Fdynamic-silverlight-part-3-integrating-silverlight-with-asp-net-mvc.html%22%7D" data-posterous-redirect-url="http://posterous.com/oauth/init_oauth_and_redirect/?ssod=iunknown.com&oauth_provider_type="></div>
<script src="http://www.google.com/recaptcha/api/js/recaptcha_ajax.js" type="text/javascript"></script>
<iframe src="http://posterous.com/analytics_tracker" style="height: 1px; width: 1px; display: none;"></iframe>

      <script type="text/javascript">
        null_fn = function () {};
        var mpmetrics = { track_links: null_fn, track: null_fn, track_funnel: null_fn, register: null_fn, register_once: null_fn, register_funnel: null_fn };
      </script>
    </body>
</html>


