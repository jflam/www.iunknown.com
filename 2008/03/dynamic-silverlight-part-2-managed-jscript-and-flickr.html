<!DOCTYPE html>
<html xmlns:fb="http://www.facebook.com/2008/fbml" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
      <meta http-equiv="X-UA-Compatible" content="chrome=1" />
      <meta name="width" content="500" />
      <meta name="generator" content="Posterous" />
      <script src="/javascripts/vendor/modernizr.custom.09241.js?1367517938" type="text/javascript"></script>
      <!--[if lt IE 9]>
        <script src="/javascripts/innershiv.js?1367517938" type="text/javascript"></script>
      <![endif]-->
      <link href="/bundles/posts.css" media="screen" rel="stylesheet" type="text/css" />
      <!--[if lt IE 9]>
        <link href="/bundles/ie.css" media="screen" rel="stylesheet" type="text/css" />
      <![endif]-->
      <link rel="alternate" type="application/rss+xml" href="http://feeds.feedburner.com/LessIsBetter"/>
      <meta name="medium" content="image" /><link rel="image_src" href="http://getfile3.posterous.com/getfile/files.posterous.com/import-sges/mFwGBBkGmmoCFkirfaeaFgewrdqEDrumGfDBFnEJgyIIqfzHCqrfnJnarusc/media_httpwwwiunknown_guAad.png.thumb100.png" />
      <script type="text/javascript">
//<![CDATA[
window._token = 'K5qluXl5HOIU9bWdq9oJYrEuVokj7nLG7aYeXTLdHqg='; beforeload = (new Date()).getTime(); pagetype = 'show';
//]]>
</script>
      <script src="/bundles/sites_initialization.js" type="text/javascript"></script>
      <script type="text/javascript">
//<![CDATA[
var $j = jQuery.noConflict();
//]]>
</script>
      <script type="text/javascript">
//<![CDATA[
var POSTEROUS_HOSTNAME = 'posterous.com'
//]]>
</script>
      <script data-post-data="%7B%22post_id%22%3A37117179%2C%22post_is_private%22%3Afalse%2C%22user_id%22%3A931119%2C%22post_url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D" data-posterous-deferred-content-url="http://iunknown.com/posts/deferred_content.jsonp" data-posts-data="%5B%7B%22post_id%22%3A37117179%2C%22post_is_private%22%3Afalse%2C%22user_id%22%3A931119%2C%22post_url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D%5D" id="posterous_initialization_script" src="/javascripts/initialize.js?1367517938" type="text/javascript"></script>
      
    <script src="/bundles/tags.js" type="text/javascript"></script><link rel="canonical" href="http://iunknown.com/2008/03/dynamic-silverlight-part-2-managed-jscript-and-flickr.html" />
<link href="/themes/light-matter/post-style.css" rel="stylesheet" type="text/css" />
<!--[if lte IE 8]>
	<link href="/themes/light-matter/ie-style.css" rel="stylesheet" type="text/css" />
<![endif]-->
<title>Dynamic Silverlight Part 2: Managed JScript and flickr - John Lam on Software</title>
</head>
<body><div class="posterous_site_data" data-post-id="37117179" data-posterous-hostname="posterous.com" data-show-type="post" data-site-id="2278433" data-site-is-private="false" data-site-location="false" data-site-type="posterous" data-slug-id="dynamic-silverlight-part-2-managed-jscript-an" data-user-id="931119"></div><div class="posterous_ojs" data-posterous-admin-box="true"></div><div class="posterousPrivateBox">
	
	
</div>
      <div id="fb-root"></div>
        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId  : '6694405826',
              status : true, // check login status
              cookie : true, // enable cookies to allow the server to access the session
              xfbml  : true, // parse XFBML
              oauth  : true

            });
            
          };

          (function() {
            var e = document.createElement('script');
            e.type = 'text/javascript';
            e.src = 'http://connect.facebook.net/en_US/all.js';
            e.async = true;
            document.getElementById('fb-root').appendChild(e);
          }());
        </script>
    
  <div id="pbar">
        				<noscript>
  <div id="posterousbar_nojs">
    <a href="http://posterous.com/"><img src="/images/header/yellow.png" alt="Posterous" /></a>
  </div>
</noscript>
              </div>
<div id="header-container">
	<div id="header">
		
		<h1 class="site-name"><a href="http://iunknown.com">John Lam on Software</a></h1>
		<p class="site-description"></p>
	</div>
</div>

                
	<div id="pages-container">
		<div id="pages">
            <ul>
            	
                
                    <li><a href="http://about.me/jlam" title="About me" class="">About me</a></li>
                
              
            </ul>
		</div>
	</div>

              
<div id="container">
	<ul class="post-list clearfix">
		
			<li class="post-item clearfix" id="post_37117179">
				<div class="title-block">
					
						<h3 class="title" id="posttitle_37117179"><a href="http://iunknown.com/2008/03/dynamic-silverlight-part-2-managed-jscript-and-flickr.html">Dynamic Silverlight Part 2: Managed JScript and flickr</a></h3>
					
					
						<ul class="meta">
							<li class="date">7 Mar 2008</li>
							<li class="comments"><a href="http://iunknown.com/2008/03/dynamic-silverlight-part-2-managed-jscript-and-flickr.html" id="comment_link_37117179">13 Responses</a></li>
							<li class="views"><div class="posterous_ojs" data-posterous-view-count="true" data-posterous-post-id="37117179"></div>&nbsp;views</li>
                            
                
              
						</ul>
					
					
					<div class="editbox clearfix" id="editunit_37117179">
						
        				
                  <ul class="mini_commands posterous_edit_box posterous_edit_box_hidden" data-posterous-edit-box="true" data-posterous-post-id="37117179">
	
	<li><a href="http://posterous.com/posts/edit/37117179">Edit</a></li>
  <li><a href="/posts/destroy/37117179" onclick="if (confirm('Are you sure you want to delete this post?')) { var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var m = document.createElement('input'); m.setAttribute('type', 'hidden'); m.setAttribute('name', '_method'); m.setAttribute('value', 'delete'); f.appendChild(m);var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', 'K5qluXl5HOIU9bWdq9oJYrEuVokj7nLG7aYeXTLdHqg='); f.appendChild(s);f.submit(); };return false;">Delete</a></li>
	<li><a href="http://posterous.com/posts/37117179/tags/edit_multiple" data-post-id="37117179" data-posterous-modal="true" data-posterous-tag-form="true">Tags</a></li>
	
	  <li><a href="//posterous.com/autopost/crosspost?post_id=37117179" data-posterous-modal="true">Autopost</a>
	
</ul>

                
                
					</div>
					
				</div>
				<div class="post-content" id="postbox_37117179">
					<div class="copy">
						<p>In <a href="http://www.iunknown.com/2008/03/dynamic-silverl.html">part 1 of this series</a>, we looked at how to build a simple Hello, World application using Dynamic Silverlight and IronRuby. In this part we're going to build a more sophisticated application using Managed JScript, IronPython, Silverlight 2, and the <a href="http://www.flickr.com/services/api/">flickr API</a>. It lets you find the most interesting 5 photos for your search term using the flickr api:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile2.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FmFwGBBkGmmoCFkirfaeaFgewrdqEDrumGfDBFnEJgyIIqfzHCqrfnJnarusc%2Fmedia_httpwwwiunknown_guAad.png.scaled1000.png%22%2C%22originalWidth%22%3A%22500%22%2C%22largeWidth%22%3A%22500%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FmFwGBBkGmmoCFkirfaeaFgewrdqEDrumGfDBFnEJgyIIqfzHCqrfnJnarusc%2Fmedia_httpwwwiunknown_guAad.png.thumb.png%22%2C%22originalHeight%22%3A%22291%22%2C%22largeHeight%22%3A%22291%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22291%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile1.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FmFwGBBkGmmoCFkirfaeaFgewrdqEDrumGfDBFnEJgyIIqfzHCqrfnJnarusc%2Fmedia_httpwwwiunknown_guAad.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%22129%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FmFwGBBkGmmoCFkirfaeaFgewrdqEDrumGfDBFnEJgyIIqfzHCqrfnJnarusc%2Fmedia_httpwwwiunknown_guAad.png%22%2C%22width%22%3A%22500%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2FApp.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_guaad" height="291" src="http://getfile1.posterous.com/getfile/files.posterous.com/import-sges/mFwGBBkGmmoCFkirfaeaFgewrdqEDrumGfDBFnEJgyIIqfzHCqrfnJnarusc/media_httpwwwiunknown_guAad.png.scaled500.png" width="500" />

</div>
 </p>
<p>Let's start by walking through an existing JScript app that knows how to display flickr photos on the screen. Download the source code for this tutorial from here: </p>
<p><a href="http://www.iunknown.com/files/demos.zip">Download demos.zip</a></p>
<p>Open a command prompt, navigate to the demos\flickr_start directory and startup the application using Chiron:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FykoICuECyyHlGBExwvvlnHeEhkfwwIwbjgutdHBHzzvirbHyEAtakxxziIjh%2Fmedia_httpwwwiunknown_kpBGE.png.scaled1000.png%22%2C%22originalWidth%22%3A%22500%22%2C%22largeWidth%22%3A%22500%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile8.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FykoICuECyyHlGBExwvvlnHeEhkfwwIwbjgutdHBHzzvirbHyEAtakxxziIjh%2Fmedia_httpwwwiunknown_kpBGE.png.thumb.png%22%2C%22originalHeight%22%3A%22203%22%2C%22largeHeight%22%3A%22203%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22203%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile2.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FykoICuECyyHlGBExwvvlnHeEhkfwwIwbjgutdHBHzzvirbHyEAtakxxziIjh%2Fmedia_httpwwwiunknown_kpBGE.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2284%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile1.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FykoICuECyyHlGBExwvvlnHeEhkfwwIwbjgutdHBHzzvirbHyEAtakxxziIjh%2Fmedia_httpwwwiunknown_kpBGE.png%22%2C%22width%22%3A%22500%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fchiron_start.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_kpbge" height="203" src="http://getfile2.posterous.com/getfile/files.posterous.com/import-sges/ykoICuECyyHlGBExwvvlnHeEhkfwwIwbjgutdHBHzzvirbHyEAtakxxziIjh/media_httpwwwiunknown_kpBGE.png.scaled500.png" width="500" />

</div>
 </p>
<p>Let's look inside of app.xap, which was generated by Chiron:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FEiopGwDlGaEsdyjtHpcirxvCockvGzaGDFzgFpJndgFxzlbdsoBghfkatsed%2Fmedia_httpwwwiunknown_GmwEA.png%22%2C%22originalWidth%22%3A%22422%22%2C%22largeWidth%22%3A%22422%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile8.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FEiopGwDlGaEsdyjtHpcirxvCockvGzaGDFzgFpJndgFxzlbdsoBghfkatsed%2Fmedia_httpwwwiunknown_GmwEA.png.thumb.png%22%2C%22originalHeight%22%3A%22205%22%2C%22largeHeight%22%3A%22205%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22205%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile0.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FEiopGwDlGaEsdyjtHpcirxvCockvGzaGDFzgFpJndgFxzlbdsoBghfkatsed%2Fmedia_httpwwwiunknown_GmwEA.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2214%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FEiopGwDlGaEsdyjtHpcirxvCockvGzaGDFzgFpJndgFxzlbdsoBghfkatsed%2Fmedia_httpwwwiunknown_GmwEA.png%22%2C%22width%22%3A%22422%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fapp.xap.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_gmwea" height="205" src="http://getfile0.posterous.com/getfile/files.posterous.com/import-sges/EiopGwDlGaEsdyjtHpcirxvCockvGzaGDFzgFpJndgFxzlbdsoBghfkatsed/media_httpwwwiunknown_GmwEA.png.scaled500.png" width="422" />

</div>
 </p>
<p>You'll see that the assemblies for managed JScript, and Dynamic Silverlight (DSL) are in the xap, along with some Silverlight controls assemblies from the Silverlight SDK. The complete list of assemblies can be found in AppManifest.xaml:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FGrmgppgHAIzFyrJdbtxflattpsvqhbwcjktilJfjudrsGlBtxenviEHdCyCC%2Fmedia_httpwwwiunknown_lCmBg.png.scaled1000.png%22%2C%22originalWidth%22%3A%22500%22%2C%22largeWidth%22%3A%22500%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FGrmgppgHAIzFyrJdbtxflattpsvqhbwcjktilJfjudrsGlBtxenviEHdCyCC%2Fmedia_httpwwwiunknown_lCmBg.png.thumb.png%22%2C%22originalHeight%22%3A%22353%22%2C%22largeHeight%22%3A%22353%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22353%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile2.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FGrmgppgHAIzFyrJdbtxflattpsvqhbwcjktilJfjudrsGlBtxenviEHdCyCC%2Fmedia_httpwwwiunknown_lCmBg.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%22102%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile0.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FGrmgppgHAIzFyrJdbtxflattpsvqhbwcjktilJfjudrsGlBtxenviEHdCyCC%2Fmedia_httpwwwiunknown_lCmBg.png%22%2C%22width%22%3A%22500%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_1.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_lcmbg" height="353" src="http://getfile2.posterous.com/getfile/files.posterous.com/import-sges/GrmgppgHAIzFyrJdbtxflattpsvqhbwcjktilJfjudrsGlBtxenviEHdCyCC/media_httpwwwiunknown_lCmBg.png.scaled500.png" width="500" />

</div>
 </p>
<p>Notice that there is also an assembly called contract.dll - more on this assembly later.</p>
<p>This is a Managed JScript application, and execution begins in app.js.</p>
<p>In Silverlight 1.0 applications, you modified an existing scene by injecting XAML strings, much like how you would use innerHTML in the HTML DOM. In the next part of this tutorial, I will show you how you can do the same thing using just code (and it turns out to be considerably harder than just injecting strings).</p>
<p>The initial scene is defined by app.xaml:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FhBFJbzppaFrJowDaoudGFIqnfpkGdowhIkExjpdqpxpHfljGIyykvIhqvfvp%2Fmedia_httpwwwiunknown_mtuHz.png.scaled1000.png%22%2C%22originalWidth%22%3A%22500%22%2C%22largeWidth%22%3A%22500%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FhBFJbzppaFrJowDaoudGFIqnfpkGdowhIkExjpdqpxpHfljGIyykvIhqvfvp%2Fmedia_httpwwwiunknown_mtuHz.png.thumb.png%22%2C%22originalHeight%22%3A%22194%22%2C%22largeHeight%22%3A%22194%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22194%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FhBFJbzppaFrJowDaoudGFIqnfpkGdowhIkExjpdqpxpHfljGIyykvIhqvfvp%2Fmedia_httpwwwiunknown_mtuHz.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2267%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile1.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FhBFJbzppaFrJowDaoudGFIqnfpkGdowhIkExjpdqpxpHfljGIyykvIhqvfvp%2Fmedia_httpwwwiunknown_mtuHz.png%22%2C%22width%22%3A%22500%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_2.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_mtuhz" height="194" src="http://getfile5.posterous.com/getfile/files.posterous.com/import-sges/hBFJbzppaFrJowDaoudGFIqnfpkGdowhIkExjpdqpxpHfljGIyykvIhqvfvp/media_httpwwwiunknown_mtuHz.png.scaled500.png" width="500" />

</div>
 </p>
<p>This file shows off some cool new Silverlight 2 features. First, notice the two XML namespaces. The c and e namespace prefixes are mapped to types in the System.Windows.Controls, and System.Windows.Controls.Extended assemblies. These assemblies contain our new Silverlight Controls, which are available as part of the Silverlight SDK. </p>
<p>I'm also really pleased to see that <a href="http://blogs.msdn.com/sburke/archive/2008/03/05/silverlight-2-beta-1-controls-available-including-source-and-unit-tests.aspx">we're releasing the source code for these controls</a> under the <a href="http://www.microsoft.com/resources/sharedsource/licensingbasics/limitedpubliclicense.mspx">Microsoft Limited Public License</a>, as well as the test harness that Shawn's team uses to test these controls. Awesome. We're moving in the right direction folks, and <em>we're not done yet</em>.</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile0.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsannGuqAzchakrJirphtxaoEvynyFkxyAsuJjqiCGuJHzclggoDvGjfyjncc%2Fmedia_httpblogsmsdnco_Gixwl.png.scaled1000.png%22%2C%22originalWidth%22%3A%22640%22%2C%22largeWidth%22%3A%22640%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile1.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsannGuqAzchakrJirphtxaoEvynyFkxyAsuJjqiCGuJHzclggoDvGjfyjncc%2Fmedia_httpblogsmsdnco_Gixwl.png.thumb.png%22%2C%22originalHeight%22%3A%22453%22%2C%22largeHeight%22%3A%22453%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22354%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile4.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsannGuqAzchakrJirphtxaoEvynyFkxyAsuJjqiCGuJHzclggoDvGjfyjncc%2Fmedia_httpblogsmsdnco_Gixwl.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%22134%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile4.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FsannGuqAzchakrJirphtxaoEvynyFkxyAsuJjqiCGuJHzclggoDvGjfyjncc%2Fmedia_httpblogsmsdnco_Gixwl.png%22%2C%22width%22%3A%22500%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3Anull%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<a href="http://getfile0.posterous.com/getfile/files.posterous.com/import-sges/sannGuqAzchakrJirphtxaoEvynyFkxyAsuJjqiCGuJHzclggoDvGjfyjncc/media_httpblogsmsdnco_Gixwl.png.scaled1000.png"><img alt="Media_httpblogsmsdnco_gixwl" height="354" src="http://getfile4.posterous.com/getfile/files.posterous.com/import-sges/sannGuqAzchakrJirphtxaoEvynyFkxyAsuJjqiCGuJHzclggoDvGjfyjncc/media_httpblogsmsdnco_Gixwl.png.scaled500.png" width="500" /></a>

</div>
</p>
<p>As you can see, we're using two simple controls: the WatermarkedTextBox (which makes it trivial to create a <em>Search</em> textbox a'la the search widget in all modern web browser), and the venerable Button.</p>
<p>Let's look at the code in app.js to see what happens when you click on the Search button:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FHfxFnhxxgccoDAlEctbxedIyurFCmgJanrbinaJhbIdhAfzCxwausuklAvbr%2Fmedia_httpwwwiunknown_qEvDy.png%22%2C%22originalWidth%22%3A%22398%22%2C%22largeWidth%22%3A%22398%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile2.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FHfxFnhxxgccoDAlEctbxedIyurFCmgJanrbinaJhbIdhAfzCxwausuklAvbr%2Fmedia_httpwwwiunknown_qEvDy.png.thumb.png%22%2C%22originalHeight%22%3A%22243%22%2C%22largeHeight%22%3A%22243%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22243%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FHfxFnhxxgccoDAlEctbxedIyurFCmgJanrbinaJhbIdhAfzCxwausuklAvbr%2Fmedia_httpwwwiunknown_qEvDy.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2210%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FHfxFnhxxgccoDAlEctbxedIyurFCmgJanrbinaJhbIdhAfzCxwausuklAvbr%2Fmedia_httpwwwiunknown_qEvDy.png%22%2C%22width%22%3A%22398%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_3.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_qevdy" height="243" src="http://getfile5.posterous.com/getfile/files.posterous.com/import-sges/HfxFnhxxgccoDAlEctbxedIyurFCmgJanrbinaJhbIdhAfzCxwausuklAvbr/media_httpwwwiunknown_qEvDy.png.scaled500.png" width="398" />

</div>
 </p>
<p>We bind a JScript anonymous method to the search_button control's click event using a familiar (to C# developers) delegate-style binding syntax. Notice how we're also using a JScript closure to bind to the App instance and the application's root visual. </p>
<p>There's a bit of magic going on in scene.search_text.Text. Here, we're using a DLR feature called <em>member injectors</em>, to dynamically inject attributes onto the scene object. Next, let's look at how we generate our flickr query:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FHFpwqfEtvvvFjzAvvgckyjHqsyrIgBJoptsxDikIBamDAlnnwbIsIAbBmzgj%2Fmedia_httpwwwiunknown_hpCbE.png%22%2C%22originalWidth%22%3A%22411%22%2C%22largeWidth%22%3A%22411%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile1.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FHFpwqfEtvvvFjzAvvgckyjHqsyrIgBJoptsxDikIBamDAlnnwbIsIAbBmzgj%2Fmedia_httpwwwiunknown_hpCbE.png.thumb.png%22%2C%22originalHeight%22%3A%22224%22%2C%22largeHeight%22%3A%22224%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22224%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile4.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FHFpwqfEtvvvFjzAvvgckyjHqsyrIgBJoptsxDikIBamDAlnnwbIsIAbBmzgj%2Fmedia_httpwwwiunknown_hpCbE.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2210%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FHFpwqfEtvvvFjzAvvgckyjHqsyrIgBJoptsxDikIBamDAlnnwbIsIAbBmzgj%2Fmedia_httpwwwiunknown_hpCbE.png%22%2C%22width%22%3A%22411%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_4.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_hpcbe" height="224" src="http://getfile4.posterous.com/getfile/files.posterous.com/import-sges/HFpwqfEtvvvFjzAvvgckyjHqsyrIgBJoptsxDikIBamDAlnnwbIsIAbBmzgj/media_httpwwwiunknown_hpCbE.png.scaled500.png" width="411" />

</div>
 </p>
<p>Here, we initiate an asynchronous REST all to flickr. QUERY contains a scary flickr REST string that we'll append our search term to. Notice how we again use an anonymous JScript method which functions as a closure to perform an action when the download is complete.</p>
<p>The OpenReadAsync method returns a .NET Stream object which we can pass to Silverlight's built-in JSON serializer. This is where the fun begins :)</p>
<p>The original version of this application was written in IronRuby, and I didn't have a working JSON deserializer handy. While Managed JScript can certainly use any of the widely available JavaScript JSON serialization libraries, I didn't have this luxury in IronRuby. Instead, I used the built-in Silverlight JSON serializer. Unfortunately, this API is designed to be used from statically typed languages. Once we finish implementing the Ruby language, we'll be able to use an off-the-shelf Ruby JSON serialization library. For the time being, however, let me describe the hack that lets you use the Silverlight JSON serializer from a dynamic language.</p>
<p>The inject_photo_list method creates an instance of the JSON serializer, and passes the QueryResults CLR type to its constructor. It then dots into QueryResults to retrieve the properties that we need to retrieve images from flickr.</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FocjqqarxtufwJpDwAhdrCgcItdCkvIlsmpnFqgHvgFjBdEwyCfzmbjIICsrz%2Fmedia_httpwwwiunknown_jsDJE.png%22%2C%22originalWidth%22%3A%22477%22%2C%22largeWidth%22%3A%22477%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FocjqqarxtufwJpDwAhdrCgcItdCkvIlsmpnFqgHvgFjBdEwyCfzmbjIICsrz%2Fmedia_httpwwwiunknown_jsDJE.png.thumb.png%22%2C%22originalHeight%22%3A%22304%22%2C%22largeHeight%22%3A%22304%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22304%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FocjqqarxtufwJpDwAhdrCgcItdCkvIlsmpnFqgHvgFjBdEwyCfzmbjIICsrz%2Fmedia_httpwwwiunknown_jsDJE.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2214%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FocjqqarxtufwJpDwAhdrCgcItdCkvIlsmpnFqgHvgFjBdEwyCfzmbjIICsrz%2Fmedia_httpwwwiunknown_jsDJE.png%22%2C%22width%22%3A%22477%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_5.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_jsdje" height="304" src="http://getfile9.posterous.com/getfile/files.posterous.com/import-sges/ocjqqarxtufwJpDwAhdrCgcItdCkvIlsmpnFqgHvgFjBdEwyCfzmbjIICsrz/media_httpwwwiunknown_jsDJE.png.scaled500.png" width="477" />

</div>
 </p>
<p>But where did QueryResults come from? At the top of the file, you'll see this call:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FEHdunyDbJhjrrqybmjEhsusagtJgCnocupxivmHfzfgwmamCIowCuthGJiBk%2Fmedia_httpwwwiunknown_oGCAz.png%22%2C%22originalWidth%22%3A%22199%22%2C%22largeWidth%22%3A%22199%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FEHdunyDbJhjrrqybmjEhsusagtJgCnocupxivmHfzfgwmamCIowCuthGJiBk%2Fmedia_httpwwwiunknown_oGCAz.png.thumb.png%22%2C%22originalHeight%22%3A%2232%22%2C%22largeHeight%22%3A%2232%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%2232%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile0.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FEHdunyDbJhjrrqybmjEhsusagtJgCnocupxivmHfzfgwmamCIowCuthGJiBk%2Fmedia_httpwwwiunknown_oGCAz.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%221%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FEHdunyDbJhjrrqybmjEhsusagtJgCnocupxivmHfzfgwmamCIowCuthGJiBk%2Fmedia_httpwwwiunknown_oGCAz.png%22%2C%22width%22%3A%22199%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_6.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_ogcaz" height="32" src="http://getfile0.posterous.com/getfile/files.posterous.com/import-sges/EHdunyDbJhjrrqybmjEhsusagtJgCnocupxivmHfzfgwmamCIowCuthGJiBk/media_httpwwwiunknown_oGCAz.png.scaled500.png" width="199" />

</div>
 </p>
<p>Recall that we had a reference to contract.dll in AppManifest.xaml. This assembly contains the static definition of the JSON result set from flickr. The source for contract.cs can be found in lib\contract.cs. You'll also find a build script that shows how to compile an assembly for Silverlight, assuming that the paths to the Silverlight SDK line up.</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile8.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FuvCdanyapzdcGeeDIGzgrFyBmqFFuCFIspnHjwEDxemzpnamnGfaAomgHaGz%2Fmedia_httpwwwiunknown_JlGau.png.scaled1000.png%22%2C%22originalWidth%22%3A%22449%22%2C%22largeWidth%22%3A%22449%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile2.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FuvCdanyapzdcGeeDIGzgrFyBmqFFuCFIspnHjwEDxemzpnamnGfaAomgHaGz%2Fmedia_httpwwwiunknown_JlGau.png.thumb.png%22%2C%22originalHeight%22%3A%22600%22%2C%22largeHeight%22%3A%22600%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22600%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile4.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FuvCdanyapzdcGeeDIGzgrFyBmqFFuCFIspnHjwEDxemzpnamnGfaAomgHaGz%2Fmedia_httpwwwiunknown_JlGau.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2241%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FuvCdanyapzdcGeeDIGzgrFyBmqFFuCFIspnHjwEDxemzpnamnGfaAomgHaGz%2Fmedia_httpwwwiunknown_JlGau.png%22%2C%22width%22%3A%22449%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_7.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_jlgau" height="600" src="http://getfile4.posterous.com/getfile/files.posterous.com/import-sges/uvCdanyapzdcGeeDIGzgrFyBmqFFuCFIspnHjwEDxemzpnamnGfaAomgHaGz/media_httpwwwiunknown_JlGau.png.scaled500.png" width="449" />

</div>
 </p>
<p>The get_photo_url method generates the url that we'll use to get each photo, and you can see how easily we can consume the C# type definitions from Managed JScript:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FfeAdIbbhiettknECkopfawekvmGCCpmluCHjcdoCxDtGbEFlnqccmpGBliss%2Fmedia_httpwwwiunknown_oCFyj.png%22%2C%22originalWidth%22%3A%22438%22%2C%22largeWidth%22%3A%22438%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FfeAdIbbhiettknECkopfawekvmGCCpmluCHjcdoCxDtGbEFlnqccmpGBliss%2Fmedia_httpwwwiunknown_oCFyj.png.thumb.png%22%2C%22originalHeight%22%3A%2286%22%2C%22largeHeight%22%3A%2286%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%2286%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile4.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FfeAdIbbhiettknECkopfawekvmGCCpmluCHjcdoCxDtGbEFlnqccmpGBliss%2Fmedia_httpwwwiunknown_oCFyj.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%225%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FfeAdIbbhiettknECkopfawekvmGCCpmluCHjcdoCxDtGbEFlnqccmpGBliss%2Fmedia_httpwwwiunknown_oCFyj.png%22%2C%22width%22%3A%22438%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_8.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_ocfyj" height="86" src="http://getfile4.posterous.com/getfile/files.posterous.com/import-sges/feAdIbbhiettknECkopfawekvmGCCpmluCHjcdoCxDtGbEFlnqccmpGBliss/media_httpwwwiunknown_oCFyj.png.scaled500.png" width="438" />

</div>
 </p>
<p>Finally, we generate the XAML for the photo in the BouncePhoto function:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FducymhhqjDkbahjqCGqHemuIcdxkAACDGkHCEbqBArJwvHiFhJuJidjwylIx%2Fmedia_httpwwwiunknown_dgjEm.png%22%2C%22originalWidth%22%3A%22492%22%2C%22largeWidth%22%3A%22492%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FducymhhqjDkbahjqCGqHemuIcdxkAACDGkHCEbqBArJwvHiFhJuJidjwylIx%2Fmedia_httpwwwiunknown_dgjEm.png.thumb.png%22%2C%22originalHeight%22%3A%22301%22%2C%22largeHeight%22%3A%22301%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22301%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile1.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FducymhhqjDkbahjqCGqHemuIcdxkAACDGkHCEbqBArJwvHiFhJuJidjwylIx%2Fmedia_httpwwwiunknown_dgjEm.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2216%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FducymhhqjDkbahjqCGqHemuIcdxkAACDGkHCEbqBArJwvHiFhJuJidjwylIx%2Fmedia_httpwwwiunknown_dgjEm.png%22%2C%22width%22%3A%22492%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_9.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_dgjem" height="301" src="http://getfile1.posterous.com/getfile/files.posterous.com/import-sges/ducymhhqjDkbahjqCGqHemuIcdxkAACDGkHCEbqBArJwvHiFhJuJidjwylIx/media_httpwwwiunknown_dgjEm.png.scaled500.png" width="492" />

</div>
 </p>
<p>Can anyone spot the grotesque hack in this example? This hack will be fixed in the next part of the tutorial. For the time being, however, it works :)</p>
<p><strong>Mixing in a little Norvig</strong></p>
<p><strong>If you look carefully at the screenshot of the completed app, you'll notice that the app suggested another spelling for 'howse'. That suggestion was courtesy of Peter Norvig's awesome <a href="http://norvig.com/spell-correct.html">naive spell checker</a>. Here it is in its entirety (just 21 lines of Python 2.5 code):</strong></p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile9.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FpfceeuBkxzfnIucrGygmeoGkyckvwfxBuhnhtEctyegCooehBiaavzIqujHA%2Fmedia_httpwwwiunknown_HgaIp.png.scaled1000.png%22%2C%22originalWidth%22%3A%22500%22%2C%22largeWidth%22%3A%22500%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile2.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FpfceeuBkxzfnIucrGygmeoGkyckvwfxBuhnhtEctyegCooehBiaavzIqujHA%2Fmedia_httpwwwiunknown_HgaIp.png.thumb.png%22%2C%22originalHeight%22%3A%22371%22%2C%22largeHeight%22%3A%22371%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22371%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FpfceeuBkxzfnIucrGygmeoGkyckvwfxBuhnhtEctyegCooehBiaavzIqujHA%2Fmedia_httpwwwiunknown_HgaIp.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2288%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FpfceeuBkxzfnIucrGygmeoGkyckvwfxBuhnhtEctyegCooehBiaavzIqujHA%2Fmedia_httpwwwiunknown_HgaIp.png%22%2C%22width%22%3A%22500%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_10.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_hgaip" height="371" src="http://getfile5.posterous.com/getfile/files.posterous.com/import-sges/pfceeuBkxzfnIucrGygmeoGkyckvwfxBuhnhtEctyegCooehBiaavzIqujHA/media_httpwwwiunknown_HgaIp.png.scaled500.png" width="500" />

</div>
 Wouldn't it be awesome if we could just <strong><em>use </em>this code from our Managed JScript application? Let's take a look at what we need to do to make it happen.</strong></p>
<p><strong>First, we must add a reference to the IronPython assemblies to our AppManifest:</strong></p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile8.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FlDabkiokFEeExwDktyvvchfbzdrAeaourgIHvpDioFwnBlGlmfIvpdvJbedC%2Fmedia_httpwwwiunknown_FsiBi.png%22%2C%22originalWidth%22%3A%22404%22%2C%22largeWidth%22%3A%22404%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile4.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FlDabkiokFEeExwDktyvvchfbzdrAeaourgIHvpDioFwnBlGlmfIvpdvJbedC%2Fmedia_httpwwwiunknown_FsiBi.png.thumb.png%22%2C%22originalHeight%22%3A%2248%22%2C%22largeHeight%22%3A%2248%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%2248%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FlDabkiokFEeExwDktyvvchfbzdrAeaourgIHvpDioFwnBlGlmfIvpdvJbedC%2Fmedia_httpwwwiunknown_FsiBi.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%222%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile8.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FlDabkiokFEeExwDktyvvchfbzdrAeaourgIHvpDioFwnBlGlmfIvpdvJbedC%2Fmedia_httpwwwiunknown_FsiBi.png%22%2C%22width%22%3A%22404%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_11.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_fsibi" height="48" src="http://getfile6.posterous.com/getfile/files.posterous.com/import-sges/lDabkiokFEeExwDktyvvchfbzdrAeaourgIHvpDioFwnBlGlmfIvpdvJbedC/media_httpwwwiunknown_FsiBi.png.scaled500.png" width="404" />

</div>
 </p>
<p>Next, we'll need to download Peter's code, as well as <a href="http://norvig.com/big.txt">big.txt</a>, which is a 6MB 'training file' containing about a million words that is used to train the spelling corrector. Both of these files will be added to our app directory, which means that they will be downloaded within the XAP file:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FxvtcnGextCyJpiuhlnoavJJsEAulsAzlHjIbEdctqgijeyIdruFqhGlsaxhp%2Fmedia_httpwwwiunknown_BGiFk.png%22%2C%22originalWidth%22%3A%22493%22%2C%22largeWidth%22%3A%22493%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile0.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FxvtcnGextCyJpiuhlnoavJJsEAulsAzlHjIbEdctqgijeyIdruFqhGlsaxhp%2Fmedia_httpwwwiunknown_BGiFk.png.thumb.png%22%2C%22originalHeight%22%3A%22293%22%2C%22largeHeight%22%3A%22293%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22293%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile2.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FxvtcnGextCyJpiuhlnoavJJsEAulsAzlHjIbEdctqgijeyIdruFqhGlsaxhp%2Fmedia_httpwwwiunknown_BGiFk.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2226%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile6.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FxvtcnGextCyJpiuhlnoavJJsEAulsAzlHjIbEdctqgijeyIdruFqhGlsaxhp%2Fmedia_httpwwwiunknown_BGiFk.png%22%2C%22width%22%3A%22493%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_12.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_bgifk" height="293" src="http://getfile2.posterous.com/getfile/files.posterous.com/import-sges/xvtcnGextCyJpiuhlnoavJJsEAulsAzlHjIbEdctqgijeyIdruFqhGlsaxhp/media_httpwwwiunknown_BGiFk.png.scaled500.png" width="493" />

</div>
 </p>
<p>You might be wondering why we didn't just download big.txt from the web. I chose not to because I didn't want to modify Peter's code at all. Files that are downloaded as part of the XAP can be read using the standard IronPython file I/O libraries.</p>
<p>Next, let's look at what we need to do to access IronPython code from Managed JScript:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile8.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FbCJduwymwcrvvlJtihzHdxcvuqCCauFyxxzdzIouDCuCrrgczfHIIaDuCrrj%2Fmedia_httpwwwiunknown_eaHmG.png%22%2C%22originalWidth%22%3A%22388%22%2C%22largeWidth%22%3A%22388%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FbCJduwymwcrvvlJtihzHdxcvuqCCauFyxxzdzIouDCuCrrgczfHIIaDuCrrj%2Fmedia_httpwwwiunknown_eaHmG.png.thumb.png%22%2C%22originalHeight%22%3A%2296%22%2C%22largeHeight%22%3A%2296%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%2296%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile5.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FbCJduwymwcrvvlJtihzHdxcvuqCCauFyxxzdzIouDCuCrrgczfHIIaDuCrrj%2Fmedia_httpwwwiunknown_eaHmG.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%224%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile8.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FbCJduwymwcrvvlJtihzHdxcvuqCCauFyxxzdzIouDCuCrrgczfHIIaDuCrrj%2Fmedia_httpwwwiunknown_eaHmG.png%22%2C%22width%22%3A%22388%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_13.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_eahmg" height="96" src="http://getfile5.posterous.com/getfile/files.posterous.com/import-sges/bCJduwymwcrvvlJtihzHdxcvuqCCauFyxxzdzIouDCuCrrgczfHIIaDuCrrj/media_httpwwwiunknown_eaHmG.png.scaled500.png" width="388" />

</div>
 </p>
<p>This code loads the managed spell.py module and stores a reference to the correct method. That method is invoked in the spell_check method, which also generates the UI for the suggestion:</p>
<p><div class='posterousGalleryMainDiv p_embed p_image_embed' data-posterous-file-list='%5B%7B%22large%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FnhcpIDkgklwDtjgerCgBrAlxkvooahxwfCqFbBddviEjzIaAzitxIqfwIutH%2Fmedia_httpwwwiunknown_eyygH.png.scaled1000.png%22%2C%22originalWidth%22%3A%22463%22%2C%22largeWidth%22%3A%22463%22%2C%22thumb%22%3A%22http%3A%2F%2Fgetfile3.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FnhcpIDkgklwDtjgerCgBrAlxkvooahxwfCqFbBddviEjzIaAzitxIqfwIutH%2Fmedia_httpwwwiunknown_eyygH.png.thumb.png%22%2C%22originalHeight%22%3A%22505%22%2C%22largeHeight%22%3A%22505%22%2C%22thumbWidth%22%3A%2236%22%2C%22height%22%3A%22505%22%2C%22main%22%3A%22http%3A%2F%2Fgetfile4.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FnhcpIDkgklwDtjgerCgBrAlxkvooahxwfCqFbBddviEjzIaAzitxIqfwIutH%2Fmedia_httpwwwiunknown_eyygH.png.scaled500.png%22%2C%22thumbHeight%22%3A%2236%22%2C%22originalSize%22%3A%2224%22%2C%22original%22%3A%22http%3A%2F%2Fgetfile7.posterous.com%2Fgetfile%2Ffiles.posterous.com%2Fimport-sges%2FnhcpIDkgklwDtjgerCgBrAlxkvooahxwfCqFbBddviEjzIaAzitxIqfwIutH%2Fmedia_httpwwwiunknown_eyygH.png%22%2C%22width%22%3A%22463%22%7D%5D' data-posterous-image-gallery-initialized='false' data-posterous-image-gallery='true' data-posterous-options='%7B%22zipFile%22%3Anull%2C%22zipFileSize%22%3Anull%2C%22external_url%22%3A%22http%3A%2F%2Fwww.iunknown.com%2FWindowsLiveWriter%2Fimage_14.png%22%2C%22showDownload%22%3Atrue%2C%22url_slug%22%3A%22dynamic-silverlight-part-2-managed-jscript-an%22%7D'>
<img alt="Media_httpwwwiunknown_eyygh" height="505" src="http://getfile4.posterous.com/getfile/files.posterous.com/import-sges/nhcpIDkgklwDtjgerCgBrAlxkvooahxwfCqFbBddviEjzIaAzitxIqfwIutH/media_httpwwwiunknown_eyygH.png.scaled500.png" width="463" />

</div>
 </p>
<p>Managed JScript has very nice cross-language integration, which only requires loading the module and invoking it.</p>
<p><strong>Summary</strong></p>
<p>We took a look at Managed JScript as a language that you can use to write Silverlight apps in the browser. You can access the Silverlight libraries, as well as a custom C# assembly that contained the types we used in the Silverlight JSON serializer. Finally, we saw a nice example of integrating a piece of code directly off the Internet, written in a different language (Python) into your Dynamic Silverlight app.</p>
<p>In the next part of this series, we'll take a look at integrating our application with ASP.NET MVC, and switching the language back to IronRuby on the client.</p>
						
					</div>

						<ul class="social">
							<li class="tweet">
								
              
            
							</li>
							<li class="like">
								<fb:like href="http://iunknown.com/2008/03/dynamic-silverlight-part-2-managed-jscript-and-flickr.html" layout="button_count"></fb:like> 
							</li>
						</ul>
								
                    
                        
              
                
              
            
                    
				</div>	
				
					
              <aside class="p_responses light">
                
            
          
            
              <nav class='p_response_widget'>
<ul class='clearfix'>
<li class='p_responses_link'><a href="/responses/recent?post_id=37117179" data-posterous-response-count="37117179" data-response-post-id="37117179" title="View responses to this post"><strong>13</strong> responses</a></li>
<li class='p_like_link'><a href="/likes/create?like_type=post&amp;post_id=37117179" class="like_post" data-like-url="/likes/create?like_type=post&amp;post_id=37117179" data-posterous-like-button-for-post-id="37117179" data-posterous-like-text="Like this post" data-posterous-like="true" data-posterous-unlike-text="Unlike this post" data-unlike-url="/likes/delete?like_type=post&amp;post_id=37117179" rel="nofollow" title="Like this post"><div class='p_like_icon'></div><div class='p_unlike_icon' style='display:none'></div><span>Like</span></a></li>
<li class='p_comment_link'><a href="/responses/recent?post_id=37117179" data-comment-post-id="37117179" title="Comment on this post"><div>Comment</div></a></li>
</ul>
</nav>

          		<esi:include src="http://posterous.com/responses?post_id=37117179&user_id=931119" />
          		<div class="posterous_ojs" data-posterous-new-comment-form="true"></div>
            
          
              </aside> 
        		
				
			</li>		
		
		<li class="pagination">
			 
		</li>		
	</ul>
</div>

<div id="footer-container">
	<div id="footer">
	
		<ul class="three-column clearfix">
    		<li class="column clearfix">
				
                
                    
              
            
                
			</li>
			<li class="column">
            
                
            
				<h4>Get Updates</h4>
          <div class="subscribe_to_mysite clearfix">
              
              <div><a href="http://feeds.feedburner.com/LessIsBetter" class="subscribe_link" target="_blank">Subscribe via RSS</a> </div>
              <div class="social-bookmarks">
                  <a href="http://twitter.com/john_lam" class="p_external_site p_twitter" rel="me">Twitter</a>
              </div>
          </div>

			</li>
            <li class="column last">
                
                
              

            </li>
		</ul>
		
		<form class="search-form" method="get">
            <input name="sort" value="" type="hidden" />
            <input name="search" class="search" id="searchbox" value="" type="text" />
            <input class="search_button" value="Search" type="submit" />
        </form>
        
	
	</div>
</div>



  
      <script type="text/javascript">
    	var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    	document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    	</script>
    	<script type="text/javascript">
    	var pageTracker = _gat._getTracker("UA-4054156-1");
    	pageTracker._setDomainName("none");
    	pageTracker._setAllowLinker(true);
    	pageTracker._setAllowHash(false);
    	pageTracker._initData();
    	pageTracker._trackPageview();
    	</script>
    
  
  <!-- Quantcast Tag --> 
  <script type="text/javascript">
    var _qevents = _qevents || [];
    _qevents.push( { qacct:"p-16ewveTurfCCM"} );
  </script>
  <script type="text/javascript" src="//edge.quantserve.com/quant.js" async></script>
  <noscript>
  <div style="display: none;"><img src="https://pixel.quantserve.com/pixel/p-16ewveTurfCCM.gif" height="1" width="1" alt="Quantcast"/></div>
  </noscript>
  <!-- End Quantcast tag -->


	<script type="text/javascript">
		try {
			var pageTrackerUser = _gat._getTracker("UA-12323255-1");
			pageTrackerUser._trackPageview();
		} catch (err) {}
	</script>


<script src="http://www.scribd.com/javascripts/view.js" type="text/javascript"></script>
<script src="/bundles/sites_views.js" type="text/javascript"></script>
<script src="/bundles/sites.js" type="text/javascript"></script>
<script type="text/javascript" src="http://platform.twitter.com/widgets.js" defer></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>

<script>
	var fbid_site_owner = 1;
</script>



<div class="posterous_ojs" data-posterous-twitter-oauth="true" data-posterous-post-ids="%7B%2237117179%22%3A%22http%3A%2F%2Fiunknown.com%2F2008%2F03%2Fdynamic-silverlight-part-2-managed-jscript-and-flickr.html%22%7D" data-posterous-redirect-url="http://posterous.com/oauth/init_oauth_and_redirect/?ssod=iunknown.com&oauth_provider_type="></div>
<script src="http://www.google.com/recaptcha/api/js/recaptcha_ajax.js" type="text/javascript"></script>
<iframe src="http://posterous.com/analytics_tracker" style="height: 1px; width: 1px; display: none;"></iframe>

      <script type="text/javascript">
        null_fn = function () {};
        var mpmetrics = { track_links: null_fn, track: null_fn, track_funnel: null_fn, register: null_fn, register_once: null_fn, register_funnel: null_fn };
      </script>
    </body>
</html>


