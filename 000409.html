<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>iunknown.com: Zestyfind: another reason to not run as local admin</title>

<link rel="stylesheet" href="http://www.iunknown.com/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.iunknown.com/index.rdf" />

<link rel="start" href="http://www.iunknown.com/" title="Home" />
<link rel="prev" href="http://www.iunknown.com/000408.html" title="Where did the security tab go in XP?" />

<link rel="next" href="http://www.iunknown.com/000410.html" title="Using Perl to Syntax Color C#" />


<script type="text/javascript" language="javascript">
<!--

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

var HOST = 'www.iunknown.com';

// Copyright (c) 1996-1997 Athenia Associates.
// http://www.webreference.com/js/
// License is granted if and only if this entire
// copyright notice is included. By Tomer Shiran.

function setCookie (name, value, expires, path, domain, secure) {
    var curCookie = name + "=" + escape(value) + ((expires) ? "; expires=" + expires.toGMTString() : "") + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + ((secure) ? "; secure" : "");
    document.cookie = curCookie;
}

function getCookie (name) {
    var prefix = name + '=';
    var c = document.cookie;
    var nullstring = '';
    var cookieStartIndex = c.indexOf(prefix);
    if (cookieStartIndex == -1)
        return nullstring;
    var cookieEndIndex = c.indexOf(";", cookieStartIndex + prefix.length);
    if (cookieEndIndex == -1)
        cookieEndIndex = c.length;
    return unescape(c.substring(cookieStartIndex + prefix.length, cookieEndIndex));
}

function deleteCookie (name, path, domain) {
    if (getCookie(name))
        document.cookie = name + "=" + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + "; expires=Thu, 01-Jan-70 00:00:01 GMT";
}

function fixDate (date) {
    var base = new Date(0);
    var skew = base.getTime();
    if (skew > 0)
        date.setTime(date.getTime() - skew);
}

function rememberMe (f) {
    var now = new Date();
    fixDate(now);
    now.setTime(now.getTime() + 365 * 24 * 60 * 60 * 1000);
    setCookie('mtcmtauth', f.author.value, now, '', HOST, '');
    setCookie('mtcmtmail', f.email.value, now, '', HOST, '');
    setCookie('mtcmthome', f.url.value, now, '', HOST, '');
}

function forgetMe (f) {
    deleteCookie('mtcmtmail', '', HOST);
    deleteCookie('mtcmthome', '', HOST);
    deleteCookie('mtcmtauth', '', HOST);
    f.email.value = '';
    f.author.value = '';
    f.url.value = '';
}

//-->
</script>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/000409.html"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/153"
    dc:title="Zestyfind: another reason to not run as local admin"
    dc:identifier="http://www.iunknown.com/000409.html"
    dc:subject="Blog"
    dc:description="I just got back from a neighbor&apos;s whose computer has been &quot;taken over&quot; by ZestyFind. The trojan that is installed on the computer pops up random ads on your computer, and takes over your search windows. If you try to..."
    dc:creator="John"
    dc:date="2004-02-14T01:16:02-05:00" />
</rdf:RDF>
-->




</head>

<body>

<div id="banner">
<h1><a href="http://www.iunknown.com/" accesskey="1"><img src="/mt-static/images/iunknown.png" width="350" height="60" border="0"></a></h1>
<span class="description">.NET Training and Consulting in Toronto with John Lam</span>
</div>

<div id="container">

<div class="blog">

<div id="menu">
<a href="http://www.iunknown.com/000408.html">&laquo; Where did the security tab go in XP?</a> |

<a href="http://www.iunknown.com/">Main</a>
| <a href="http://www.iunknown.com/000410.html">Using Perl to Syntax Color C# &raquo;</a>

</div>

</div>


<div class="blog">

<h2 class="date">February 14, 2004</h2>

<div class="blogbody">

<h3 class="title">Zestyfind: another reason to not run as local admin</h3>

<div class="midAds">
<script type="text/javascript"><!--
google_ad_client = "pub-8264790134546506";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_channel ="6417806153";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

<p>I just got back from a neighbor's whose computer has been "taken over" by ZestyFind. The trojan that is installed on the computer pops up random ads on your computer, and takes over your search windows. If you try to visit google, you'll wind up seeing a zestyfind search window showing up on top of the google window.</p>

<p>I spent some time tracking down the usual places where stuff like this likes to hide. There's an interesting layering of different mechanisms in place. There's software installed into <code>HKLM\Software\Microsoft\Windows\CurrentVersion\Run</code>, as one might expect. There are <span class="caps">NT </span>Services installed onto your computer. There's a whole bunch of suspect .exe files installed into the <code>\Windows</code> directory. I hunted down quite a few of these things and eliminated them (using tools like Process Explorer and Spy++), and it was still there. </p>

<p>My neighbor didn't know how most of that stuff got there. He thought it had something to do with <a href="http://www.dqsd.net">Dave Bau's most excellent search bar</a>. But I run that every day on my computers without any problems. All of his anti-virus software and personal firewall software was up to date as well. </p>

<p>In the end, we figured it would be faster for him to repave than it would be for me to track down the real cause of the problem. By not running as a local administrator, it would be much harder for him to download and install ActiveX controls in his browser, which is how we figure the trojan got onto his computer in the first place. </p>

<p>Be careful out there.</p>

<a name="more"></a>


<span class="posted">Posted by John at February 14, 2004 01:16 AM
| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=409" onclick="OpenTrackback(this.href); return false">TrackBack</a>

<br /></span>

</div>

<div class="comments-head"><a name="mailthisentry"></a>Mail this entry</div>

<form method="post" action="http://www.iunknown.com/cgi-bin/mt-send-entry.cgi">
<input type="hidden" name="entry_id" value="409" />
<input type="hidden" name="_redirect" value="http://www.iunknown.com/000409.html" />
Email this entry to:<br />
<input name="to" size="20" /><br /><br />
Your email address:<br />
<input name="from" size="20" /><br /><br />
Message (optional):<br />
<textarea name="message" rows="5" cols="20" wrap="virtual"></textarea><br /><br />
<input type="submit" value="Send" />
</form>


<div class="comments-head"><a name="comments"></a>Comments</div>

<div class="comments-body">
<p>I saw a similar problem.  In that case, the spyware was of the CoolWebSearch family, and it was not detected by antivirus software nor Ad-Aware.</p>

<p>Using the freely available CWShredder tool, I was able to remove it.</p>
<span class="comments-post">Posted by: <a target="_blank" href="http://groups.yahoo.com/group/agiledotnet/">Bernard Vander Beken</a> at February 17, 2004 07:15 AM</span>
</div>
<div class="comments-body">
<p>Since most windows machines are used by a single user, a more practical security model would be to allocate each executable its own identity and security context. Most applications have no need to access _any_ part of the computer other than storage which is private and local to that app. Where they do, permission to do that can be allocated on a case by case basis.</p>

<p>Mind you, trying to implement these polices in the face of a plethora of processes that demand and expect full and unfettered access to a computer is hard. </p>
<span class="comments-post">Posted by: damien morton at February 24, 2004 11:33 AM</span>
</div>



<div class="comments-head">Post a comment</div>

<div class="comments-body">
<form method="post" action="http://www.iunknown.com/cgi-bin/mt-comments.cgi" name="comments_form" onsubmit="if (this.bakecookie[0].checked) rememberMe(this)">
<input type="hidden" name="static" value="1" />
<input type="hidden" name="entry_id" value="409" />

<div style="width:180px; padding-right:15px; margin-right:15px; float:left; text-align:left; border-right:1px dotted #bbb;">
	<label for="author">Name:</label><br />
	<input tabindex="1" id="author" name="author" /><br /><br />

	<label for="email">Email Address:</label><br />
	<input tabindex="2" id="email" name="email" /><br /><br />

	<label for="url">URL:</label><br />
	<input tabindex="3" id="url" name="url" /><br /><br />
</div>

Remember personal info?<br />
<input type="radio" id="bakecookie" name="bakecookie" /><label for="bakecookie">Yes</label><input type="radio" id="forget" name="bakecookie" onclick="forgetMe(this.form)" value="Forget Info" style="margin-left: 15px;" /><label for="forget">No</label><br style="clear: both;" />

<label for="text">Comments:</label><br />
<textarea tabindex="4" id="text" name="text" rows="10" cols="50"></textarea><br /><br />

<input type="submit" name="preview" value="&nbsp;Preview&nbsp;" />
<input style="font-weight: bold;" type="submit" name="post" value="&nbsp;Post&nbsp;" /><br /><br />

</form>

<script type="text/javascript" language="javascript">
<!--
document.comments_form.email.value = getCookie("mtcmtmail");
document.comments_form.author.value = getCookie("mtcmtauth");
document.comments_form.url.value = getCookie("mtcmthome");
if (getCookie("mtcmtauth")) {
    document.comments_form.bakecookie[0].checked = true;
} else {
    document.comments_form.bakecookie[1].checked = true;
}
//-->
</script>
</div>


</div>
</div>
</body>
</html>
