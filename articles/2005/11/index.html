<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Less is better</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  
  <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.iunknown.com/xml/rsd" />
  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/LessIsBetter" />
  <script src="/javascripts/cookies.js?1156231406" type="text/javascript"></script>
  <script src="/javascripts/prototype.js?1156231406" type="text/javascript"></script>
  <script src="/javascripts/effects.js?1156231406" type="text/javascript"></script>
  <script src="/javascripts/typo.js?1156231406" type="text/javascript"></script>
  
  <script type="text/javascript"></script>
  <link href="/stylesheets/theme/application.css?1164503575" media="all" rel="Stylesheet" type="text/css" />
  <script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
  <script type="text/javascript">
    _uacct="UA-133590-1";
    urchinTracker();
  </script>
</head>

<body>
<div id="container">
  <div id="header">
    <h1><span><a href="/">Less is better</a></span></h1>
    <h2>John Lam on software</h2>
  </div>

  <div id="page">
    <div id="content">
      <div class="atomentry" id="article-24">
  <h2 class="title">
    <a href="/articles/2005/11/30/embed-movies-in-powerpoint">Embed movies in PowerPoint</a> 
    <span class="comment_count">2</span>
  </h2>

  <p class="author">
    Posted by <cite><a href="mailto:jlam@iunknown.com">John Lam</a></cite>
    <abbr class="published" title="2005-11-30T10:49:00-08:00"><span class="typo_date" title="Wed, 30 Nov 2005 18:49:00 GMT">Wed, 30 Nov 2005 18:49:00 GMT</span></abbr>
  </p>

  <div class="content">
    <p>There was something <em>really</em> special about <a href="http://blog.zenspider.com/">Ryan Davis&#8217;</a> excellent ZenHacks talk at RubyConf 2005. It took me a while to figure out what was going on, but it initially looked to me like he was typing code into a command shell embedded in the middle of his Keynote slide deck. As it turned out, he was playing QuickTime movies from within his slide deck, which let him give the <em>feel</em> of a live coding session, but with better commentary since he didn&#8217;t have to think, talk and type at the same time.</p>


	<p>I decided to try the same approach for my talk tonight. However, I quickly ran into a large number of technical blocking issues. Here&#8217;s a set of notes to help anyone else that&#8217;s trying to use this technique.</p>


	<p>1) <a href="http://www.techsmith.com/">Camtasia</a> rocks. I have a full license for <a href="http://www.macromedia.com/software/robodemo/">Captivate</a> but I think I&#8217;m going to pony up the cash for Camtasia as well. The main reason for the switch is the ability to create <span class="caps">WMV</span> files directly from Camtasia.</p>


	<p>2) Your screen cast video will look really crappy if it is scaled. The main problem with PowerPoint is that it <strong>insists</strong> on scaling your video to whatever your output device resolutiion is. One way to get around this is to force the slide show resolution to a fixed resolution (I used 1024&#215;768):</p>


	<p><img src="images/screen_resolution.png" alt="" /></p>


	<p>Next, you must force the size of your video clip to be a fixed size (7.8125&#8221; works for an 800&#215;600 movie using the default PowerPoint slide sizes).</p>


	<p>3). Setup your video to play automatically. This makes for a much more seamless experience when you land on a slide with a video. I had a really hard time making things work the way I wanted with <span class="caps">SWF</span> files generated by Captivate, which was a major reason why I&#8217;m considering ponying up the $$$ to buy Camtasia (it&#8217;s not cheap either, but a good deal cheaper than Captivate).</p>

      
  </div>

  <ul class="meta">
    <li class="categories">Posted in <a href="/articles/category/thoughts" rel="tag">Thoughts</a></li>
    
    <li>Meta 
      
      <a href="/articles/2005/11/30/embed-movies-in-powerpoint#comments">2 comments</a>,
      <a href="/articles/2005/11/30/embed-movies-in-powerpoint" rel="bookmark">permalink</a>,
      <a href="http://www.iunknown.com/xml/rss/article/24/feed.xml">rss</a>,    
      <a href="http://www.iunknown.com/xml/atom/article/24/feed.xml">atom</a>, 
      <a title='digg this' href="http://digg.com/submit?phase=2&url=/articles/2005/11/30/embed-movies-in-powerpoint">digg this</a>, 
      <a title='reddit' href="http://reddit.com/submit?url=/articles/2005/11/30/embed-movies-in-powerpoint;title=Embed movies in PowerPoint">reddit</a>
    </li>
  </ul>
</div>
<div class="atomentry" id="article-23">
  <h2 class="title">
    <a href="/articles/2005/11/29/matthews-birthday-present">Matthew's Birthday Present</a> 
    
  </h2>

  <p class="author">
    Posted by <cite><a href="mailto:jlam@iunknown.com">John Lam</a></cite>
    <abbr class="published" title="2005-11-29T00:52:00-08:00"><span class="typo_date" title="Tue, 29 Nov 2005 08:52:00 GMT">Tue, 29 Nov 2005 08:52:00 GMT</span></abbr>
  </p>

  <div class="content">
    <p>I just finished updating Matthew&#8217;s Birthday Present for the <span class="caps">RTM</span> release of .NET 2.0. I&#8217;ll be unveiling <a href="http://www.cttdnug.org/DesktopDefault.aspx?tabid=104">Matthew&#8217;s second birthday present</a> at the Canada Technology Triangle .NET User Group meeting Wednesday, November 30, 2005.</p>


	<p>It should be a really fun talk. You&#8217;ll see the culmination of several months of late night hacking. Among the things you will see are:</p>


	<ul>
	<li>Indigo</li>
		<li>Avalon</li>
		<li>Managed C++</li>
		<li><span class="caps">CIL</span></li>
		<li>Ruby</li>
	</ul>


	<p>With the exception of <span class="caps">WWF</span>, it will be pretty much a lap around WinFX, but done using Ruby :)</p>


	<p>It looks like I&#8217;ll have quite the crowd there: <del>104</del> 113 registered as of right now. Hope to see you there!</p>

      
  </div>

  <ul class="meta">
    <li class="categories">Posted in <a href="/articles/category/thoughts" rel="tag">Thoughts</a></li>
    
    <li>Meta 
      
      <a href="/articles/2005/11/29/matthews-birthday-present#comments">no comments</a>,
      <a href="/articles/2005/11/29/matthews-birthday-present" rel="bookmark">permalink</a>,
      <a href="http://www.iunknown.com/xml/rss/article/23/feed.xml">rss</a>,    
      <a href="http://www.iunknown.com/xml/atom/article/23/feed.xml">atom</a>, 
      <a title='digg this' href="http://digg.com/submit?phase=2&url=/articles/2005/11/29/matthews-birthday-present">digg this</a>, 
      <a title='reddit' href="http://reddit.com/submit?url=/articles/2005/11/29/matthews-birthday-present;title=Matthew's Birthday Present">reddit</a>
    </li>
  </ul>
</div>
<div class="atomentry" id="article-22">
  <h2 class="title">
    <a href="/articles/2005/11/28/torcamp">TorCamp</a> 
    
  </h2>

  <p class="author">
    Posted by <cite><a href="mailto:jlam@iunknown.com">John Lam</a></cite>
    <abbr class="published" title="2005-11-28T09:57:00-08:00"><span class="typo_date" title="Mon, 28 Nov 2005 17:57:00 GMT">Mon, 28 Nov 2005 17:57:00 GMT</span></abbr>
  </p>

  <div class="content">
    <p><a href="http://www.flickr.com/photos/23649168@N00/67605248/"><img src="http://static.flickr.com/24/67605248_fc147dbc3a.jpg" alt="" /></a></p>


	<p>This was <a href="http://barcamp.org/index.cgi?TorCamp">TorCamp</a> weekend in Toronto. And what a weekend it was. For the longest time, it felt quite isolating to be a geek living in Toronto (at least relative to places like Seattle or San Francisco). Sure, there&#8217;s a vibrant .NET developer community in Toronto, but most of that community is focused on &#8220;corporate&#8221; apps, and far less on innovative uses of the technology (aka startups).</p>


	<p><a href="http://www.objectsharp.com">ObjectSharp</a> was proud to be a sponsor of the initial run of the conference. I met a lot of really interesting folks at the event that I&#8217;m sure I&#8217;ll be having a lot more interesting follow-up conversations with in the near future. A <strong>big</strong> thanks goes out to <a href="http://davidcrow.ca/">David Crow</a> for making this event happen.</p>


	<p>Check out the <a href="http://www.flickr.com/photos/tags/torcamp/">flickr group</a> for some images from the conference. I love the space that <a href="http://www.teehanlax.com/">teehan+lax</a> provided for hosting the conference.</p>


	<p>The best thing about this conference was the cross-fertilization of ideas that can happen when you get a bunch of folks from different walks of life having informed conversations and debates. <a href="http://www.braithwaite-lee.com/weblog/2005/11/torcamp.html">Reg Braithwaite</a> gave a nice talk about the importance of context in applications ranging from search to advertising to project management(!). <a href="http://blog.davidjanes.com/">David Janes</a> gave a very cool demo about metadata, microcontent, blogging, and greasemonkey. I met Albert Lai, whose company, <a href="http://www.bubbleshare.com/about/">BubbleShare</a> is actually using Ruby and .NET to build their innovative photo sharing service. Lots of other interesting hallway conversations too numerous to recount here.</p>


	<p>I spent some time talking to a small group of folks about bridging Ruby and the <span class="caps">CLR</span> (this wasn&#8217;t really the right crowd to be giving a talk like this to). It started out small, but eventually turned into a 1:1 conversation between myself and <a href="http://shaver.off.net/diary/">Mike Shaver</a> of Mozilla about the difficulties of avoiding memory leaks in a process that is running multiple GC-based allocators based on his experience with Mono + Firefox. It&#8217;s definitely something that I need to spend some more time thinking about.</p>

      
  </div>

  <ul class="meta">
    <li class="categories">Posted in <a href="/articles/category/links" rel="tag">Props</a></li>
    
    <li>Meta 
      
      <a href="/articles/2005/11/28/torcamp#comments">no comments</a>,
      <a href="/articles/2005/11/28/torcamp" rel="bookmark">permalink</a>,
      <a href="http://www.iunknown.com/xml/rss/article/22/feed.xml">rss</a>,    
      <a href="http://www.iunknown.com/xml/atom/article/22/feed.xml">atom</a>, 
      <a title='digg this' href="http://digg.com/submit?phase=2&url=/articles/2005/11/28/torcamp">digg this</a>, 
      <a title='reddit' href="http://reddit.com/submit?url=/articles/2005/11/28/torcamp;title=TorCamp">reddit</a>
    </li>
  </ul>
</div>
<div class="atomentry" id="article-21">
  <h2 class="title">
    <a href="/articles/2005/11/25/indigo-and-ruby-great-together-well-sort-of">Indigo and Ruby: great together (well sort of)</a> 
    <span class="comment_count">2</span>
  </h2>

  <p class="author">
    Posted by <cite><a href="mailto:jlam@iunknown.com">John Lam</a></cite>
    <abbr class="published" title="2005-11-25T16:15:00-08:00"><span class="typo_date" title="Sat, 26 Nov 2005 00:15:00 GMT">Sat, 26 Nov 2005 00:15:00 GMT</span></abbr>
  </p>

  <div class="content">
    <p>If you look at the code that I wrote to <a href="/images/flickr.cs">call flickr using Indigo</a>, you&#8217;ll notice that the flickr <span class="caps">API</span> call accepts a string and returns a string. This makes it trivial for me to interop with Ruby:</p>


<pre><code>
require 'RubyShim'
require 'builder'
require 'builder/xmlmarkup'
require 'rexml/document'

reference_file 'flickrlib.dll'

include FlickrLib
include Builder
include REXML

f = Flickr.new('83293ff34e3ab3d9935018480190319f')
puts f.Call('&lt;method&gt;flickr.people.findByEmail&lt;/method&gt;
             &lt;find_email&gt;jlam@iunknown.com&lt;/find_email&gt;')

# or if you prefer
xml = Builder::XmlMarkup.new
xml.method     "flickr.people.findByEmail" 
xml.find_email "jlam@iunknown.com" 

d = Document.new(f.Call(xml.target!))
puts d.elements['//username'].text
</code></pre>

	<p>I&#8217;m not all that happy with sending mal-formed <span class="caps">XML</span> as an in-parameter, but it was a quick and easy hack to get it up and running.</p>

      
  </div>

  <ul class="meta">
    <li class="categories">Posted in <a href="/articles/category/thoughts" rel="tag">Thoughts</a></li>
    
    <li>Meta 
      
      <a href="/articles/2005/11/25/indigo-and-ruby-great-together-well-sort-of#comments">2 comments</a>,
      <a href="/articles/2005/11/25/indigo-and-ruby-great-together-well-sort-of" rel="bookmark">permalink</a>,
      <a href="http://www.iunknown.com/xml/rss/article/21/feed.xml">rss</a>,    
      <a href="http://www.iunknown.com/xml/atom/article/21/feed.xml">atom</a>, 
      <a title='digg this' href="http://digg.com/submit?phase=2&url=/articles/2005/11/25/indigo-and-ruby-great-together-well-sort-of">digg this</a>, 
      <a title='reddit' href="http://reddit.com/submit?url=/articles/2005/11/25/indigo-and-ruby-great-together-well-sort-of;title=Indigo and Ruby: great together (well sort of)">reddit</a>
    </li>
  </ul>
</div>
<div class="atomentry" id="article-20">
  <h2 class="title">
    <a href="/articles/2005/11/25/indigo-and-flickr-happy-at-last">Indigo and flickr: happy at last</a> 
    
  </h2>

  <p class="author">
    Posted by <cite><a href="mailto:jlam@iunknown.com">John Lam</a></cite>
    <abbr class="published" title="2005-11-25T15:22:00-08:00"><span class="typo_date" title="Fri, 25 Nov 2005 23:22:00 GMT">Fri, 25 Nov 2005 23:22:00 GMT</span></abbr>
  </p>

  <div class="content">
    <p>In yesterday&#8217;s post about the <a href="http://www.iunknown.com/articles/2005/11/24/indigo-and-flickr-not-happy-together">Flickr bug</a> I explained what was causing Indigo to be so unhappy. I spent some quality time with Google, and found <a href="http://www.douglasp.com/blog/PermaLink.aspx?guid=e3c387b8-f397-4f4f-817c-75fceab651e7">the code samples</a> from Doug Purdy&#8217;s <span class="caps">PDC</span> presentation on how to make Indigo initiate <span class="caps">POX</span> (Plain Old <span class="caps">XML</span>) style calls. Now, flickr should really fix their <span class="caps">API</span>, but this led to an interesting educational trip into the world of <code>MessageEncoders</code> in Indigo.</p>


	<p>A <code>MessageEncoder</code> is responsible for marshaling a <code>Message</code> object to and from an Indigo transport. By writing my own <code>MessageEncoder</code>, I can set its <code>MediaType</code> property to <code>text/xml</code>, thereby ensuring that the Indigo plumbing accepts the mal-formed flickr response.</p>


	<p>Once you write your own <code>MessageEncoder</code>, you have to inject it into the Indigo stack. To do this, you&#8217;ll need to implement a custom <code>MessageEncoderFactory</code> and a custom <code>BindingElement</code>. This is fill-in-the-form style programming &#8211; you just have to override a few mandatory methods and you&#8217;re good to go.</p>


	<p>The really nice part of this exercise was how none of the rest of the code that I wrote yesterday had to change to make this happen. The only part that changed was replacing the reference to <code>TextMessageEncodingBindingElement</code> with my new <code>FlickrEncodingBindingElement</code>.</p>


	<p>Here&#8217;s the <a href="/images/flickr.cs">source code</a> for my implementation (cleaned up a bit from the code that I posted yesterday).</p>


	<p>Thanks go out to <a href="http://www.pluralsight.com/blogs/dbox/default.aspx">Don Box</a>, <a href="http://blogs.msdn.com/yassers/">Yasser Shohoud</a> and <a href="http://www.kennyw.com/">Kenny Wolf</a> for pointing out the right way of making this happen.</p>

      
  </div>

  <ul class="meta">
    <li class="categories">Posted in <a href="/articles/category/thoughts" rel="tag">Thoughts</a></li>
    
    <li>Meta 
      
      <a href="/articles/2005/11/25/indigo-and-flickr-happy-at-last#comments">no comments</a>,
      <a href="/articles/2005/11/25/indigo-and-flickr-happy-at-last" rel="bookmark">permalink</a>,
      <a href="http://www.iunknown.com/xml/rss/article/20/feed.xml">rss</a>,    
      <a href="http://www.iunknown.com/xml/atom/article/20/feed.xml">atom</a>, 
      <a title='digg this' href="http://digg.com/submit?phase=2&url=/articles/2005/11/25/indigo-and-flickr-happy-at-last">digg this</a>, 
      <a title='reddit' href="http://reddit.com/submit?url=/articles/2005/11/25/indigo-and-flickr-happy-at-last;title=Indigo and flickr: happy at last">reddit</a>
    </li>
  </ul>
</div>
<div class="atomentry" id="article-19">
  <h2 class="title">
    <a href="/articles/2005/11/24/indigo-and-flickr-not-happy-together">Indigo and flickr: not happy together</a> 
    
  </h2>

  <p class="author">
    Posted by <cite><a href="mailto:jlam@iunknown.com">John Lam</a></cite>
    <abbr class="published" title="2005-11-24T20:29:00-08:00"><span class="typo_date" title="Fri, 25 Nov 2005 04:29:00 GMT">Fri, 25 Nov 2005 04:29:00 GMT</span></abbr>
  </p>

  <div class="content">
    <p>Inspired by Mike Taulty&#8217;s <a href="http://mtaulty.com/blog/(z0uien45genrh0jdmtze0z45)/archive/2005/03/30/1721.aspx">A slightly different &#8216;hello, world&#8217; for Indigo</a> blog entry, I decided to create a low-level Indigo client that talks to <a href="http://www.flickr.com/services/api">flickr</a>.</p>


	<p>I wanted to understand how the Indigo plumbing worked, so I decided to forego the high-level APIs and write my code using nothing more than <code>ChannelFactory</code>, <code>Message</code>, <code>IRequestChannel</code> and friends. This code compiles and runs on the <a href="http://blogs.msdn.com/brada/archive/2005/11/18/494283.aspx">November <span class="caps">CTP</span></a> bits, so my code looks a bit different than Mike&#8217;s code on his blog. If you want to follow along, you&#8217;ll need the November <span class="caps">CTP</span> bits and the <span class="caps">SDK</span>, but be warned: the documentation has not stayed in sync with changes to the <span class="caps">API</span>. <a href="http://www.aisto.com/roeder/dotnet/">Reflector</a> is your friend :)</p>


	<p>It all started innocently enough. Here&#8217;s the original version of my code:</p>


<pre><code>
    ChannelFactory&lt;IRequestChannel&gt; factory;
    using (factory = new ChannelFactory&lt;IRequestChannel&gt;(
           CreateBinding(),
           new EndpointAddress("http://www.flickr.com/services/soap/"))) {
      using (IRequestChannel channel = factory.CreateChannel()) {
        StringReader body =
          new StringReader(@"&lt;x:FlickrRequest xmlns:x='urn:flickr'&gt;
                             &lt;api_key&gt;83293ff34e3ab3d9935018480190319f&lt;/api_key&gt;
                             &lt;format&gt;soap2&lt;/format&gt;
                             &lt;method&gt;flickr.test.echo&lt;/method&gt;
                             &lt;name&gt;value&lt;/name&gt;
                           &lt;/x:FlickrRequest&gt;");
        XmlTextReader reader = new XmlTextReader(body);
        Message message      = Message.CreateMessage(MessageVersion.Soap12Addressing1, 
                               "*", reader);
        Message response     = channel.Request(message);
        XmlDictionaryReader responseReader = response.GetReaderAtBodyContents();
        Console.Write(responseReader.ReadOuterXml());
      }
    }
</code></pre>

	<p>This code uses a <code>ChannelFactory</code> to create a request/response style channel to flickr. Next, I construct a <code>Message</code> object and inject some <span class="caps">XML</span> into the message body. The flickr <span class="caps">API</span> is really just a single method that takes an <span class="caps">XML</span> document and returns an <span class="caps">XML</span> document. See the <a href="http://www.flickr.com/services/api">documentation</a> for more examples. Finally, I send my request <code>Message</code> via the channel, and it hands me back a response <code>Message</code> object that I serialize to the console. Simple enough, right?</p>


	<p>That&#8217;s when the fun began. There&#8217;s a bug in flickr, and apparently, I&#8217;m <a href="http://www.flickr.com/forums/bugs/14099/">not the first one to report this</a>. The flickr <span class="caps">SOAP API</span> returns a content-type of <code>text/xml</code> for a <span class="caps">SOAP 1</span>.2 message body, whereas the <a href="http://www.w3.org/TR/2003/REC-soap12-part0-20030624/">spec</a> clearly states that the content-type should be <code>application/soap+xml</code>. Indigo is not happy at all with this, and throws a <code>ProtocolException</code> and aborts further processing of the <span class="caps">HTTP</span> response.</p>


	<p>The crux of the problem lies in the type of channel that I created using the <code>ChannelFactory</code> class. To understand how the channel is constructed, I have to show you the missing implementation of the <code>CreateBinding</code> method:</p>


<pre><code>
CustomBinding binding = new CustomBinding();
binding.Elements.Add(new TextMessageEncodingBindingElement(
  MessageVersion.Soap12Addressing1, Encoding.UTF8));
binding.Elements.Add(new HttpTransportBindingElement());
return binding;
</code></pre>

	<p>Here, I tell the <code>ChannelFactory</code> to construct a channel that uses an <span class="caps">HTTP</span> transport, and a text-based <span class="caps">XML</span> serializer that will generate a <span class="caps">SOAP 1</span>.2 message that is text encoded as <span class="caps">UTF</span>-8. Indigo will also check to make sure that the response from the server is a <span class="caps">SOAP 1</span>.2 message <strong>and</strong> the content-type is <code>application/soap+xml</code>. To see this checking in action, try sending a <span class="caps">SOAP 1</span>.1 <code>Message</code> using this channel.</p>


	<p>I spent some time spelunking around using Reflector, <code>TextMessageEncoder.IsContentTypeSupported</code> is where the <code>ProtocolException</code> gets thrown. Unfortunately, I couldn&#8217;t find a way to change the <code>ContentType</code> property of this object. This left only one other option that I could see: write a custom <code>MessageEncoder</code>.</p>


	<p>More on how to do this tomorrow.</p>

      
  </div>

  <ul class="meta">
    <li class="categories">Posted in <a href="/articles/category/thoughts" rel="tag">Thoughts</a></li>
    
    <li>Meta 
      
      <a href="/articles/2005/11/24/indigo-and-flickr-not-happy-together#comments">no comments</a>,
      <a href="/articles/2005/11/24/indigo-and-flickr-not-happy-together" rel="bookmark">permalink</a>,
      <a href="http://www.iunknown.com/xml/rss/article/19/feed.xml">rss</a>,    
      <a href="http://www.iunknown.com/xml/atom/article/19/feed.xml">atom</a>, 
      <a title='digg this' href="http://digg.com/submit?phase=2&url=/articles/2005/11/24/indigo-and-flickr-not-happy-together">digg this</a>, 
      <a title='reddit' href="http://reddit.com/submit?url=/articles/2005/11/24/indigo-and-flickr-not-happy-together;title=Indigo and flickr: not happy together">reddit</a>
    </li>
  </ul>
</div>
<div class="atomentry" id="article-18">
  <h2 class="title">
    <a href="/articles/2005/11/23/synergy">Synergy!</a> 
    <span class="comment_count">9</span>
  </h2>

  <p class="author">
    Posted by <cite><a href="mailto:jlam@iunknown.com">John Lam</a></cite>
    <abbr class="published" title="2005-11-23T22:52:00-08:00"><span class="typo_date" title="Thu, 24 Nov 2005 06:52:00 GMT">Thu, 24 Nov 2005 06:52:00 GMT</span></abbr>
  </p>

  <div class="content">
    <p>While looking for other people who have actually used <span class="caps">SOAP</span> to access the <a href="http://www.flickr.com/services/api/">Flickr <span class="caps">API</span></a>, I discovered <a href="http://synergy2.sourceforge.net/index.html">Synergy</a>.</p>


	<p>My life&#8217;s dream is complete: I have actually discovered a useful utility before <a href="http://www.hanselman.com/blog/">Scott Hanselman</a>!  Marvel at how I can use the same keyboard and mouse on the <strong>same virtual desktop</strong> across three computers, one of which is my Powerbook!</p>


	<p>All I have to do is roll the mouse to the desired screen, and the keyboard &#8220;focus&#8221; follows my mouse. Absolutely fantastic utility.</p>


	<p><img src="http://static.flickr.com/25/66370105_847f42aa6d.jpg" alt="" /></p>

      
  </div>

  <ul class="meta">
    <li class="categories">Posted in <a href="/articles/category/links" rel="tag">Props</a></li>
    
    <li>Meta 
      
      <a href="/articles/2005/11/23/synergy#comments">9 comments</a>,
      <a href="/articles/2005/11/23/synergy" rel="bookmark">permalink</a>,
      <a href="http://www.iunknown.com/xml/rss/article/18/feed.xml">rss</a>,    
      <a href="http://www.iunknown.com/xml/atom/article/18/feed.xml">atom</a>, 
      <a title='digg this' href="http://digg.com/submit?phase=2&url=/articles/2005/11/23/synergy">digg this</a>, 
      <a title='reddit' href="http://reddit.com/submit?url=/articles/2005/11/23/synergy;title=Synergy!">reddit</a>
    </li>
  </ul>
</div>
<div class="atomentry" id="article-17">
  <h2 class="title">
    <a href="/articles/2005/11/23/avalon-november-ctp">Avalon November CTP</a> 
    
  </h2>

  <p class="author">
    Posted by <cite><a href="mailto:jlam@iunknown.com">John Lam</a></cite>
    <abbr class="published" title="2005-11-23T15:37:00-08:00"><span class="typo_date" title="Wed, 23 Nov 2005 23:37:00 GMT">Wed, 23 Nov 2005 23:37:00 GMT</span></abbr>
  </p>

  <div class="content">
    <p>I spent some time this afternoon dealing with the breaking changes in my toy Avalon application between the September WinFX <span class="caps">CTP</span> and the November WinFX <span class="caps">CTP</span>.</p>


	<p><a href="http://blogs.msdn.com/karstenj/archive/2005/11/18/494551.aspx">Karsten Januszewski</a> has kindly released <a href="http://winfx.members.winisp.net/files/introductionnovctp.mht">a draft of his upcoming article on the November <span class="caps">CTP</span></a> that is scheduled to appear on <span class="caps">MSDN</span> in December. Between that and the Avalon <span class="caps">XSD</span> schema, I was able to figure out how to port my application to the November <span class="caps">CTP</span>.</p>


	<p>The biggest problem that I had was remembering that the syntax of a <code>PropertyPath</code> is based on a dot-delimited list of (<em>type name</em>.<em>property name</em>) tuples. You can also specify indexers for the list tuples.</p>


	<p>In my app, I had a fairly complex property path that scrapes a property out of a 3D model:</p>


	<p><code>(Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[2].(Model3D.Transform).(RotateTransform3D.Rotation)</code></p>


	<p>There is a new <code>Children</code> element that hangs off of <code>Viewport3D</code> that tripped me up. The runtime exceptions that get thrown by the framework aren&#8217;t, um, helpful towards diagnosis of the problem. Spelunking via Intellisense was what helped me discover the new <code>Children</code> property (Karsten mentions it in his article as well).</p>

      
  </div>

  <ul class="meta">
    <li class="categories">Posted in <a href="/articles/category/thoughts" rel="tag">Thoughts</a></li>
    
    <li>Meta 
      
      <a href="/articles/2005/11/23/avalon-november-ctp#comments">no comments</a>,
      <a href="/articles/2005/11/23/avalon-november-ctp" rel="bookmark">permalink</a>,
      <a href="http://www.iunknown.com/xml/rss/article/17/feed.xml">rss</a>,    
      <a href="http://www.iunknown.com/xml/atom/article/17/feed.xml">atom</a>, 
      <a title='digg this' href="http://digg.com/submit?phase=2&url=/articles/2005/11/23/avalon-november-ctp">digg this</a>, 
      <a title='reddit' href="http://reddit.com/submit?url=/articles/2005/11/23/avalon-november-ctp;title=Avalon November CTP">reddit</a>
    </li>
  </ul>
</div>
<div class="atomentry" id="article-16">
  <h2 class="title">
    <a href="/articles/2005/11/11/ruby-in-the-enterprise">Ruby in the Enterprise</a> 
    <span class="comment_count">1</span>
  </h2>

  <p class="author">
    Posted by <cite><a href="mailto:jlam@iunknown.com">John Lam</a></cite>
    <abbr class="published" title="2005-11-11T14:40:00-08:00"><span class="typo_date" title="Fri, 11 Nov 2005 22:40:00 GMT">Fri, 11 Nov 2005 22:40:00 GMT</span></abbr>
  </p>

  <div class="content">
    <p>Most of the work we do at <a href="http://www.objectsharp.com">ObjectSharp</a> is your standard line of business application. If you ever tried to introduce Ruby into such an environment, you&#8217;re bound to run into some resistence.</p>


	<p>At next week&#8217;s <a href="http://www.objectsharp.com/oNewsUpdate/ReadingFullStory.aspx?StoryNum=-94">Architect&#8217;s Roundtable presentation</a>, I&#8217;m going to present the case for Ruby in the Enterprise. It&#8217;s an interesting story about how we can learn from the past, the importance of platforms, and how to sell productivity to customers.</p>


	<p>If you&#8217;re in the Toronto area, make sure you drop by to say hello!</p>

      
  </div>

  <ul class="meta">
    <li class="categories">Posted in <a href="/articles/category/personal" rel="tag">Life</a></li>
    
    <li>Meta 
      
      <a href="/articles/2005/11/11/ruby-in-the-enterprise#comments">1 comment</a>,
      <a href="/articles/2005/11/11/ruby-in-the-enterprise" rel="bookmark">permalink</a>,
      <a href="http://www.iunknown.com/xml/rss/article/16/feed.xml">rss</a>,    
      <a href="http://www.iunknown.com/xml/atom/article/16/feed.xml">atom</a>, 
      <a title='digg this' href="http://digg.com/submit?phase=2&url=/articles/2005/11/11/ruby-in-the-enterprise">digg this</a>, 
      <a title='reddit' href="http://reddit.com/submit?url=/articles/2005/11/11/ruby-in-the-enterprise;title=Ruby in the Enterprise">reddit</a>
    </li>
  </ul>
</div>
<div class="atomentry" id="article-15">
  <h2 class="title">
    <a href="/articles/2005/11/11/ruby-com-and-the-clr">Ruby, COM and the CLR</a> 
    <span class="comment_count">3</span>
  </h2>

  <p class="author">
    Posted by <cite><a href="mailto:jlam@iunknown.com">John Lam</a></cite>
    <abbr class="published" title="2005-11-11T07:00:00-08:00"><span class="typo_date" title="Fri, 11 Nov 2005 15:00:00 GMT">Fri, 11 Nov 2005 15:00:00 GMT</span></abbr>
  </p>

  <div class="content">
    <p>If you want to write code that interacts with windows (note the lowercase w) and <span class="caps">COM</span>, then your thread must live in its own single threaded apartment (STA). This poses a problem if you want to write some Windows Forms code in Ruby. Here&#8217;s the problem in a nutshell:</p>


	<p>If you&#8217;re using my bridge, the <span class="caps">CLR</span> is delay-loaded; it loads when my bridge is loaded by the Ruby interpreter. Now Ruby doesn&#8217;t know anything about <span class="caps">COM</span>, so Ruby doesn&#8217;t turn on <span class="caps">COM</span> via a <code>CoInitializeEx</code> call at startup. So I should have a chance to turn on <span class="caps">COM</span> on behalf of Ruby (more on why this is bad later) when my bridge loads. One of the really nice things about using MC++ is that the compiler/libraries does a bunch of auto-magical startup code to hoist the <span class="caps">CLR</span> into memory when my bridge loads. This is where our problems begin.</p>


	<p>In V1.0 and V1.1 of the <span class="caps">CLR</span>, the runtime <em>theoretically</em> didn&#8217;t turn on <span class="caps">COM</span> either (it actually did in a number of corner cases). This lets you write code like:</p>


	<p><code>Thread::CurrentThread::ApartmentState = ApartmentState::STA;</code></p>


	<p>However, under V2.0 of the <span class="caps">CLR</span> all threads automatically start in the <span class="caps">MTA</span> &#8211; which means that you can no longer write code like the line above. You can instruct the <span class="caps">CLR</span> at <strong>intialization time</strong> to have threads default to their own <span class="caps">STA</span> (via an <code>app.config</code> file or via an <code>STAThread</code> attribute on your application&#8217;s <code>Main</code> method), or you can intialize <span class="caps">COM</span> yourself before you initialize the <span class="caps">CLR</span>.</p>


	<p>For a variety of reasons, if the <span class="caps">CLR</span> is delay-loaded, there really is no way to <em>declaratively</em> tell the <span class="caps">CLR</span> about your intentions with respect to <span class="caps">COM</span>. This leaves you with one other option: turn on <span class="caps">COM</span> yourself <em>before</em> the <span class="caps">CLR</span> loads.</p>


	<p>Now how can you do this without hacking Ruby itself? Anson Tsao, and old friend of mine at Microsoft provided me with the answer as I was feverishly coding up my bridge in anticipation of its first internal review meeting.</p>


	<p>I had an Avalon demo application that I was coding up for Matthew&#8217;s second year birthday and it was refusing to run because the calling thread was not an <span class="caps">STA</span> thread! Now, as anyone with a 2 year old knows, they can get rather upset when things don&#8217;t go their way :) But thankfully at the very last minute, Anson provided me with this hack:</p>


<pre><code>
void InitializedManagedRubyBridge() {
  ...
}

#pragma unmanaged
// Main entry point
__declspec(dllexport) void Init_RubyShim() {
  CoInitializeEx(0, COINIT_APARTMENTTHREADED);
  InitializeManagedRubyBridge();
}
</code></pre>

	<p>Notice how I can mix unmanaged and managed code inside the same <span class="caps">DLL</span>! If I define my <span class="caps">DLL</span> entry point in unmanaged code, I can turn on <span class="caps">COM</span> and then jump into my managed code. The call to <code>InitializeManagedRubyBridge()</code> gets intercepted by MC++ libraries which in turn hoist the <span class="caps">CLR</span> into memory before calling my method.</p>


	<p>This is a nice way to solve this problem. In a future post, I&#8217;ll point out how this doesn&#8217;t <em>really</em> solve this problem in all cases but likely solves this problem in most cases that users of my bridge will run across.</p>

      
  </div>

  <ul class="meta">
    <li class="categories">Posted in <a href="/articles/category/thoughts" rel="tag">Thoughts</a></li>
    
    <li>Meta 
      
      <a href="/articles/2005/11/11/ruby-com-and-the-clr#comments">3 comments</a>,
      <a href="/articles/2005/11/11/ruby-com-and-the-clr" rel="bookmark">permalink</a>,
      <a href="http://www.iunknown.com/xml/rss/article/15/feed.xml">rss</a>,    
      <a href="http://www.iunknown.com/xml/atom/article/15/feed.xml">atom</a>, 
      <a title='digg this' href="http://digg.com/submit?phase=2&url=/articles/2005/11/11/ruby-com-and-the-clr">digg this</a>, 
      <a title='reddit' href="http://reddit.com/submit?url=/articles/2005/11/11/ruby-com-and-the-clr;title=Ruby, COM and the CLR">reddit</a>
    </li>
  </ul>
</div>


<p class="pagination">Older posts: 1 <a href="/articles/2005/11/page/2">2</a> </p>

      <script type="text/javascript">
//<![CDATA[
show_dates_as_local_time()
//]]>
</script>
    </div>

    <div id="sidebar">
      <!-- search -->
      <div id="search" class="search">
	<form action="/articles/search" id="sform" method="get">
	  <p><input type="text" id="q" name="q" value="" /></p>
	</form>
	
	<div id="loading" class="loading" style="display:none;">Searching...</div>
	<div id="results" class="results"></div>
  <script type="text/javascript">
//<![CDATA[
new Form.Element.Observer('q', 1, function(element, value) {new Ajax.Updater('results', '/live/search', {asynchronous:true, evalScripts:true, onComplete:function(request){Element.hide('loading')}, onLoading:function(request){Element.show('loading')}, parameters:'q=' + escape($F('q'))})})
//]]>
</script>
</div>


      <!-- sidebar components -->
      
      
<div class="sidebar-node">
  <h3>John Lam</h3>
<a href="/pages/about_me"><img src="http://static.flickr.com/90/222479189_d4e19a202c_t.jpg" width="67" height="100" alt="Self portrait" /></a>

<p>I am a Program Manager on the Common Language Runtime team at Microsoft. I write .NET and Ruby code on a Mac. I'm the creator of <a href="http://www.rubyclr.com">RubyCLR</a>, a high performance bridge between Ruby and .NET. <a href="/pages/about_me">More ...</a>

<table>
<tr>
  <td>email:</td>
  <td>jlam@iunknown.com</td>
</tr>
<tr>
  <td>phone:</td>
  <td>425 698 9332</td>
</tr>
<tr>
  <td>msn:</td>
  <td>drjflam@hotmail.com</td>
</tr>
<tr>
  <td>gtalk:</td>
  <td>drjflam@gmail.com</td>
</tr>
</table>
<br>
<h3>Syndicate</h3>

<p><a href="http://feeds.feedburner.com/LessIsBetter"><img src="/images/rss.png"/></a>&nbsp;
<a href="http://feeds.feedburner.com/LessIsBetter"><img src="http://feeds.feedburner.com/~fc/LessIsBetter?bg=FF9900&amp;fg=000000&amp;anim=0" height="26" width="88" style="border:0" alt="" /></a>
<br>
<form style="padding:3px;text-align:left;" action="http://www.feedburner.com/fb/a/emailverify" method="post" target="popupwindow" onsubmit="window.open('http://www.feedburner.com', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true"><p>Subscribe by email:</p><p><input type="text" style="width:140px" name="email"/></p><input type="hidden" value="http://feeds.feedburner.com/~e?ffid=180551" name="url"/><input type="hidden" value="Less is better" name="title"/><input type="submit" value="Subscribe" /><p>Delivered by <a href="http://www.feedburner.com/" target="_blank">FeedBurner</a></p></form>

</div>


      
<div class="sidebar-node">
    <div id="delicious">
    <h3><a href="http://del.icio.us/drjflam">del.icio.us/drjflam</a></h3>
            <ul>
      
      <li>
        <a href="http://www.people.iup.edu/pnwm/comparison.gif" title="Fun comparison of fictional starships from different SF shows.">Starship size comparison chart</a>
              </li>
      
      <li>
        <a href="http://www.teach12.com/" title="Bill Gates listens to the lectures from this company - available as downloads as well.">The Teaching Company</a>
              </li>
      
      <li>
        <a href="http://www.speedtest.net/" title="Found this via StumbleUpon">Speedtest.net - The Global Broadband Speed Test</a>
              </li>
      
      <li>
        <a href="http://wvs.topleftpixel.com/flash/cntower_timelapse.swf" title="Move your mouse around this picture and see it change.">Downtown Toronto Photo</a>
              </li>
      
      <li>
        <a href="ftp://gatekeeper.dec.com/pub/DEC/WRL/research-reports/WRL-TR-95.7.pdf" title="">Shared Memory Consistency Models</a>
              </li>
      
      <li>
        <a href="http://discuss.develop.com/archives/wa.exe?A2=ind0203B&amp;L=DOTNET&amp;P=R375" title="An excellent discussion on the motivation for and implementation of the CLR memory model.">Vance Morrison on CLR Memory Model</a>
              </li>
      
      <li>
        <a href="http://slideshare.net/" title="A YouTube like service for sharing slides from talks.">SlideShare</a>
              </li>
      
      <li>
        <a href="http://research.microsoft.com/manuvir/papers/instruction_level_tracing_VEE06.pdf" title="This is MSR's Nirvana framework for dynamically injecting tracing code into x86 binaries at runtime. It lets them travel forwards and backwards in execution flow ('time travel debugging').">Framework for Instruction-level Tracing and Analysis of Program Executions</a>
              </li>
      
      <li>
        <a href="http://www.macgeekery.com/hacks/software/video/how_to_view_tivo_recordings_on_your_mac_or_ipod" title="Looking forward to setting this up ...">How to View TiVo Recordings on Your Mac or iPod</a>
              </li>
      
      <li>
        <a href="http://uneasysilence.com/archive/2006/12/8602/" title="Wow - this is really nice seamless integration - Windows apps appearing to run as 'top-level' windows on Mac OS X desktop.">Parallels running IE7 &amp; Firefox on Mac OS X desktop!</a>
              </li>
      
      <li>
        <a href="http://www.ldc.upenn.edu/Catalog/CatalogEntry.jsp?catalogId=LDC2006T13" title="Google recently released their collection of 1-grams (single word frequency) to 5-grams (5 word frequency) as a 24GB compressed gzip'd file.">Google's collection of 1-5 grams</a>
              </li>
          </ul>
      </div>

</div>


      
<div class="sidebar-node">
  <h3>My Photos</h3>
<style type="text/css">
.zg_div {margin:0px 5px 5px 0px; width:117px;}
.zg_div_inner {background-color:#ffffff;  color:#666666; text-align:center; font-family:arial, helvetica; font-size:11px;}
.zg_div a, .zg_div a:hover, .zg_div a:visited {color:#3993ff; background:inherit !important; text-decoration:none !important;}
</style>
<script type="text/javascript">
zg_insert_badge = function() {
var zg_bg_color = 'ffffff';
var zgi_url = 'http://www.flickr.com/apps/badge/badge_iframe.gne?zg_bg_color='+zg_bg_color+'&zg_person_id=23649168%40N00';
document.write('<iframe style="background-color:#'+zg_bg_color+'; border-color:#'+zg_bg_color+'; border:none;" width="113" height="151" frameborder="0" scrolling="no" src="'+zgi_url+'" title="Flickr Badge"><\/iframe>');
if (document.getElementById) document.write('<div id="zg_whatlink"><a href="http://www.flickr.com/badge_new.gne"	style="color:#3993ff;" onclick="zg_toggleWhat(); return false;">what is this?<\/a><\/div>');
}
zg_toggleWhat = function() {
document.getElementById('zg_whatdiv').style.display = (document.getElementById('zg_whatdiv').style.display != 'none') ? 'none' : 'block';
document.getElementById('zg_whatlink').style.display = (document.getElementById('zg_whatdiv').style.display != 'none') ? 'none' : 'block';
return false;
}
</script>
<div class="zg_div"><div class="zg_div_inner"><a href="http://www.flickr.com">www.<strong style="color:#3993ff">flick<span style="color:#ff1c92">r</span></strong>.com</a><br>
<script type="text/javascript">zg_insert_badge();</script>
<div id="zg_whatdiv">This is a Flickr badge showing public photos from <a href="http://www.flickr.com/photos/23649168@N00">John Lam</a>. Make your own badge <a href="http://www.flickr.com/badge_new.gne">here</a>.</div>
<script type="text/javascript">if (document.getElementById) document.getElementById('zg_whatdiv').style.display = 'none';</script>
</div>
</div>

</div>


      
<div class="sidebar-node">
  
<h3>Archives</h3>
<ul id="archives">
  
    <li>
      <a href="/articles/2007/2">February 2007</a>
      <em>(1)</em>
    </li>
  
    <li>
      <a href="/articles/2007/1">January 2007</a>
      <em>(4)</em>
    </li>
  
    <li>
      <a href="/articles/2006/12">December 2006</a>
      <em>(2)</em>
    </li>
  
    <li>
      <a href="/articles/2006/11">November 2006</a>
      <em>(2)</em>
    </li>
  
    <li>
      <a href="/articles/2006/10">October 2006</a>
      <em>(8)</em>
    </li>
  
    <li>
      <a href="/articles/2006/9">September 2006</a>
      <em>(12)</em>
    </li>
  
    <li>
      <a href="/articles/2006/8">August 2006</a>
      <em>(39)</em>
    </li>
  
    <li>
      <a href="/articles/2006/7">July 2006</a>
      <em>(29)</em>
    </li>
  
    <li>
      <a href="/articles/2006/6">June 2006</a>
      <em>(23)</em>
    </li>
  
    <li>
      <a href="/articles/2006/5">May 2006</a>
      <em>(34)</em>
    </li>
  
    <li>
      <a href="/articles/2006/4">April 2006</a>
      <em>(13)</em>
    </li>
  
    <li>
      <a href="/articles/2006/3">March 2006</a>
      <em>(21)</em>
    </li>
  
    <li>
      <a href="/articles/2006/2">February 2006</a>
      <em>(25)</em>
    </li>
  
    <li>
      <a href="/articles/2006/1">January 2006</a>
      <em>(9)</em>
    </li>
  
    <li>
      <a href="/articles/2005/12">December 2005</a>
      <em>(22)</em>
    </li>
  
    <li>
      <a href="/articles/2005/11">November 2005</a>
      <em>(17)</em>
    </li>
  
    <li>
      <a href="/articles/2005/10">October 2005</a>
      <em>(6)</em>
    </li>
  
</ul>


</div>


      
<div class="sidebar-node">
  <h3>Tags</h3>
<p style="overflow:hidden">
<span style="font-size:66.6666666666667%"><a href="/articles/tag/barcampearthtoronto">BarCampEarthToronto</a></span>
<span style="font-size:129.87012987013%"><a href="/articles/tag/dynamiclanguages">DynamicLanguages</a></span>
<span style="font-size:66.6666666666667%"><a href="/articles/tag/ironpython">IronPython</a></span>
<span style="font-size:103.896103896104%"><a href="/articles/tag/life">Life</a></span>
<span style="font-size:66.6666666666667%"><a href="/articles/tag/mac">Mac</a></span>
<span style="font-size:66.6666666666667%"><a href="/articles/tag/marketing">Marketing</a></span>
<span style="font-size:77.9220779220779%"><a href="/articles/tag/microsoft">Microsoft</a></span>
<span style="font-size:66.6666666666667%"><a href="/articles/tag/parenting">Parenting</a></span>
<span style="font-size:66.6666666666667%"><a href="/articles/tag/photography">Photography</a></span>
<span style="font-size:66.6666666666667%"><a href="/articles/tag/platforms">Platforms</a></span>
<span style="font-size:200%"><a href="/articles/tag/props">Props</a></span>
<span style="font-size:66.6666666666667%"><a href="/articles/tag/python">Python</a></span>
<span style="font-size:200%"><a href="/articles/tag/ruby">Ruby</a></span>
<span style="font-size:200%"><a href="/articles/tag/rubyclr">RubyCLR</a></span>
<span style="font-size:66.6666666666667%"><a href="/articles/tag/rubyconf">RubyConf</a></span>
<span style="font-size:66.6666666666667%"><a href="/articles/tag/secondlife">SecondLife</a></span>
<span style="font-size:66.6666666666667%"><a href="/articles/tag/simplicity">simplicity</a></span>
<span style="font-size:200%"><a href="/articles/tag/thoughts">Thoughts</a></span>
<span style="font-size:66.6666666666667%"><a href="/articles/tag/vim">Vim</a></span>
<span style="font-size:66.6666666666667%"><a href="/articles/tag/workspaces">workspaces</a></span>
</p>


</div>


      
<div class="sidebar-node">
  <h3>Categories</h3>
<ul id="categories">
  
  <li><a href="/articles/category/personal">Life</a> <em>(20)</em></li>
  
  
  <li><a href="/articles/category/links">Props</a> <em>(58)</em></li>
  
  
  <li><a href="/articles/category/thoughts">Thoughts</a> <em>(148)</em></li>
  
</ul>


</div>


  


    </div>
    <br style="clear:both;" />
  </div>

  <div id="footer">
    <hr />
    <p><a href="/">Less is better</a></p>
    <ul>
      <li>powered by <a href="http://typosphere.org">typo</a> /
          styled with <a href="http://quotedprintable.com/pages/scribbish">scribbish</a></li>
    </ul>
  </div>
</div>
</body>
</html>
