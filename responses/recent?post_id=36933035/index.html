{"post_id":36933035,"html":"\u003Cdiv class='p_response_container' style='display:none;'\u003E\n\u003Cheader class='clearfix'\u003E\n\u003Ca href=\"http://iunknown.com/2006/04/what-are-you-going-to-use-rubyclr-for.html\" class=\"p_view_all_link\"\u003EView All 8\u003C/a\u003E\n\u003Ch1\u003EMost Recent Responses\u003C/h1\u003E\n\u003C/header\u003E\n\u003Cdiv class='p_responses_list clearfix' data-posterous-responses-container\u003E\n\u003Carticle class='p_comment p_response' style='display:none;'\u003E\n\u003Cdiv class='p_info'\u003E\n\u003Cspan class='p_icon'\u003E\u003C/span\u003E\n\u003Ctime pubdate='1145040448'\u003Eabout 7 years ago\u003C/time\u003E\nJohn Lam responded:\n\u003C/div\u003E\n\u003Cdiv class='p_comment_body'\u003E\n\u003Cdiv class='p_profile_photo'\u003E\n\u003Cimg alt=\"\" src=\"/images/profile/missing-user-35.png?1367517938\" /\u003E\n\u003C/div\u003E\n\u003Cdiv class='p_comment_text'\u003E\nThanks for the encouragement, Matt! Now that I've welcomed the newest addition to my family (MacBook Pro) I can get back to the more serious business of shipping drop 4.\u003Cbr /\u003EAs for MSFT, I'm perfectly happy where I am now. But if they make me an offer I can't refuse ... :)\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cul class='p_action_links'\u003E\n\u003C/ul\u003E\n\n\u003C/article\u003E\n\n\u003Carticle class='p_comment p_response' style='display:none;'\u003E\n\u003Cdiv class='p_info'\u003E\n\u003Cspan class='p_icon'\u003E\u003C/span\u003E\n\u003Ctime pubdate='1145316239'\u003Eabout 7 years ago\u003C/time\u003E\nSam responded:\n\u003C/div\u003E\n\u003Cdiv class='p_comment_body'\u003E\n\u003Cdiv class='p_profile_photo'\u003E\n\u003Cimg alt=\"\" src=\"/images/profile/missing-user-35.png?1367517938\" /\u003E\n\u003C/div\u003E\n\u003Cdiv class='p_comment_text'\u003E\nI used RubyCLR to write a process that hands off data to a SqlBulkCopy for quick inserts into the database. It's fast. It's simple. Since most of it's in Ruby, I can actually wrap my head around the overall design.\u003Cbr /\u003EThanks!\u003Cbr /\u003EThe only major pain I had was this:\u003Cbr /\u003Edt = System::Data::DataTable.new\u003Cbr /\u003E@column_names.each { |column_name| dt.Columns.Add(System::Data::DataColumn.new(column_name.to_s)) }\u003Cbr /\u003E@data.each do |elements|\u003Cbr /\u003Erow = dt.new_row\u003Cbr /\u003E@column_names.each_index do |i|\u003Cbr /\u003Evalue = elements[i]\u003Cbr /\u003Eunless value.nil?\u003Cbr /\u003Erow[i] = value.to_s\u003Cbr /\u003Eend\u003Cbr /\u003Eend\u003Cbr /\u003Edt.rows.add(row)\u003Cbr /\u003Eend\u003Cbr /\u003ESince I couldn't figure out how to pass NULL (and nil didn't seem to work), it eventually occurred to me (after about an hour :o ) to just avoid setting those fields.\u003Cbr /\u003EKnowing how to pass a NULL would've made it easier, but I'm more happy with the final result, so win-win I guess. Thanks again for the work!\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cul class='p_action_links'\u003E\n\u003C/ul\u003E\n\n\u003C/article\u003E\n\n\u003Carticle class='p_comment p_response' style='display:none;'\u003E\n\u003Cdiv class='p_info'\u003E\n\u003Cspan class='p_icon'\u003E\u003C/span\u003E\n\u003Ctime pubdate='1145426420'\u003Eabout 7 years ago\u003C/time\u003E\nJohn Lam responded:\n\u003C/div\u003E\n\u003Cdiv class='p_comment_body'\u003E\n\u003Cdiv class='p_profile_photo'\u003E\n\u003Cimg alt=\"\" src=\"/images/profile/missing-user-35.png?1367517938\" /\u003E\n\u003C/div\u003E\n\u003Cdiv class='p_comment_text'\u003E\nSam, thanks for this bugrep. I beefed up the marshaling code to correctly account for NULL values. The current builds now work correctly with nil values. I don't account for CLR V2 nullable types yet, but that's on the list :)\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cul class='p_action_links'\u003E\n\u003C/ul\u003E\n\n\u003C/article\u003E\n\n\u003C/div\u003E\n\u003Cdiv class='p_comment_form p_logged_in'\u003E\n\u003Ch1\u003ELeave a Comment\u003C/h1\u003E\n\u003Cform action=\"/responses/create\" class=\"new_comment clearfix\" id=\"new_comment\" method=\"post\"\u003E\u003Cdiv style=\"margin:0;padding:0;display:inline\"\u003E\u003Cinput name=\"authenticity_token\" type=\"hidden\" value=\"K5qluXl5HOIU9bWdq9oJYrEuVokj7nLG7aYeXTLdHqg=\" /\u003E\u003C/div\u003E\n\u003Cdiv class='p_not_authorized p_comment_section'\u003E\n\u003Cdiv class='p_additional_fields'\u003E\n\u003Clabel for=\"comment_name\"\u003EName:\u003C/label\u003E\n\u003Cinput id=\"comment_name\" maxlength=\"80\" name=\"comment[name]\" size=\"40\" type=\"text\" /\u003E\n\u003Clabel class=\"p_comment_email\" for=\"comment_comment_email\"\u003ELeave this field blank to comment.\u003C/label\u003E\n\u003Cinput class=\"p_comment_email\" id=\"comment_comment_email\" maxlength=\"80\" name=\"comment[comment_email]\" size=\"40\" type=\"text\" /\u003E\n\u003Clabel for=\"comment_toast\"\u003EEmail:\u003C/label\u003E\n\u003Cinput id=\"comment_toast\" maxlength=\"80\" name=\"comment[toast]\" size=\"40\" type=\"text\" /\u003E\n\u003Clabel for=\"comment_url\"\u003EHomepage:\u003C/label\u003E\n\u003Cinput id=\"comment_url\" maxlength=\"80\" name=\"comment[url]\" size=\"40\" type=\"text\" /\u003E\n\u003C/div\u003E\n\u003Caside class='p_login_options'\u003E\n\u003Cdiv class='p_asterisk'\u003E\u003C/div\u003E\n\u003Ch1\u003EWant to skip this stuff?\u003C/h1\u003E\n\u003Cp\u003ELogin with any of the following:\u003C/p\u003E\n\u003Cdiv class='p_login_buttons'\u003E\n\u003Ca href=\"http://posterous.com/login?flow=newcomment\u0026amp;jumpto=http%3A%2F%2Fiunknown.com%2F2006%2F04%2Fwhat-are-you-going-to-use-rubyclr-for.html%23comment\" class=\"p_posterous_login\"\u003ERegister or login to Posterous\u003C/a\u003E\n\u003Ca href=\"#\" class=\"p_twitter_login\" data-posterous-jumpto-url=\"http://iunknown.com/2006/04/what-are-you-going-to-use-rubyclr-for.html#comment\" data-posterous-post-id=\"36933035\" data-posterous-redirect-url=\"http://posterous.com/oauth/init_oauth_and_redirect/?ssod=iunknown.com\u0026amp;oauth_provider_type=\" data-posterous-twitter-login-button=\"true\"\u003E\u003Cimg alt=\"Sign in with Twitter\" src=\"/images/site/sign_in_with_twitter.png?1367517938\" /\u003E\u003C/a\u003E\n\u003C/div\u003E\n\n\u003C/aside\u003E\n\u003C/div\u003E\n\u003Cdiv class='p_comment_section'\u003E\n\u003Clabel for=\"comment_body\"\u003EComment:\u003C/label\u003E\n\u003Cdiv class='p_comment_area'\u003E\n\u003Ctextarea cols=\"40\" id=\"comment_body\" name=\"comment[body]\" onChange=\"if (this.scrollHeight \u0026gt; this.clientHeight \u0026amp;\u0026amp; !window.opera){this.rows += 1;}\" onKeyPress=\"if (this.scrollHeight \u0026gt; this.clientHeight \u0026amp;\u0026amp; !window.opera){this.rows += 1;}\" rows=\"5\"\u003E\u003C/textarea\u003E\n\u003C/div\u003E\n\u003C/div\u003E\n\u003Cdiv class='p_comment_section'\u003E\n\u003Cinput id=\"comment_post_id\" name=\"comment[post_id]\" type=\"hidden\" value=\"36933035\" /\u003E\n\u003Cdiv class='p_submit'\u003E\u003Cbutton button=\"true\" class=\" action_button\"\u003E\u003Cspan class=\"\"\u003EPost this Comment\u003C/span\u003E\u003C/button\u003E\u003C/div\u003E\n\u003C/div\u003E\n\u003C/form\u003E\n\u003C/div\u003E\n\n\u003C/div\u003E\n","responses":[{"name":"John Lam","body_html":"Thanks for the encouragement, Matt! Now that I've welcomed the newest addition to my family (MacBook Pro) I can get back to the more serious business of shipping drop 4.\u003Cbr /\u003EAs for MSFT, I'm perfectly happy where I am now. But if they make me an offer I can't refuse ... :)","created_at":"2006/04/14 11:47:28 -0700","body":"Thanks for the encouragement, Matt! Now that I've welcomed the newest addition to my family (MacBook Pro) I can get back to the more serious business of shipping drop 4.\nAs for MSFT, I'm perfectly happy where I am now. But if they make me an offer I can't refuse ... :)\n","post_id":36933035,"id":6478076,"display_name":"John Lam","comment_type":"comment","display_url":null,"allowed":true,"display_photo":"/images/profile/missing-user-35.png"},{"name":"Sam","body_html":"I used RubyCLR to write a process that hands off data to a SqlBulkCopy for quick inserts into the database. It's fast. It's simple. Since most of it's in Ruby, I can actually wrap my head around the overall design.\u003Cbr /\u003EThanks!\u003Cbr /\u003EThe only major pain I had was this:\u003Cbr /\u003Edt = System::Data::DataTable.new\u003Cbr /\u003E@column_names.each { |column_name| dt.Columns.Add(System::Data::DataColumn.new(column_name.to_s)) }\u003Cbr /\u003E@data.each do |elements|\u003Cbr /\u003Erow = dt.new_row\u003Cbr /\u003E@column_names.each_index do |i|\u003Cbr /\u003Evalue = elements[i]\u003Cbr /\u003Eunless value.nil?\u003Cbr /\u003Erow[i] = value.to_s\u003Cbr /\u003Eend\u003Cbr /\u003Eend\u003Cbr /\u003Edt.rows.add(row)\u003Cbr /\u003Eend\u003Cbr /\u003ESince I couldn't figure out how to pass NULL (and nil didn't seem to work), it eventually occurred to me (after about an hour :o ) to just avoid setting those fields.\u003Cbr /\u003EKnowing how to pass a NULL would've made it easier, but I'm more happy with the final result, so win-win I guess. Thanks again for the work!","created_at":"2006/04/17 16:23:59 -0700","body":"I used RubyCLR to write a process that hands off data to a SqlBulkCopy for quick inserts into the database. It's fast. It's simple. Since most of it's in Ruby, I can actually wrap my head around the overall design.\nThanks!\nThe only major pain I had was this:\ndt = System::Data::DataTable.new\n@column_names.each { |column_name| dt.Columns.Add(System::Data::DataColumn.new(column_name.to_s)) }\n@data.each do |elements|\nrow = dt.new_row\n@column_names.each_index do |i|\nvalue = elements[i]\nunless value.nil?\nrow[i] = value.to_s\nend\nend\ndt.rows.add(row)\nend\nSince I couldn't figure out how to pass NULL (and nil didn't seem to work), it eventually occurred to me (after about an hour :o ) to just avoid setting those fields.\nKnowing how to pass a NULL would've made it easier, but I'm more happy with the final result, so win-win I guess. Thanks again for the work!\n","post_id":36933035,"id":6478077,"display_name":"Sam","comment_type":"comment","display_url":null,"allowed":true,"display_photo":"/images/profile/missing-user-35.png"},{"name":"John Lam","body_html":"Sam, thanks for this bugrep. I beefed up the marshaling code to correctly account for NULL values. The current builds now work correctly with nil values. I don't account for CLR V2 nullable types yet, but that's on the list :)","created_at":"2006/04/18 23:00:20 -0700","body":"Sam, thanks for this bugrep. I beefed up the marshaling code to correctly account for NULL values. The current builds now work correctly with nil values. I don't account for CLR V2 nullable types yet, but that's on the list :)\n","post_id":36933035,"id":6478078,"display_name":"John Lam","comment_type":"comment","display_url":null,"allowed":true,"display_photo":"/images/profile/missing-user-35.png"}]}