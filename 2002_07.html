<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>iunknown.com: July 2002 Archives</title>

<link rel="stylesheet" href="http://www.iunknown.com/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.iunknown.com/index.rdf" />
<link rel="start" href="http://www.iunknown.com/" title="Home" />
<link rel="prev" href="http://www.iunknown.com/2002_06.html" title="June 2002" />

<link rel="next" href="http://www.iunknown.com/2002_08.html" title="August 2002" />


<script language="javascript" type="text/javascript">
function OpenComments (c) {
    window.open(c,
                    'comments',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}
</script>

</head>

<body>	

<div id="banner">
<h1><a href="http://www.iunknown.com/" accesskey="1"><img src="/mt-static/images/iunknown.png" width="350" height="60" border="0"></a></h1>
<span class="description">Home of the Practical Eye for the .NET Guy</span>
</div>

<div id="container">

<div class="blog">

<div id="menu">
<a href="http://www.iunknown.com/2002_06.html">&laquo; June 2002</a> |

<a href="http://www.iunknown.com/">Main</a>
| <a href="http://www.iunknown.com/2002_08.html">August 2002 &raquo;</a>

</div>

</div>

<div class="blog">


<h2 class="date">July 28, 2002</h2>


<div class="blogbody">
<a name="000133"></a>
<h3 class="title">Royal Botanical Gardens</h3>

<p><P>We went to <A href="http://www.jamessidney.com">James Sidney's</A> one day introduction to photography workshop today. It was an excellent class; we both learned tons about photography today. The most important thing that I learned today was the importance of simplicity in photographs. Photographs should convey the strongest possible message, and you get there by subtracting as many distracting elements as possible from your photograph. </P><br />
<P>The class took place at the <A href="http://www.rbg.ca/">Royal Botanical Gardens</A> just outside of Burlington, Ontario. It's a beautiful place, and totally lucked out when the torrential thunderstorm that we drove through this morning to get there let up and was replaced by clear blue skies. Here's a link to <A href="http://www.pbase.com/jlam/royal_botanical_gardens">the gallery of photos that I took today</A>. James gave us some interesting exercises in <A href="http://www.pbase.com/image/3429127">capturing</A> <A href="http://www.pbase.com/image/3429129">motion</A> in photographs. I also really lucked out when a dragon fly sat and <A href="http://www.pbase.com/image/3429136">posed for almost 10 minutes</A> as I took photos of him on a flower.</P><br />
<P>All in all, a very enjoyable day. Go take a class from James!</P></p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000133.html">07:57 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=133" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
	
</div>

</div>



<h2 class="date">July 21, 2002</h2>


<div class="blogbody">
<a name="000132"></a>
<h3 class="title">I love PBase.com</h3>

<p><P>I've been toying with the idea of building a WinForms app that would let me publish my digital photographs to the web. I even went as far as building a simple ASP.NET WinForms host so that I could use ASP.NET to generate my photo galleries. But <A href="AOP/fog0000000115.html">CLAW</A> makes it difficult to have more than one hobby, so I began to look around for alternatives.</P><br />
<P>I recently discovered <A href="http://www.pbase.com">PBase</A>. This is a web app that lets you upload a bunch of digital photographs and very quickly publish them to the web. There's a bunch of really great convenience features that makes publishing photographs a snap. </P><br />
<P>As a test, I took a bunch of photographs that I took yesterday, and fed them to Adobe Photoshop Elements (this shipped with my camera). There's a nice batch mode that you can use to trim down the size of your photographs for publication to the web. I selected the default 150dpi setting for my otherwise monstrous 2560 x 1920 images. This trimmed my average image size down from roughly 1.5MB to 200K.</P><br />
<P>Next, I zipped up the images and fed them to PBase. Their server software rocks. It unzips your images, drops them into a gallery, generates thumbnails as well as small, medium, and large resized images. To see it in action, <A href="http://www.pbase.com/jlam">check out my account on PBase</A>. So far I've only got one gallery in there, but I plan on adding more (I've already shot over 200 photos with my CoolPix 5700).</P><br />
<P>PBase is currently free. I have no idea how they can afford to run a bandwidth hungry service like that without charging for it. But I'd be more than happy to throw some money their way to pay for their service. This is a great example of a web app that works. That said, I really want a classic Windows app to use as a front-end. I accidentally messed up my folder settings something awful using their HTML-based UI. But given their market constraints (this is a classic example of a horizontal app), I'm more than happy with the solution that they provide. Well done!</P></p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000132.html">04:58 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=132" onclick="OpenComments(this.href); return false">Comments (3)</a>
	
	
</div>

</div>



<h2 class="date">July 19, 2002</h2>


<div class="blogbody">
<a name="000131"></a>
<h3 class="title">Fun with digital cameras</h3>

<p><P>We&nbsp;received our new <A href="http://www.dpreview.com/articles/nikoncp5700/">Coolpix 5700</A> this past Saturday. It's going to replace my older <A href="http://www.dpreview.com/reviews/nikoncp950/">Coolpix 950</A> as our main camera. I'm trying to learn how to take better photographs these days, and there's quite a lot of useful resources on the web.</P><br />
<P>If you've got a Coolpix 9xx camera, you can't go wrong with <A href="http://www.cs.mtu.edu/~shene/">Ching-Kuang Shene's</A> most excellent <A href="http://www.cs.mtu.edu/~shene/DigiCam/index.html">digital camera users' guides</A>. These are the users guides that Nikon should have shipped with their cameras. The reference manuals that are supplied certainly tell you <EM>how</EM> to set the myriad various features of the digital camera, but they don't tell you <EM>why</EM> you should set them certain ways. Best of all, Ching-Guang's guides are free.</P><br />
<P>I also stumbled across&nbsp;Peter iNova's <A href="http://www.digitalsecrets.net/">Digital Secrets site</A>&nbsp;after lurking for a while in the <A href="http://www.dpreview.com/forums/forum.asp?forum=1007">Nikon Talk forum</A> on <A href="http://www.dpreview.com/misc/about.asp">Phil Askey's</A> most excellent <A href="http://www.dpreview.com">Digital Photography Review</A> web site. The members of that forum highly recommended Peter's <A href="http://www.digitalsecrets.net/secrets/s.html">Mastering Nikon Digital Cameras e-Book</A>, so I ordered a copy. The teasers on his web site for his e-Book are just awesome.</P><br />
<P>Since I teach others for a living, I realize the value that can come from taking a class. So we signed up for <A href="http://www.jamessidney.com/">James Sidney's</A> one-day <A href="http://www.weekendtrips.com/trips/daytrips/intro_photo_dt0039.html">photography workshop</A> in Burlington. This guy can really make Flash rock. His free tutorials on his site are what convinced me to sign up.</P></p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000131.html">12:42 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=131" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
	
</div>

</div>



<h2 class="date">July 16, 2002</h2>


<div class="blogbody">
<a name="000130"></a>
<h3 class="title">Terence Parr rocks</h3>

<p><P>While writing the weave expression parser for CLAW, I ran into some problems with resolving potential ambiguities in my ANTLR grammar. I posted an email to the ANTLR-Interest mailing list, and <A href="http://www.codetransform.com">Monty Zukowski</A> pointed me to <A href="http://www.parr-research.com/%7Eparrt/">Terence Parr's</A> most excellent online book: <A href="http://www.antlr.org/book/index.html">Practical Computer Language Recognition and Translation</A>. The chapter on building recognizers by hand is particularly illuminating. Make sure to read the section where he uses a maze metaphor to explain look-ahead and back-tracking. </P><br />
<P>Currently, it looks like I can use the token stream filtering feature of ANTLR to morph my "*" tokens into unambiguous tokens that can be handled by my parser. My token stream can maintain context, and use that to disambiguate the different meanings of "*" in my weave expressions.</P><br />
<P>Have I mentioned that <A href="http://www.antlr.org">ANTLR</A> rocks? ;)</P></p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000130.html">03:10 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=130" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
	
</div>

</div>



<h2 class="date">July 14, 2002</h2>


<div class="blogbody">
<a name="000129"></a>
<h3 class="title">Visual Assist Rocks</h3>

<p>I just purchased my copy of <A href="http://www.wholetomato.com/downloads/index.shtml">Visual Assist.NET</A> from <A href="http://www.wholetomato.com">Whole Tomato Software</A> today. It's a better Intellisense for VS.NET. And man, does this tool rock. It saves typing type enormously, and its "predict what I'm going to type" feature is worth the $79 price of admission alone. Throw in Intellisense for STL that really works and you've got a great productivity enhancer. I'm <EM>very</EM> happy with this product.</p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000129.html">01:24 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=129" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
	
</div>

</div>





<div class="blogbody">
<a name="000128"></a>
<h3 class="title">Wintellect retreat</h3>

<p><P>On Tuesday and Wednesday of last week, we had our annual <A href="http://www.wintellect.com">Wintellect</A> retreat. The purpose of our retreat was to share technical knowledge with each other, and to discuss business matters and future directions of the company. Looking back on the retreat, I'm amazed at the amount that we got accomplished on both fronts in such a short period of time. </P><br />
<P>One of the benefits of working in such a small company is the tight-knit nature of the team. I can't remember the last time that I laughed so much during a technical conference.&nbsp;We definitely bonded as a company, and I'm really excited about the future that lies ahead of us. Here's our company picture:</P><SPAN><br />
<CENTER><IMG height=480 alt=[Image] hspace=4 src="Images/Wintellect.jpg" width=620 border=0 cd:pos="0"><BR clear=all></CENTER><br />
<P>Back row (l-r):</P><br />
<P>Dan Fergus, Berni McCoy, Chris Shelby (obscured by some guy with a giant head), Jason Clark, Brent Rector, Jeff Prosise, Paula Daniels</P><br />
<P>Middle row:</P><br />
<P>Francesco Balena, John Lam, Lewis Frazier</P><br />
<P>Front row:</P><br />
<P>Petter DeBetta, John Robbins, Jeffrey Richter, Kenn Scribner</SPAN><SPAN></P></SPAN></p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000128.html">11:57 AM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=128" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
	
</div>

</div>





<div class="blogbody">
<a name="000127"></a>
<h3 class="title">Expedia nightmare resolved</h3>

<p><P>I've been out of town for a while. In an earlier entry, I recounted my <A href="Weblog/PoorCustomerServiceatExpe.html">nightmare experience with Expedia customer support</A>. To their credit, one of their most excellent executive customer service representatives contacted me by telephone on Monday, and resolved all of my travel problems over the phone. She was professional and&nbsp;very understanding of the problems that I encountered. The net result of our conversation was:</P><br />
<UL><br />
<LI>Expedia will handle the paperwork associated with obtaining a credit with United Airlines</LI><br />
<LI>Expedia offered to pay the change fee associated with my credit on United Airlines</LI><br />
<LI>Expedia will reprimand the customer care rep who originally caused me so much grief in the first place</LI></UL><br />
<P>I really appreciated that they went the extra mile in dealing with my travel problems. The lesson that I learned here is that it is very important to not judge an entire organization based on your interaction with one (or even more) of their employees. As a wise man once told me, "we all make mistakes; it's what we do about them that counts".</P></p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000127.html">11:47 AM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=127" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
	
</div>

</div>



<h2 class="date">July 13, 2002</h2>


<div class="blogbody">
<a name="000126"></a>
<h3 class="title">Hello, ANTLR</h3>

<p><P>After spending some quality time with <A href="http://www.gnu.org/software/flex/flex.html">Flex</A> and <A href="http://www.gnu.org/software/bison/bison.html">Bison</A>, I quickly ran into the limitations of these tools.&nbsp;They are C-era tools, that are designed to generate C language lexers and parsers. While it is certainly true that Flex has a generate a C++ lexer option,&nbsp;I found that it was largely useless since it doesn't integrate easily with Bison-generated parsers. Also, building meaningful error messages into my generated lexers and parsers was an exercise in frustration.</P><br />
<P>Some readers of my weblog noticed my frustration, and pointed me to <A href="http://www.antlr.org">ANTLR</A>.[1] This tool&nbsp;generates C++ and Java lexers and parsers. However, unlike Bison which consumes LALR grammars and generates the corresponding parser, ANTLR consumes LL(k) grammars. If you're used to writing LALR grammars, writing LL(k) grammars, is, uh, <EM>different</EM>. </P><br />
<P>My experience in rewriting my LALR grammars as LL(k) grammars was fairly straightfoward. There are <A href="http://javadude.com/articles/antlrtut/">some</A> <A href="http://www.milk.com/kodebase/antlr-tutorial/">ANTLR</A> <A href="http://www.antlr.org/articles.html">tutorials</A> on the web that greatly help to reduce the amount of pain that you will feel during this process. ANTLR's documentation is definitely intended to be a reference manual, and not as a learning aid. This is both its strength and its weakness; if you are serious about building parsers using ANTLR, you will find these docs invaluable.</P><br />
<P>So far so good. I've got the core text parsing components of CLAW up and running now using ANTLR. I'm currently converting my console-mode test cases to use CppUnit, and integrating my parsing code into the core codebase of CLAW. </P><br />
<P>[1] Thanks so much to <A href="http://life.strangesearch.net">Dan Dunham</A> for being the first to write in about ANTLR.</P></p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000126.html">03:08 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=126" onclick="OpenComments(this.href); return false">Comments (1)</a>
	
	
</div>

</div>



<h2 class="date">July 05, 2002</h2>


<div class="blogbody">
<a name="000125"></a>
<h3 class="title">Open source</h3>

<p><P>After my recent entry titled <A href="Weblog/Thank-youMicrosoft.html">"Thank-you, Microsoft"</A>, I got some interesting email from the Open Source community. That entry was meant to <EM>encourage</EM> Microsoft to continue to release source code for its products. It was all part of the beginnings of my open source epiphany.[1]</P><br />
<P><A href="http://primates.ximian.com/~miguel/">Miguel de Icaza</A> sent me a very nice email encouraging me to continue to think about Open Source. He related his personal experiences with GNU software and Linux. I think that Miguel represents the absolute best in the Open Source community. I have nothing but&nbsp;good things to say about my interactions with Miguel over the past year. He's a true gentleman.</P><br />
<P>Earlier this evening, I got an email from <A href="http://members.verizon.net/~vze2552x/">Rich Salz</A>. The tone of his email was condescending and confrontational. In his email, Rich was wondering why I wasn't thanking <A href="http://www.stallman.org/">Richard Stallman</A> if I were thanking Microsoft.[2] Unfortunately, Rich represents the part of the Open Source community that I could do without. Emails like his do not make me want to learn more about Open Source and to contribute my efforts.</P><br />
<P>For the record, I like Open Source. I've contributed a few patches here and there to various Open Source projects that I've been using recently in my work. However, I don't take a religious stand on Open Source vs. Closed Source. I like the freedom to choose what I want to work on, and would push back against anybody who tried to impose their belief system on me.</P><br />
<P>[1] Here's an excerpt from a recent post that I made on the Win_Tech_Off_Topic mailing list:</P><br />
<BLOCKQUOTE><br />
<P>"I think an interesting angle to approach this argument is: "What is the benefit of source code?" To me this implies two things: </P><br />
<OL><br />
<LI>It makes it easier to understand the code<br />
<LI>It makes it possible to modify the code </LI></OL><br />
<P>I love goal #1. I think it would *totally rock* if MS distributed a build environment for Windows, like they're doing for the CLR via ROTOR. In my somewhat limited experience with ROTOR, I've found that being able to step through the runtime has helped enormously in my understanding of how my code must interact with the CLR.</P><br />
<P>MS can protect their important IP by releasing a crappier thread scheduler etc. for Windows much like they did with [the GC in] Rotor and still help tremendously with goal #1. As for goal #2, this would be very interesting as it would encourage experimentation by the community. License agreements and lawyers would handle the "you're stealing my IP" issues for a large company like MS (e.g. Larry Ellison decides to bundle Windows with Oracle). </P><br />
<P>I think that only really large companies would benefit from this, however. Small companies simply don't have the money to fight a protracted legal battle over stolen IP rights."</P></BLOCKQUOTE><br />
<P>[2] I would be thanking Richard Stallman if my code directly interacted wth code that he had written, but CLAW doesn't need to talk to GNU grep or Emacs.</P></p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000125.html">10:14 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=125" onclick="OpenComments(this.href); return false">Comments (0)</a>
	
	
</div>

</div>



<h2 class="date">July 04, 2002</h2>


<div class="blogbody">
<a name="000124"></a>
<h3 class="title">Poor customer service at Expedia.com</h3>

<p><P>Please excuse this interruption in your regularly scheduled technical weblog. I need to vent.</P><br />
<P>I just had the worst customer experience that I can recall. And it has to do with my treatment at the hands of Expedia. Along the way I learned quite a lot about exactly what your rights are as a consumer at the hands of Internet retailers and what, if anything, you can do to protect your rights. </P><br />
<P>I'm writing this entry for a couple of reasons. The first is to calm myself down after an extremely frustrating morning. The second is to share my story in hopes that this might help others who find themselves in a similar situation.</P><br />
<P>My story begins on June 16. On that day, I went to Expedia.com to book my flight for an upcoming business trip. I recall the evening well; we were at my parent's house and were about to leave for dinner. I suddenly remembered that I needed to book my flights to take advantage of the 21 day advance fare. So I went online and booked the flights. The transaction went smoothly, took only a few minutes and we went out for a great dinner.</P><br />
<P>Fast forward to this morning. I went back through my email archives looking for my confirmation email from Expedia about the trip. There was none there. Now, I was worried. It has happened in the past that I researched ticket fares but forgot to purchase the ticket. So I logged onto Expedia, and discovered that I had booked the flight on Expedia.ca (I live in Canada). After logging onto Expedia.ca, I found my itinerary. That's when the horror story begins.</P><br />
<P>There was something seriously wrong with my itinerary. I had originally planned to fly from Toronto to Knoxville, TN the evening of July 8, returning the morning of July 11. In American, that's 7/8/02 to 7/11/02. However, when I looked at my itinerary, it showed me leaving 7-Aug-02 and returning 7-Nov-02! In American that's 8/7/02 and 11/7/02. Clearly the itinerary had the month and the day digits transposed. </P><br />
<P>Now here's the problem: I have absolutely no evidence that I correctly booked the ticket for the dates that I had requested. I didn't have a print out of my itinerary because I was expecting Expedia to send me a confirmation email like they always did. In hindsight I now realize that it was clearly a mistake to trust that they would send me a confirmation email.</P><br />
<P>Today is only four days before my flight was supposed to leave. I called Expedia's customer support department, and talked to an agent. She couldn't help me, so she forwarded me to someone in their Customer Care department. I talked to the second woman. She quickly got up to speed with my problem and we began discussing possible remedies. I explained to her that I had no evidence from Expedia that I had purchased a ticket for travel on the dates requested. I asked if she could explain why their computers had not sent me a confirmation email. Furthermore, I asked if anyone else had experienced these problems. She replied quite belligerently that "their computers work". When I asked for proof, she replied that "she knew that they worked". </P><br />
<P>When I asked what they could do about it, she told me that they would assess me a change fee plus any difference in fares. This was the only time that I lost my cool. I replied "Well the airline's going to screw me over on the fare because it's now only 4 days before departure. That ticket will be $2000+ CDN!". She seemed to take offense to the my saying "screw me over" and scolded me for being "unprofessional". She then testily asked "well do you want me to bother checking what that will cost?" When I said yes, she then put me on hold <EM>immediately.</EM></P><br />
<P>The time was 11:50 EST. After being on hold for a couple of minutes, I decided to look up the fare for myself. That took about 2 minutes to get the result: $2029.00 CDN as I had suspected. The hold music played on my speakerphone until 11:58. I stayed on the now silent line for an additional three minutes until 12:01. That was when I hung up and called again, hoping to speak to a different rep. </P><br />
<P>To say that I was mad at this point would be an understatement. It should not take an experienced Customer Care representative 11+ minutes to look up a flight on Expedia, right? Not when a customer&nbsp;can do it in 2 minutes. I have a voice mail from that same Customer Care representative at 12:05 calling back, wondering why we were disconnected. At that point, I was talking to other representatives at Expedia.</P><br />
<P>Once again&nbsp;I called back in. The front line agent couldn't help, and referred me to a Customer Care representative. The second Customer Care rep that I spoke to was much more professional, but could not help me resolve my problems. I then requested to speak to a supervisor at their call center. She was equally professional, but she also lacked the authority to solve my problem. But she did refer me to her boss, Rick Robertson, who is the Director of Customer Service at Expedia (425 564 7200). </P><br />
<P>I tried to call Rick today, but of course, it's July 4th in the US so nobody was around to take my call. I left a voice mail, and am now awaiting a reply.</P><br />
<P>To summarize what happened here, there were a number of safeguards that failed.</P><br />
<UL><br />
<LI>Expedia.com failed to send me an email confirmation with my itinerary<br />
<LI>I failed to print out the confirmation web page on Expedia.com<br />
<LI>I failed to request a printed copy of my itinerary and a paper receipt.</LI></UL><br />
<P>I realize that it is entirely possible that I had made a mistake in transposing those digits. However, the confirmation page on Expedia clearly displays the month of the departure date as a three-letter abbreviation and not a number. I find it <EM>unlikely</EM> that I would have looked at that page when reviewing my itinerary and failed to have spotted that. However, if I am presented with reasonable proof that this was what I had indeed selected, and that I had been negligent in reviewing my final itinerary before purchase, I would be happy to pay for my own mistake.</P><br />
<P>However, I don't have an email from Expedia that confirms my itinerary. In fact, I have <EM>nothing</EM> but my recorded itinerary on Expedia's web site as proof. If this were a case of a bug resulting in the transposition of those digits, I would have absolutely no way of proving the existence of this bug. An email or a piece of paper from Expedia would have proved this to my satisfaction. But no email or piece of paper was ever sent from Expedia.</P><br />
<P>I tried getting some help from Visa. However, their customer service reps told me that since I had a pre-existing account with Expedia, that they could not do anything to recover the funds. In other words, the fact that Expedia is holding onto my credit card number means that if they mistakenly charged me for a product that I would have to take it up with Expedia to get my money back! Visa only normally intervenes in cases where I can claim that I did not give a merchant my credit card number. This was not the what happened in this case. I <EM>wanted </EM>to do that transaction. It's just that I didn't get what I thought that I had paid for.</P><br />
<P>So, what's the take home lesson here?</P><br />
<UL><br />
<LI>Always get some kind of paper or electronic back-up for your purchases. A clear audit trail here will help you tremendously in case a dispute ever comes up.<br />
<LI>Do not assume that your credit card company will go to bat for you if you dispute a charge.<br />
<LI>Watch out for places that keep your credit card number on file. Remember that this is treated as a "pre-authorized" merchant, even if you never signed for it.<br />
<LI>Patiently and politely escalate your complaint with the merchant. </LI></UL><br />
<P>The jury is still out on Expedia's customer service. All I want from Expedia is the following:</P><br />
<UL><br />
<LI>An apology from the customer service rep who treated me rudely, and from her supervisor(s).<br />
<LI>Proof that I had entered the dates incorrectly, in which case I would accept a credit with United Airlines.<br />
<LI>In the absence of proof that I had entered the dates incorrectly, a simple voiding of the transaction.</LI></UL><br />
<P>That's it. After this experience, I'm not sure whether I would ever do business with Expedia again. I realize that it would be wrong of me to boycott a company based on the actions of just one of their reps; everyone else I talked to from Expedia treated me with professionalism and respect. However, my faith in the system has been severely shaken. </P></p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000124.html">04:55 PM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=124" onclick="OpenComments(this.href); return false">Comments (2)</a>
	
	
</div>

</div>



<h2 class="date">July 03, 2002</h2>


<div class="blogbody">
<a name="000123"></a>
<h3 class="title">Getting a C++ Bison parser to use a C Flex lexer</h3>

<p><P>I've been spending a bunch of time writing some YACC grammars using <A href="http://www.gnu.org/software/flex/flex.html">Flex</A> and <A href="http://www.gnu.org/software/bison/bison.html">Bison</A>. Flex and Bison are GNU ports of Lex and Yacc respectively. These tools were originally designed to generate C code. However, I wanted to be able to use Bison to generate C++ code. Writing context-free grammars is easy; getting C and C++ code to interop seamlessly is not ;(&nbsp;Man, did I feel lots of pain. The purpose of this entry is to hopefully prevent other folks from feeling the same pain that I felt today.</P><br />
<P>The generally accepted practice is to let Flex generate C code, and to trick Bison into generating C++ code.[1] This means, however, that you now are mixing C and C++ code within the same application. To fix the inevitable compiler errors that will result from this unholy combination, you'll need to tell your C++ compiler to turn off name mangling for certain symbols. This, of course, requires that you understand how Flex and Bison talk to each other.</P><br />
<P>Bison calls the Flex-generated yylex() function to obtain the next token from Flex. Since yylex() will be compiled in a "C" source file, you need to disable name mangling of this function. This is conveniently done using the extern "C" directive and declaring the yylex() function prototype in the header of your Bison file:</P><CODE><br />
<P>extern "C" {<BR>&nbsp; int yylex( void );<BR>}</CODE></P><br />
<P>In C++ code, you can only define a method once. The yyerror() method is called by Bison-generated code to report errors. Therefore, you must add a forward-reference to your yyerror() implementation that you'll write at the bottom of your Bison source code file by adding:</P><CODE><br />
<P>int yyerror( const char * ); </P></CODE><br />
<P>to your Bison file's header.</P><br />
<P>To complicate matters, I wasn't reading input from stdin and stdout; I was reading input from strings that are passed to my parser. This required me to call the yy_scan_string() and yy_delete_buffer() methods from my C++ code. Therefore, I needed to turn off name mangling for these symbols as well.&nbsp;Here's all of the code that you'll need to add to your&nbsp;Bison file's header to turn off name mangling.</P><CODE><br />
<P>typedef struct yy_buffer_state *YY_BUFFER_STATE;</P><br />
<P>extern "C" {<BR>&nbsp; int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; yylex( void );<BR>&nbsp; YY_BUFFER_STATE yy_scan_string( const char * );<BR>&nbsp; void&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; yy_delete_buffer( YY_BUFFER_STATE );<BR>}</P></CODE><br />
<P>But wait, there's more pain! In my Bison file, I need to use unions, since I would pass both token values and text values back to my Bison grammar. Here's the union definition from my Bison file:</P><CODE><br />
<P>%union<BR>{<BR>&nbsp; int&nbsp;&nbsp;&nbsp; token;<BR>&nbsp; char&nbsp; *string;<BR>}</P></CODE><br />
<P>This union is manifested through a global variable called yylval. Once Bison is finished generating code, you'll wind up with a declaration that looks like:</P><CODE><br />
<P>typedef union <BR>{<BR>&nbsp; int token;<BR>&nbsp; char *string;<BR>} YYSTYPE;<BR><BR>YYSTYPE yylval;</P></CODE><br />
<P>However, yylval is defined by Bison, not Flex. And the Bison-generated file is a C++ file, whereas the Flex-generated code is a C file. This means that you need to disable name mangling of yylval.</P><br />
<P>When Bison generates code, it does so by using a template file called bison.simple. Unfortunately, the version of bison.simple that I got from Wilbur Streett's <A href="http://www.monmouth.com/~wstreett/lex-yacc/lex-yacc.html">otherwise excellent Win32 port of Flex and Bison</A> did not disable name mangling of yylval. Therefore, I needed to replace 117 of his file:</P><CODE><br />
<P>YYSTYPE yylval;</P></CODE><br />
<P>with some conditionally compiled code:</P><CODE><br />
<P>#ifdef __cplusplus<BR>&nbsp; extern "C" YYSTYPE yylval;&nbsp;<BR>#else<BR>&nbsp; YYSTYPE yylval;<BR>#endif</P></CODE><br />
<P>With these fixes in place, I'm happy to report that I can finally use Bison to generate C++ code, and Flex to generate C code. More importantly, figuring out how to get the generated C++ and C code to talk to each other greatly deepened my understanding of how Flex and Bison work together to generate your parser.</P><br />
<P>[1] This is an excellent tutorial for Lex and Yacc. In particular, Section 5 is invaluable in telling you why you need to leave Lex as it is and to NOT use the -+ option.</P><br />
<P><A href="http://www.tldp.org/HOWTO/Lex-YACC-HOWTO.html">http://www.tldp.org/HOWTO/Lex-YACC-HOWTO.html</A></P></p>



<div class="posted">
	Posted by John at <a href="http://www.iunknown.com/000123.html">12:54 AM</a>
		| <a href="http://www.iunknown.com/cgi-bin/mt-comments.cgi?entry_id=123" onclick="OpenComments(this.href); return false">Comments (1)</a>
	
	
</div>

</div>


</div>
</div>

</body>
</html>
