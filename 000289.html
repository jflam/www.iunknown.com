<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>iunknown.com: Unit testing .EXE's</title>

<link rel="stylesheet" href="http://www.iunknown.com/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.iunknown.com/index.rdf" />

<link rel="start" href="http://www.iunknown.com/" title="Home" />
<link rel="prev" href="http://www.iunknown.com/000288.html" title="Lawrence Lessig on Free Culture" />

<link rel="next" href="http://www.iunknown.com/000290.html" title="Open source licensing" />


<script type="text/javascript" language="javascript">
<!--

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

var HOST = 'www.iunknown.com';

// Copyright (c) 1996-1997 Athenia Associates.
// http://www.webreference.com/js/
// License is granted if and only if this entire
// copyright notice is included. By Tomer Shiran.

function setCookie (name, value, expires, path, domain, secure) {
    var curCookie = name + "=" + escape(value) + ((expires) ? "; expires=" + expires.toGMTString() : "") + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + ((secure) ? "; secure" : "");
    document.cookie = curCookie;
}

function getCookie (name) {
    var prefix = name + '=';
    var c = document.cookie;
    var nullstring = '';
    var cookieStartIndex = c.indexOf(prefix);
    if (cookieStartIndex == -1)
        return nullstring;
    var cookieEndIndex = c.indexOf(";", cookieStartIndex + prefix.length);
    if (cookieEndIndex == -1)
        cookieEndIndex = c.length;
    return unescape(c.substring(cookieStartIndex + prefix.length, cookieEndIndex));
}

function deleteCookie (name, path, domain) {
    if (getCookie(name))
        document.cookie = name + "=" + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + "; expires=Thu, 01-Jan-70 00:00:01 GMT";
}

function fixDate (date) {
    var base = new Date(0);
    var skew = base.getTime();
    if (skew > 0)
        date.setTime(date.getTime() - skew);
}

function rememberMe (f) {
    var now = new Date();
    fixDate(now);
    now.setTime(now.getTime() + 365 * 24 * 60 * 60 * 1000);
    setCookie('mtcmtauth', f.author.value, now, '', HOST, '');
    setCookie('mtcmtmail', f.email.value, now, '', HOST, '');
    setCookie('mtcmthome', f.url.value, now, '', HOST, '');
}

function forgetMe (f) {
    deleteCookie('mtcmtmail', '', HOST);
    deleteCookie('mtcmthome', '', HOST);
    deleteCookie('mtcmtauth', '', HOST);
    f.email.value = '';
    f.author.value = '';
    f.url.value = '';
}

//-->
</script>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://www.iunknown.com/000289.html"
    trackback:ping="http://www.iunknown.com/cgi-bin/mt-tb.cgi/33"
    dc:title="Unit testing .EXE&apos;s"
    dc:identifier="http://www.iunknown.com/000289.html"
    dc:subject=""
    dc:description="I was hoping that VS.NET 2003 would let me reference code in an .EXE assembly. Unfortunately, the IDE still prevents me from doing this, which makes writing unit tests for EXE-based code more painful (your .EXE project becomes a shell..."
    dc:creator="John"
    dc:date="2003-07-10T11:46:06-05:00" />
</rdf:RDF>
-->




</head>

<body>

<div id="banner">
<h1><a href="http://www.iunknown.com/" accesskey="1"><img src="/mt-static/images/iunknown.png" width="350" height="60" border="0"></a></h1>
<span class="description">Home of the Practical Eye for the .NET Guy</span>
</div>

<div id="container">

<div class="blog">

<div id="menu">
<a href="http://www.iunknown.com/000288.html">&laquo; Lawrence Lessig on Free Culture</a> |

<a href="http://www.iunknown.com/">Main</a>
| <a href="http://www.iunknown.com/000290.html">Open source licensing &raquo;</a>

</div>

</div>


<div class="blog">

<h2 class="date">July 10, 2003</h2>

<div class="blogbody">

<h3 class="title">Unit testing .EXE's</h3>

<p>I was hoping that <span class="caps">VS.NET 2003</span> would let me reference code in an .EXE assembly. Unfortunately, the <span class="caps">IDE </span><em>still</em> prevents me from doing this, which makes writing unit tests for <span class="caps">EXE</span>-based code more painful (your .EXE project becomes a shell for a library project that contains the real code). This is a limitation that's imposed by the <span class="caps">IDE GUI,</span> and is <em>not</em> a limitation of the compilers; the C# compiler happily lets me reference types in an .EXE assembly.  </p>

<p>If anyone from the <span class="caps">VS.NET</span> team reads this, can you remove this arbitrary limitation from the Whidbey release of <span class="caps">VS.NET</span>? Pretty-please? :)</p>

<a name="more"></a>


<span class="posted">Posted by John at July 10, 2003 11:46 AM
| <a href="http://www.iunknown.com/cgi-bin/mt-tb.cgi?__mode=view&amp;entry_id=289" onclick="OpenTrackback(this.href); return false">TrackBack</a>

<br /></span>

</div>

<div class="comments-head"><a name="mailthisentry"></a>Mail this entry</div>

<form method="post" action="http://www.iunknown.com/cgi-bin/mt-send-entry.cgi">
<input type="hidden" name="entry_id" value="289" />
<input type="hidden" name="_redirect" value="http://www.iunknown.com/000289.html" />
Email this entry to:<br />
<input name="to" size="20" /><br /><br />
Your email address:<br />
<input name="from" size="20" /><br /><br />
Message (optional):<br />
<textarea name="message" rows="5" cols="20" wrap="virtual"></textarea><br /><br />
<input type="submit" value="Send" />
</form>


<div class="comments-head"><a name="comments"></a>Comments</div>

<div class="comments-body">
<p>This might sound trite but... stop using the build system in the IDE? Use NAnt instead! :)</p>
<span class="comments-post">Posted by: <a target="_blank" href="http://dotnetguy.techieswithcats.com/">Brad Wilson, The .NET Guy</a> at July 10, 2003 12:06 PM</span>
</div>
<div class="comments-body">
<p>But Brad, I *do* use NAnt. But I also edit my code in VS.NET. When I write my unit tests, I'd like to have Intellisense against my target code.</p>
<span class="comments-post">Posted by: <a target="_blank" href="http://www.iunknown.com">John Lam</a> at July 10, 2003 12:09 PM</span>
</div>
<div class="comments-body">
<p>With VS 2003, bypassing the GUI by manually adding the reference to the .csproj xml file (for C# projects) seems to work. </p>

<p>Andy Mc</p>
<span class="comments-post">Posted by: <a href="mailto&#58;andy&#64;andymcm&#46;com">Andy McMullan</a> at July 10, 2003 12:25 PM</span>
</div>
<div class="comments-body">
<p>See this [1] article where I do exactly that.  I wanted to compile some code against Reflector.  I first found out you could just rename an EXE and it would work (kind of obvious but I didn't think of it for a while).  I then found out you could edit the .csproj file by hand (this works for adding links to files outside the project directory too).  It was a bummer when I found out this doesn't work in VS.NET 2002 (when I ported the project back).</p>

<p>[1] http://www.managedaddins.net/addins/reflector/ReflectorAddIn.htm</p>
<span class="comments-post">Posted by: <a target="_blank" href="http://weblogs.asp.net/nunitaddin">Jamie Cansdale</a> at July 12, 2003 08:51 PM</span>
</div>
<div class="comments-body">
<p>You've got my vote! I've only recently started unit testing my assemblies, and until now haven't had to unit test an .exe. Needless to say, I've come up against the exact same problem.</p>

<p>I guess I'll just have to settle for the wrapper approach in the mean time.</p>
<span class="comments-post">Posted by: <a target="_blank" href="http://www.sycora.net">Richard Poole</a> at July 14, 2004 12:21 PM</span>
</div>



<div class="comments-head">Post a comment</div>

<div class="comments-body">
<form method="post" action="http://www.iunknown.com/cgi-bin/mt-comments.cgi" name="comments_form" onsubmit="if (this.bakecookie[0].checked) rememberMe(this)">
<input type="hidden" name="static" value="1" />
<input type="hidden" name="entry_id" value="289" />

<div style="width:180px; padding-right:15px; margin-right:15px; float:left; text-align:left; border-right:1px dotted #bbb;">
	<label for="author">Name:</label><br />
	<input tabindex="1" id="author" name="author" /><br /><br />

	<label for="email">Email Address:</label><br />
	<input tabindex="2" id="email" name="email" /><br /><br />

	<label for="url">URL:</label><br />
	<input tabindex="3" id="url" name="url" /><br /><br />
</div>

Remember personal info?<br />
<input type="radio" id="bakecookie" name="bakecookie" /><label for="bakecookie">Yes</label><input type="radio" id="forget" name="bakecookie" onclick="forgetMe(this.form)" value="Forget Info" style="margin-left: 15px;" /><label for="forget">No</label><br style="clear: both;" />

<label for="text">Comments:</label><br />
<textarea tabindex="4" id="text" name="text" rows="10" cols="50"></textarea><br /><br />

<input type="submit" name="preview" value="&nbsp;Preview&nbsp;" />
<input style="font-weight: bold;" type="submit" name="post" value="&nbsp;Post&nbsp;" /><br /><br />

</form>

<script type="text/javascript" language="javascript">
<!--
document.comments_form.email.value = getCookie("mtcmtmail");
document.comments_form.author.value = getCookie("mtcmtauth");
document.comments_form.url.value = getCookie("mtcmthome");
if (getCookie("mtcmtauth")) {
    document.comments_form.bakecookie[0].checked = true;
} else {
    document.comments_form.bakecookie[1].checked = true;
}
//-->
</script>
</div>


</div>
</div>
</body>
</html>
