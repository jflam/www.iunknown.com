<!-- Published by Fog Creek Software CityDesk EKANXPWNIHDVOPBJ/5193B323/93 -->


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Aspect Oriented Programming and the CLR</title>
  <link rel="stylesheet" href="../iunknown.css"/>
  <script type="text/javascript" src="http://www.haloscan.com/load.php?user=jlam"></script>
  <script language="javascript">
    function HaloScan2( id ) {
      location.href='http://www.haloscan.com/comments.php?user=jlam&comment='+id;
    }
  </script>
</head>
<body>
  <a href="http://www.iunknown.com"><img src="../Images/iunknown.png" width="350" height="60" border="0"></a> 
  <table width="700px" border="0" cellspacing="10">
    <tr>
      <td width="76%" valign="top">
        <div class="entryTitle">Aspect Oriented Programming and the CLR</div>
        <div class="entryDate">2002-02-04</div>
        <p><P>Today was a <EM>great</EM> day!! My demonstration proposal was accepted at the first Aspect Oriented Software Development conference in the Netherlands![1] I will be demonstrating for the first time my implementation of Aspect-Oriented Programming (AOP) using the CLR. This will also be my first talk at a computer science&nbsp;academic conference. This is quite unlike my last stint in academia during <A href="../About/fog0000000009.html">my other life</A>.</P>
<P>The AOP plumbing that I built for the CLR is quite novel. It relies on the metadata and profiling interfaces provided by the CLR's execution engine to rewrite CIL code on the fly at JIT compilation time. Since all of the aspect weaving is done at JIT compilation time, I can weave system library code as well as user-defined code.</P>
<P>Aspect oriented programming is a way of dealing with software complexity.[2] The canonical examples of applications of AOP typically involve code that is scattered throughout an application. Some examples are:</P>
<OL>
<LI>Tracing / logging 
<LI>Security access control checks 
<LI>Pre / post condition assertions (which could ultimately lead to an implementation of Eiffel's <A href="http://www.eiffel.com/doc/manuals/technology/contract/">Design-By-Contract </A>semantics).</LI></OL>
<P>What AOP promises is the ability to gather all of this code and put it in a single place (the aspect). You do so by instructing your AOP runtime / framework to weave your aspect throughout your application. Here are some examples:</P>
<OL>
<LI>"call the logMethodCall() method after any call to any method in the System.Xml namespace" 
<LI>"call the accessCheck() method instead of any call to a constructor in the System.IO namespace"</LI></OL>
<P>One of the great features of AOP is that the aspects can be introduced and removed <EM>very</EM> <EM>easily</EM>. You no longer have to modify your source code; you simply change the weave instructions to add or remove your aspects from your program. For example, you can easily turn on and off tracing at various points in the execution of your program simply by changing the weave instructions.&nbsp;What's even more powerful is the ability of the CLR to force the re-JIT of an existing compiled method; this lets you weave and un-weave code without shutting down or restarting an application!</P>
<P>This is just one part of what I've been up to <A href="../About/fog0000000010.html">in my plan</A>. My AOP engine for the CLR will serve as the technological foundation for a set of products that I will be producing later this year. Stay tuned to this weblog for more details on my AOP engine and AOP programming in general as I drive towards the first public unveiling[3] of this technology!</P>
<P>[1] <A href="http://trese.cs.utwente.nl/aosd2002/index.php">http://trese.cs.utwente.nl/aosd2002/index.php</A></P>
<P>[2] In the words of Dijkstra, "I have a small mind and can only comprehend one thing at a time". </P>
<P>[3] Attendees of the <A href="http://www.vslive.com/2002/sf/default.asp">VS Live!</A> conference February 13-15 in San Francisco might get a sneak preview of this code in action if I can hit my milestone 3 release criteria by then.</P><img src="../Images/blue_button.jpg" alt="Permanent Link" width="18" height="18" align="top"></p>
        <a href="javascript:HaloScan2('Weblog/fog0000000093.html');"><script type="text/javascript">postCount('Weblog/fog0000000093.html');</script></a>
      </td>
      <td width="24%" valign="top">
        <a href="http://www.iunknown.com/rss.xml"><img src="../Images/xml.png" width="36" height="14" border="0"></a>
  
        <p><img src="../Images/about.png" width="100" height="25"></p>
        <div class="aboutEntry"> 
          
            <A href="../About/Aboutme.html">About me</A><br>
          
            <A href="../About/fog0000000006.html">About this site</A><br>
          
            <A href="../About/fog0000000010.html">My plan</A><br>
          
            <A href="../About/fog0000000009.html">My other life</A><br>
          
            <A href="../About/fog0000000008.html">My products</A><br>
          
            <A href="../About/fog0000000013.html">My publications</A><br>
          
        </div>

        <p><img src="../Images/archives.png" width="100" height="25"></p>
        <div class="archiveEntry">
         
           <A href="../Archives/February2003.html">February2003</A><br>
         
           <A href="../Archives/January2003.html">January 2003</A><br>
         
           <A href="../Archives/December2002.html">December 2002</A><br>
         
           <A href="../Archives/November2002.html">November 2002</A><br>
         
           <A href="../Archives/October2002.html">October 2002</A><br>
         
           <A href="../Archives/September2002.html">September 2002</A><br>
         
           <A href="../Archives/August2002.html">August 2002</A><br>
         
           <A href="../Archives/July2002.html">July 2002</A><br>
         
           <A href="../Archives/June2002.html">June 2002</A><br>
         
           <A href="../Archives/May2002.html">May 2002</A><br>
         
           <A href="../Archives/April2002.html">April 2002</A><br>
         
           <A href="../Archives/fog0000000116.html">March 2002</A><br>
         
           <A href="../Archives/fog0000000091.html">February 2002</A><br>
         
           <A href="../Archives/fog0000000046.html">January 2002</A><br>
         
           <A href="../Archives/fog0000000030.html">December 2001</A><br>
         
        </div>

        <p><img src="../Images/articles.png" width="100" height="25"></p>
        <div class="articleEntry">
          
            - <A href="../Articles/Booksuggestions.html">Book suggestions</A><br>
          
            - <A href="../Articles/fog0000000082.html">Interface dispatch vs. object reference dispatch</A><br>
          
            - <A href="../Articles/fog0000000065.html">x86 Resources</A><br>
          
            - <A href="../Articles/fog0000000041.html">Entertainment PC's Part 2</A><br>
          
            - <A href="../Articles/fog0000000034.html">Entertainment PC's</A><br>
          
            - <A href="../Articles/fog0000000025.html">Hello CppUnit</A><br>
          
        </div>

        <p><img src="../Images/links.png" width="100" height="25"></p>
        <div class="linkEntry">
          <a href="http://www.gotdotnet.com/team/dbox/spoutlet.aspx">Don Box</a><br>
          <a href="http://www.stronglytyped.com/">Richard Caetano</a><br>
          <a href="http://www.razorsoft.net/weblog/">Peter Drayton</a><br>
          <a href="http://radio.weblogs.com/0109845/">Jeroen Frijters</a><br>
          <a href="http://radio.weblogs.com/0105852/">Sam Gentile</a><br>
          <a href="http://radio.weblogs.com/0106747/">Scott Hanselman</a><br>
          <a href="http://radio.weblogs.com/0104813/">Drew Marsh</a><br>
          <a href="http://www.dotnetremoting.cc/dotnetcentric/">Ingo Rammer</a><br>
          <a href="http://www.winterdom.com/weblog/">Tomas Restrepo</a><br>
          <a href="http://www.sellsbrothers.com/">Chris Sells</a><br>
          <a href="http://www.joelonsoftware.com/">Joel Spolsky</a><br>
          <a href="http://radio.weblogs.com/0108971/">Clemens Vasters</a><br>
          <a href="http://staff.develop.com/jasonw/weblog/">Jason Whittington</a><br>
          <a href="http://dotnetguy.techieswithcats.com/">Brad Wilson</a><br>
        </div>
      </td>
    </tr>
  </table>
</body>
</html>
