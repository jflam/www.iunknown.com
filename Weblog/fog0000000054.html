<!-- Published by Fog Creek Software CityDesk CQSXKDXJHSYDVISL/5193B323/54 -->


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>VMWare Woes</title>
  <link rel="stylesheet" href="../iunknown.css"/>
  <script type="text/javascript" src="http://www.haloscan.com/load.php?user=jlam"></script>
  <script language="javascript">
    function HaloScan2( id ) {
      location.href='http://www.haloscan.com/comments.php?user=jlam&comment='+id;
    }
  </script>
</head>
<body>
  <a href="http://www.iunknown.com"><img src="../Images/iunknown.png" width="350" height="60" border="0"></a> 
  <table width="700px" border="0" cellspacing="10">
    <tr>
      <td width="76%" valign="top">
        <div class="entryTitle">VMWare Woes</div>
        <div class="entryDate">2002-01-08</div>
        <p><P>Sometimes it seems like I am destined to spend my entire life installing software. Today was one of those days. I wanted to do something simple: set up a bunch of <A href="http://www.vmware.com">VMWare</A> virtual machines so that I could started filling out the testing matrix for my product. I had quite a lot of success earlier this year setting up <A href="http://www.vmware.com/products/desktop/ws_features.html">VMWare Workstation 3.0</A> on Windows XP and running a Linux guest operating system on it. I thought that Linux would be the tough operating system to install. I was wrong.</P>
<P>In October, I had installed VMWare Workstation 3.0 on my Thinkpad T-23 laptop that ran the release bits of Windows XP as the host operating system. I then proceeded to install a SUSE Linux 7.2 distribution on it without any problems. The SUSE installer worked flawlessly under VMWare. </P>
<P>This afternoon, I attempted to install a Windows XP Professional guest operating system under VMWare on my Thinkpad T-23. After taking what seemed to be an eternity to go from the BIOS screen to Windows XP booting off of my CD drive, I managed to format the VMWare virtual disk with NTFS and get through the part where the Windows XP setup where all of the setup files are copied from the CD to the virtual disk. When the computer rebooted, it would NOT boot from the virtual disk. CPU utilization was pegged at 100% and the computer just sat there and taunted me.</P>
<P>Being foolish, I attempted the install again. And for good luck, one more time, varying silly little things like whether I was doing a fast format for NTFS or not. Nothing worked.</P>
<P>In frustration, I turned to using my desktop PC to install Windows XP under VMWare Workstation. This time, the installation of Windows XP Professional worked flawlessly. I then proceeded to apply all known patches to this build of XP, activated it, and archived the copy to a ZIP file so that I could use it as a baseline "clean" install of XP.</P>
<P>Once I verified that everything worked correctly, I proceeded to install Visual Studio.NET Beta 2 Enterprise Edition (I wanted to check out the UML reverse-engineering features of Visio). The Component Update worked just fine. However, when I proceeded to begin the install of VS.NET, it barfed repeatedly part-way through the install, complaining of a corrupt or missing *.MSM file. </P>
<P>Being foolish, I attempted the install again. Twice. No luck. I posted a plea on the DOTNET list, and got a reply from a Microsoftie. Hopefully something might come of this.</P>
<P>Thinking that it was an OS + VMWare + VS.NET conflict of some sort, I decided to go and try my luck with Windows 2000 as the guest operating system.</P>
<P>One of the things that I quickly learned about VMWare is that you had BETTER get correct the type of guest operating system that you will be installing. Foolishly, on my first attempt, I had specified Windows 2000 Professional (actually, I had intended to install it and then discovered that I only had bootable CD's for Server and Advanced Server handy). That blew about half an hour as the Win2K Server install formatted and copied all of the files only to have VMWare refuse to boot off the hard drive (it was complaining about a missing ntoskrnl.exe file).</P>
<P>The next time through, I specified that I was installing Windows 2000 Server, and the base OS installed just fine. Then I decided to apply Service Pack 2. Foolishly (are you seeing a pattern here?) I decided to turn off the "do you want to backup files so that you can uninstall this service pack later?" switch. I got part way through the install of SP2 only to have the installer barf while trying to uncompress mshtml.dl_. I canceled completely out of the install, and had a half-baked install of Win2K. So I had to repave again.</P>
<P>The third time that I installed Win2K, everything installed fine once again. However, this time when I attempted to install SP2, I made sure that I backed up the base system files. However, the install barfed again, but this time on a different file: hypertrm.dl_. Now I'm beginning to hate life. This time, I told the SP2 install to continue, but to skip copying that file. I would manually replace it later.</P>
<P>Looking at patterns, it now seems really clear to me that it might be a problem with my CD-ROM drive. It's actually a Plextor CDRW drive that no longer burns CDR's on WinXP after I installed a Pioneer 16X DVD on the same box. Hmmm ... </P>
<P>I'm going to finish up this entry now (it's 3:10am and I'm REALLY tired). However, I think I might have isolated the problem so I'll have somewhere to begin in the morning.</P>
<P>Why can't I just write software and stay far, far away from hardware?!!</P><img src="../Images/blue_button.jpg" alt="Permanent Link" width="18" height="18" align="top"></p>
        <a href="javascript:HaloScan2('Weblog/fog0000000054.html');"><script type="text/javascript">postCount('Weblog/fog0000000054.html');</script></a>
      </td>
      <td width="24%" valign="top">
        <a href="http://www.iunknown.com/rss.xml"><img src="../Images/xml.png" width="36" height="14" border="0"></a>
  
        <p><img src="../Images/about.png" width="100" height="25"></p>
        <div class="aboutEntry"> 
          
            <A href="../About/Aboutme.html">About me</A><br>
          
            <A href="../About/fog0000000006.html">About this site</A><br>
          
            <A href="../About/fog0000000010.html">My plan</A><br>
          
            <A href="../About/fog0000000009.html">My other life</A><br>
          
            <A href="../About/fog0000000008.html">My products</A><br>
          
            <A href="../About/fog0000000013.html">My publications</A><br>
          
        </div>

        <p><img src="../Images/archives.png" width="100" height="25"></p>
        <div class="archiveEntry">
         
           <A href="../Archives/April2003.html">April 2003</A><br>
         
           <A href="../Archives/March2003.html">March 2003</A><br>
         
           <A href="../Archives/February2003.html">February 2003</A><br>
         
           <A href="../Archives/January2003.html">January 2003</A><br>
         
           <A href="../Archives/December2002.html">December 2002</A><br>
         
           <A href="../Archives/November2002.html">November 2002</A><br>
         
           <A href="../Archives/October2002.html">October 2002</A><br>
         
           <A href="../Archives/September2002.html">September 2002</A><br>
         
           <A href="../Archives/August2002.html">August 2002</A><br>
         
           <A href="../Archives/July2002.html">July 2002</A><br>
         
           <A href="../Archives/June2002.html">June 2002</A><br>
         
           <A href="../Archives/May2002.html">May 2002</A><br>
         
           <A href="../Archives/April2002.html">April 2002</A><br>
         
           <A href="../Archives/fog0000000116.html">March 2002</A><br>
         
           <A href="../Archives/fog0000000091.html">February 2002</A><br>
         
           <A href="../Archives/fog0000000046.html">January 2002</A><br>
         
           <A href="../Archives/fog0000000030.html">December 2001</A><br>
         
        </div>

        <p><img src="../Images/articles.png" width="100" height="25"></p>
        <div class="articleEntry">
          
            - <A href="../Articles/Booksuggestions.html">Book suggestions</A><br>
          
            - <A href="../Articles/fog0000000082.html">Interface dispatch vs. object reference dispatch</A><br>
          
            - <A href="../Articles/fog0000000065.html">x86 Resources</A><br>
          
            - <A href="../Articles/fog0000000041.html">Entertainment PC's Part 2</A><br>
          
            - <A href="../Articles/fog0000000034.html">Entertainment PC's</A><br>
          
            - <A href="../Articles/fog0000000025.html">Hello CppUnit</A><br>
          
        </div>

        <p><img src="../Images/links.png" width="100" height="25"></p>
        <div class="linkEntry">
          <a href="http://www.gotdotnet.com/team/dbox/spoutlet.aspx">Don Box</a><br>
          <a href="http://www.stronglytyped.com/">Richard Caetano</a><br>
          <a href="http://www.razorsoft.net/weblog/">Peter Drayton</a><br>
          <a href="http://radio.weblogs.com/0109845/">Jeroen Frijters</a><br>
          <a href="http://radio.weblogs.com/0105852/">Sam Gentile</a><br>
          <a href="http://radio.weblogs.com/0106747/">Scott Hanselman</a><br>
          <a href="http://radio.weblogs.com/0104813/">Drew Marsh</a><br>
          <a href="http://www.dotnetremoting.cc/dotnetcentric/">Ingo Rammer</a><br>
          <a href="http://www.winterdom.com/weblog/">Tomas Restrepo</a><br>
          <a href="http://www.sellsbrothers.com/">Chris Sells</a><br>
          <a href="http://www.joelonsoftware.com/">Joel Spolsky</a><br>
          <a href="http://radio.weblogs.com/0108971/">Clemens Vasters</a><br>
          <a href="http://staff.develop.com/jasonw/weblog/">Jason Whittington</a><br>
          <a href="http://dotnetguy.techieswithcats.com/">Brad Wilson</a><br>
        </div>
      </td>
    </tr>
  </table>
</body>
</html>
